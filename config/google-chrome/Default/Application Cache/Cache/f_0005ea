zW.prototype.pSa=PR(210,function(a){this.J=Ub(arguments,0)});var hFc=[2];function iFc(a){Oh(this,a,0,-1,hFc,null)}y(iFc,Nh);function MX(a){Oh(this,a,0,-1,null,null)}y(MX,Nh);var jFc=[1,2];function kFc(a){Oh(this,a,0,-1,jFc,null)}y(kFc,Nh);var lFc=[1];function mFc(a){Oh(this,a,0,-1,lFc,null)}y(mFc,Nh);var nFc=[1];function oFc(a){Oh(this,a,0,-1,nFc,null)}y(oFc,Nh);var pFc=[1];function qFc(a){Oh(this,a,0,-1,pFc,null)}y(qFc,Nh);var rFc=[3];function sFc(a){Oh(this,a,0,-1,rFc,null)}y(sFc,Nh);
sFc.prototype.getChartType=function(){return I(this,1)};function NX(a){Oh(this,a,0,-1,null,null)}y(NX,Nh);function tFc(a){Oh(this,a,0,-1,null,null)}y(tFc,Nh);function uFc(a){Oh(this,a,0,-1,null,null)}y(uFc,Nh);uFc.prototype.getChartType=function(){return I(this,1)};function vFc(a){Oh(this,a,0,-1,null,null)}y(vFc,Nh);vFc.prototype.uf=function(){return I(this,2)};function OX(a,b){return W(a,2,b)}
function wFc(a,b,c,d,e){return V3b(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function xFc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return Ab(a[b],function(b,d){return Ab(a,function(a){return a[d]})})}function yFc(a){a=eJ(a.D);return null!=a?a.toString():"0"}
function zFc(a,b){var c={row:0,sj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Tc()+1?c.row=b.Tc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Wc()+1&&(c.sj=b.Wc()+1));return c}function AFc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=yFc(a);c=zFc(e,c);(a=wFc(a.C,b,e,c.row,c.sj))&&d&&a.length<a[0].length&&(a=xFc(a));return a}
function BFc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function CFc(a,b){Xe(a.Da,"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}var DFc={CBc:0,Bxa:1,cya:2};function EFc(a){return sc(Ntc,function(b){return b.match(a)}).getName()}
function PX(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function QX(a){return a[PX(a.length,1)[0]]}function FFc(a){var b={};A(a,function(a){b[a]||(b[a]=0);b[a]++});Vb(a);Yb(a,function(a,d){return b[d]-b[a]})}
function GFc(){return R('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function HFc(a,b,c){b=c||b;return R(""+Q(er({Ed:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:$p(""+Q(as({icon:"docs-icon-img docs-icon-plus"},null,b))),style:4},null,b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+Q(er({Ed:"waffle-assistant-zoom-button",content:$p(""+Q(as({icon:"docs-icon-img docs-icon-zoom-in"},null,b))),style:4},null,b))+"")}function RX(){}y(RX,br);ua(RX);RX.prototype.tc=n("waffle-assistant-button");function IFc(a,b,c){b=c||b;a=Vp("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+Q(as({icon:"docs-icon-img docs-icon-search-this-document"},null,b))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+T(a)+'" aria-label="'+T(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+T("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+Q(as({icon:"docs-icon-img docs-icon-cancel"},null,b))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return R(a)};function SX(a){H.call(this,a);this.D=new dr("",new RX,this.oa());this.Ha(this.D);this.F=new sW(!1,"#4285f4");this.Ha(this.F);this.C=this.J=this.H=null}r(SX,H);SX.prototype.xa=function(){this.xd(P(IFc))};SX.prototype.xd=function(a){H.prototype.xd.call(this,a)};
SX.prototype.Ia=function(){H.prototype.Ia.call(this);var a=this.oa();this.C=a.La("waffle-assistant-answers-query-box",this.Da);this.D.Va(a.La("waffle-assistant-answers-clear-query-button",this.C));this.H=a.La("waffle-assistant-answers-spinner-container",this.C);this.F.render(this.H);this.J=a.La("waffle-assistant-answers-input-box",this.C)};SX.prototype.setVisible=function(a){this.getElement()&&(G(this.getElement(),a),(a=nt)&&a.dispatchEvent("resize"))};function JFc(a,b,c,d,e,f){E.call(this,"sqc");this.$=a;this.F=f||"";this.V=b;this.J=d;this.Aa=e;this.C=c}y(JFc,E);function KFc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;E.call(this,"answers-submit-query");this.C=a;this.$=b;this.V=c;this.J=d;this.Aa=e;this.F=f;this.Ga=h}y(KFc,E);function LFc(){this.F=[];this.D={};this.J=null;this.C=new Ev}function MFc(a,b,c,d){function e(a){return a.toLowerCase()}Vb(b,void 0,e);Vb(c,void 0,e);Vb(d,void 0,e);A(b,a.H,a);A(c,a.H,a);A(d,a.H,a)}LFc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function NFc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}LFc.prototype.iH=function(a,b,c){if(bb(a||"")){var d=this.J.Fm();d=OFc(this,a.substring(0,d));var e=PFc(this,b-d.length,a);d=Qb(d,e)}else d=PFc(this,b);d.length>b&&(d=Ub(d,0,b));c(a,d)};
function PFc(a,b,c){var d=c||"";c=ic(a.D,function(a){return Ua(a,d)});var e=QFc(nc(c),d?1:2,1);a=zb(a.F,function(a){return Ua(a.query,d)&&!e[a.query.toLowerCase()]});b=QFc(a,b-mc(e),2);b=nc(b);var f=Ab(b,function(a,b){a.Oqa=b;return a.ZTa});A(b,function(a){a.Mqa=f});return Qb(b,nc(e))}
function OFc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Kaa:h.Kaa,l_:h.l_,bS:h.bS},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.bS={};h.l_=0;h.Kaa=f.substr(k);var l=a.C.Ne(h.Kaa);A(l,function(b){return function(c){var d=c.length-b.Kaa.length;b.l_=Math.max(d,b.l_);c=a.C.get(c);b.bS[d]||(b.bS[d]=[]);Tb(b.bS[d],c)}}(h));for(l=0;l<=h.l_&&0<d;++l){var m=h.bS[l];if(m)for(var q=0;q<m.length&&0<d;++q){var t=m[q];gb(b.toLowerCase(),t.toLowerCase())||e[t]||(--d,c.push({text:t,Wm:"",
pA:0,Pza:f.length-k,ZTa:void 0,Mqa:[],Oqa:-1}),e[t]=!0)}}}return c}function QFc(a,b,c){b=PX(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,Wm:na(b)?"":b.Wm,pA:c,Pza:0,ZTa:na(b)?void 0:b.type,Mqa:[],Oqa:-1}});return d};function TX(){aO.call(this,"",null,!1)}y(TX,aO);TX.prototype.gD=function(a,b){if(2==a.pA||1==a.pA)return TX.ma.gD.call(this,a.text,b);var c=this.Ma(),d=this.Fm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.Pza)+a.text;e||(f+=" ");a=TX.ma.gD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.fk;b.blur();b.focus();this.g0(f.length);return a};
TX.prototype.Yf=function(a){var b=TX.ma.Yf.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,AHb(b)&&b.UF()&&a.preventDefault(),b=!0);return b};function RFc(a,b,c){b=c||b;return R('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+Q(as({icon:"docs-icon-img docs-icon-help"},null,b))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+Q(as({icon:"docs-icon-img docs-icon-clock"},null,b))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+Q(as({icon:"docs-icon-img docs-icon-arrow-tilted"},
null,b))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')};function SFc(a){this.mb=a||Jd()}
SFc.prototype.Du=function(a,b,c){b=P(RFc);var d=this.mb.La("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.mb.Te(d,a.text);d=this.mb.La("waffle-assistant-answers-ac-entity-icon",b);var e=this.mb.La("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.mb.La("waffle-assistant-answers-ac-session-query-icon",b);G(d,0==a.pA);G(e,2==a.pA);G(f,1==a.pA);d="";switch(a.pA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Te(c,d);this.mb.appendChild(c,b)};function UX(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=bb(b),gh(a,b,void 0),jtc(a),a.setAttribute("data-tooltip-delay",500),o$b(a,u(c)?c:1))};function TFc(a){var b=a.type;switch(na(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function UFc(a,b){var c=a.type;switch(na(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function VFc(a,b,c,d){B.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new TX;this.H.TEa=!0;this.H.Ga=!0;this.va(this.H);this.V=c;this.V.J=this.H;a=new $N(null,new SFc(a.oa()));this.C=new YN(this.V,a,this.H);this.va(this.C);this.ea=b;this.J=!1;this.$=gj(new fj,d).build();this.Ja=new rf(this);this.va(this.Ja);WFc(this)}r(VFc,B);
function WFc(a){XFc(a);a.H.C=a.C;a.C.gY=!1;a.C.f9=6;WHb(a.H,a.D);UX(a.F.getElement(),"Clear query");a.Ja.R(a.C,"update",a.tlb).R(a.L,"submit",a.pKb).R(a.L,"focus",function(){return YFc(a,!0)},!0).R(a.L,"blur",function(){return YFc(a,!1)},!0).R(a.F,"action",a.A5a).R(a.D,"input",a.ZUa).R(a.D,"focus",a.tRa);a.F.setVisible(!1)}p=VFc.prototype;p.Fa=function(){B.prototype.Fa.call(this);this.V.J=null};function ZFc(a,b,c){c=void 0===c?!1:c;UFc(a.D,b);c&&a.D.focus();a.ZUa()}
function XFc(a){a=a.C.Md();a.className="waffle-assistant-answers-ac-renderer";a.aM="waffle-assistant-answers-ac-row";a.L2="waffle-assistant-answers-ac-active";a.zla="waffle-assistant-answers-ac-highlighted"}p.tlb=function(a){a.row&&(a=a.row,2==a.pA?($Fc(this,1,a.Mqa,a.Oqa,a.Wm,2),this.ea.Xb(2652,this.$)):0==a.pA?(this.J=!0,this.ea.Xb(2651,this.$)):1==a.pA&&$Fc(this,3))};function YFc(a,b){Xe(a.L,"waffle-assistant-answers-query-box-focused",b);a.C.Jf()&&!b&&a.C.Sh()}p.ZUa=function(){this.F.setVisible(!!TFc(this.D))};
p.tRa=function(){this.C.ew(this.D);var a=mb(TFc(this.D));this.H.g0(a.length);xHb(this.C,a||"  ");this.C.update(!0)};p.pKb=function(a){a.stopPropagation();a.preventDefault();$Fc(this,2)};function $Fc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=bb(TFc(a.D));a.F.setVisible(!!h);aGc(a);a.O.dispatchEvent(new KFc(b,h,a.J,c,d,e,f));a.J=!1}p.A5a=function(){UFc(this.D,"");this.F.setVisible(!1)};function aGc(a){a.D.blur();a.C.Jf()&&a.C.Sh()};function bGc(a,b){H.call(this,b);this.F=a;this.H=new LFc;this.C=new SX(this.oa());this.Ha(this.C);this.D=null}r(bGc,H);bGc.prototype.xd=function(a){H.prototype.xd.call(this,a);this.C.render(a)};bGc.prototype.Ia=function(){H.prototype.Ia.call(this);this.D=new VFc(this.C,this.F,this.H,4);this.va(this.D);Te(this.C.Da,"waffle-assistant-answers-input-with-icon")};function VX(a,b,c,d,e,f){E.call(this,a,b);this.C=b;this.Aa=c;this.$=d||null;this.Ga=e||null;this.Ka=f||null}y(VX,E);VX.prototype.ej=g("Aa");function cGc(a,b,c,d,e,f,h){h=void 0===h?null:h;VX.call(this,"Md",null,d,e,f);this.J=a;this.V=b;this.Fc=c;this.F=h}y(cGc,VX);cGc.prototype.Pd=g("Fc");function dGc(a,b,c){VX.call(this,"Pd",null,2859);this.J=a;this.V=b;this.F=c}y(dGc,VX);function eGc(a,b,c,d,e,f,h,k){H.call(this,k);this.H=a;this.D=b;this.L=e;this.O=f;this.F=h;this.C=this.Fc=null;this.J=gj(new fj,10).build()}y(eGc,H);p=eGc.prototype;p.Ia=function(){eGc.ma.Ia.call(this);(new rV(sK,this.D.ag())).send(v(this.Oob,this,this.D))};p.eJa=function(a,b){a=new cGc(this.H.clone(),this.L,this.Fc,2746,a,b);this.dispatchEvent(a)};p.Oob=function(a,b){b&&(b.ji()?dK.kE(this.Da,b):(b=b.Pd(),a.Wd(b),NV(a,b),eK(a,"ready",v(this.j1b,this,a)),kW(a,this.Da,this.O,this.F,DA),this.Fc=b))};
p.j1b=function(a){a.Kl()&&(eK(a.Kl(),"onmouseover",v(this.h1b,this)),eK(a.Kl(),"onmouseout",v(this.i1b,this)))};p.h1b=function(){this.C=Ha()};p.i1b=function(){pa(this.C)&&500<Ha()-this.C&&this.F.Xb(2750,this.J);this.C=null};function fGc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(Q(a.G5a)+"</span>"),d=0==a.iEa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=R('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.iEa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+Q(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=R(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(yA?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return R(b)};function gGc(){return R('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function hGc(a,b){H.call(this,b);this.D=a;this.C=new dr("",new uW,this.oa());this.Ha(this.C)}y(hGc,H);p=hGc.prototype;p.xa=function(){this.Da=P(gGc)};p.Ia=function(){hGc.ma.Ia.call(this);var a=this.La("waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().R(this.Da,"mousedown",this.z1b).R(this.C,"action",this.vrb);this.show(!1)};p.z1b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Da,c=this.La("waffle-assistant-feedback-card-link");Xe(b,"waffle-assistant-feedback-card-hidden",!a);re(c,a)};p.vrb=function(){N.Pu.yc({source:this.D});this.show(!1);this.dispatchEvent(new E("feedback-dialog-opened"))};function iGc(a,b,c){b=c||b;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+Q(as({icon:"docs-icon-img docs-icon-thumb-up"},null,b))+'</div><div class="waffle-assistant-thumbs-down-button">'+Q(as({icon:"docs-icon-img docs-icon-thumb-down"},null,b))+"</div></div></div>");return R(a)};function WX(a){H.call(this,a);this.C=new dr("",new RX,this.oa());this.Ha(this.C);this.D=new dr("",new RX,this.oa());this.Ha(this.D)}y(WX,H);WX.prototype.xa=function(){this.Da=P(iGc)};WX.prototype.Ia=function(){WX.ma.Ia.call(this);var a=this.La("waffle-assistant-thumbs-down-button");this.C.Va(a);UX(a,"Not useful");a=this.La("waffle-assistant-thumbs-up-button");this.D.Va(a);UX(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function jGc(a,b){a.oa().Te(a.La("waffle-assistant-thumbs-text"),b)}WX.prototype.F=function(){this.dispatchEvent(new E("thumbs-down"));G(this.Da,!1)};WX.prototype.H=function(){this.dispatchEvent(new E("thumbs-up"));G(this.Da,!1)};function kGc(a,b,c,d,e,f){H.call(this,f);this.J=a;this.Ka=b;this.Na=c;this.Aa=d;this.qa=e;this.L=Uv(this.J,23);this.Ga=W(this.J,22);this.C=W(this.J,26);this.ea=[];this.Uc=new Yv;this.O=this.F=this.D=null;this.V=!1;this.$=new fr("",this.oa());this.Ha(this.$);this.H=null}y(kGc,H);p=kGc.prototype;p.xa=function(){kGc.ma.xa.call(this);this.Da=P(fGc,{G5a:this.C,iEa:this.L});this.Da.style.visibility="hidden"};
p.Ia=function(){kGc.ma.Ia.call(this);var a=this.La("waffle-assistant-facet-toggle");this.$.Va(a);this.getHandler().R(this.Da,"mousedown",this.e1b).R(this.$,"action",this.NEb);yA&&(this.O=new hGc("assistantAutovisFacetFeedback",this.oa()),this.O.render(this.La("waffle-assistant-facet-feedback-container")),this.D=new WX(this.oa()),this.Ha(this.D),this.D.render(this.La("waffle-assistant-facet-thumbs-container")),jGc(this.D,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.D,
"thumbs-up",this.g1b).R(this.D,"thumbs-down",this.f1b));lGc(this,Q0a)};p.Gd=g("V");p.e1b=function(a){a.stopPropagation()};p.NEb=function(){var a=Se(this.La("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");lGc(this,a);mGc(this,a?2647:2646)};
function lGc(a,b){var c=a.La("waffle-assistant-facet-toggle");pe(c,b?"HIDE":"SHOW");Xe(a.La("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(a.Ki("waffle-assistant-faceted-chart"),function(a){re(a,b)});a.D&&G(a.D.Da,b);var d='Show chart broken down by "'+(a.C+'"');a='Hide chart broken down by "'+(a.C+'"');UX(c,b?a:d)}
function nGc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function oGc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function pGc(a){a.V||A(a.ea,v(function(a){var b=a.Da;if(!this.qa.contains(b)){var d=this.qa;a=new qGc(b,a);kyb(d,a)}},a))}p.g1b=function(){mGc(this,2649)};p.f1b=function(){mGc(this,2648);this.O.show(!0)};function mGc(a,b){var c=a.Aa,d=new hW,e=a.H.getChartType();d.C=e;e=a.H.Pd();d.F=e?e.clone():null;jW(c,b,d,10,a.H,a.H.ag())};function rGc(){return R('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function sGc(a,b,c){b=c||b;return R(""+Q(er({Ed:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:$p(""+Q(as({icon:"docs-icon-img docs-icon-insert-autovis-chart"},null,b))),style:4},null,b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+Q(er({Ed:"waffle-assistant-zoom-button",content:$p(""+Q(as({icon:"docs-icon-img docs-icon-zoom-in"},null,b))),style:4},null,b))+"")};var tGc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function uGc(a){var b=new nK(zc(tGc));return Xyc(a,b)}
function vGc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.xc("useFirstColumnAsDomain")&&a.Pd()&&"number"===a.Pd().dd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.xc("useFirstColumnAsDomain")&&a.Pd()&&"string"===a.Pd().dd(0)){c=0;var d=Wd("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Pd().getNumberOfRows();b++)pe(d,a.Pd().Ef(b,0)),c=Math.max(c,bg(d).width);fe(d);c=Math.min(27,Math.max(15,10+100*c/271))}CA&&BA||DA||(a.setOption("chartArea.top","15%"),b=a.xc("hAxis.title"),a.setOption("chartArea.height",$a(mb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",$a(mb(a.xc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function wGc(){return R('<div class="waffle-assistant-card" tabindex="0" role="region">'+(yA?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(yA?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function XX(a,b){var c=this;H.call(this,b);this.F=a;this.Ga=this.Aa=this.qa=null;this.Cb=new sW(!0,"#4285f4");this.Ha(this.Cb);this.Pb=this.Mc=this.Yd=!1;this.Ra=new Lg(function(){c.Ra.stop();c.Da.parentNode.querySelector(":hover")==c.Da?c.Ra.start():c.RT()},100);this.va(this.Ra);this.Kf=this.Bc=!1}y(XX,H);p=XX.prototype;p.yA=Ge;p.X7=He;p.UB=Ie;p.TB=Ie;p.e6=Ie;p.Wia=Ie;p.Via=Ie;p.AA=da("Kf");p.Gd=g("Kf");p.xa=function(){this.Da=P(wGc)};
p.Ia=function(){XX.ma.Ia.call(this);var a=this.La("waffle-assistant-card-spinner-container");this.Cb.render(a);Af(this.La("waffle-assistant-card-inner"),"visibility","hidden");if(this.yA()){a=this.Da;var b=new dp(a);this.va(b);this.getHandler().R(b,"focusin",this.omb).R(b,"focusout",this.nmb).R(a,"mouseenter",this.m1).R(a,"mouseleave",this.RT)}xGc(this,!1);yA&&(this.Ga=new hGc(this.jz(),this.oa()),this.Ga.render(this.La("waffle-assistant-card-feedback-container")),this.getHandler().R(this.Ga,"feedback-dialog-opened",
this.wrb).R(this,"trigger_feedback",this.OWb),this.X7()?(this.Aa=new WX(this.oa()),this.Aa.render(this.La("waffle-assistant-thumbs-container")),yGc(this,!0),a=mb(this.e6()),$a(a)||jGc(this.Aa,a),a=mb(this.Wia()),$a(a)||UX(this.Aa.La("waffle-assistant-thumbs-up-button"),a),a=mb(this.Via()),$a(a)||UX(this.Aa.La("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.Aa,"thumbs-down",this.x1b).R(this.Aa,"thumbs-up",this.y1b)):yGc(this,!1));this.sA()};
function YX(a){return a.La("waffle-assistant-card-content-container")}function zGc(a){a.yA();return a.La("waffle-assistant-card-options")}function yGc(a,b){yA&&G(a.La("waffle-assistant-thumbs-container"),a.X7()&&b)}p.bJ=function(){this.isDisposed()||(this.Yd=!0,AGc(this))};function BGc(a,b){!a.Mc&&b&&(a.Mc=!0,AGc(a))}function AGc(a){if(a.Yd&&a.Mc){var b=v(a.w1b,a);a.zA(b)}}p.m1=function(){this.Pb||(xGc(this,!0),this.Pb=!0,this.Ra.start())};p.RT=function(){xGc(this,!1);this.Pb=!1};
p.omb=function(){xGc(this,!0)};p.nmb=function(){var a=this,b=new Lg(function(){ne(a.Da,document.activeElement)||a.Da.parentNode.querySelector(":hover")==a.Da||xGc(a,!1)},0);this.va(b);b.start()};p.x1b=function(){CGc(this,!0);yGc(this,!1);var a=this.TB();this.dispatchEvent(new VX("Rd",this,a))};p.y1b=function(){yGc(this,!1);var a=this.UB();this.dispatchEvent(new VX("Rd",this,a))};p.wrb=function(){CGc(this,!1)};p.OWb=function(){CGc(this,!0)};
function xGc(a,b){var c=a.La("waffle-assistant-card-options");a=a.yA();G(c,a&&b)}p.w1b=function(){tW(this.Cb,!1);G(this.Cb.Da,!1);Af(this.La("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new E("content-rendered"))};function CGc(a,b){Xe(a.La("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.Ga.show(b)};function DGc(a,b,c){var d=a.Tc(),e=a.Wc();switch(b){case 0:d=Math.min(d,a.wc()+c);break;case 1:e=Math.min(e,a.rc()+c)}b=a.zb();c=a.wc();a=a.rc();return fA(b,c,a,d,e)}function EGc(a){var b=new pha;J(b,1,""+a.ud);var c=a.rect.wc();J(b,2,c);c=a.rect.Tc();J(b,3,c);b.Iu(a.rect.rc());b.Rx(a.rect.Wc());return b}function FGc(a){var b=new ci;if(a){var c=new ei;a=EGc(a);Uh(c,7,a);Uh(b,58,c)}return b};function ZX(a,b,c,d,e,f,h,k){XX.call(this,a,k);this.C=W(a,8);this.Ab=b;this.xb=c;this.Eb=d;this.L=e;this.Ta=f;this.Xc=h;this.O=new fr("",this.oa());this.Ha(this.O);this.V=new fr("",this.oa());this.Ha(this.V);this.Uc=new Yv;this.rb=null;this.Ka=!1;this.kb=[];this.Ua=[];this.Oa=[];this.Na=this.ea=this.D=this.H=this.$=null;a=FGc(this.Xc);this.J=hj(gj(new fj,10),a).build()}y(ZX,XX);
var $X={uWa:"waffle-assistant-after-chart-preview",SWa:"waffle-assistant-before-chart-preview",dXa:"waffle-assistant-card-draggable",U1:"waffle-assistant-chart-highlights",UZa:"waffle-assistant-insert-chart-button",Wva:"waffle-assistant-chart-preview",p1a:"waffle-assistant-button-separator",V1a:"waffle-assistant-styled-border",W1a:"waffle-assistant-styled-rect",i3a:"waffle-assistant-zoom-button"};p=ZX.prototype;p.zA=function(a){this.rb=a;GGc(this)};
p.sA=function(){HGc(this,v(function(a){a=Otc(this.Ab,a);sg(this.Da,a)},this),!1)};p.yA=He;p.jz=n("autovisFeedback");p.UB=n(2208);p.TB=n(2207);p.e6=n("Was this chart useful?");p.xa=function(){ZX.ma.xa.call(this);YX(this).appendChild(P(rGc));zGc(this).appendChild(P(sGc));if(Pv(this.C,22)){this.D=new kGc(this.C,this.qa,this.Eb,this.L,this.Ta,this.oa());this.Ha(this.D,!0);var a=this.D,b=this.Gd();a.V=b;pGc(a)}};
p.Ia=function(){ZX.ma.Ia.call(this);Te(this.Da,$X.dXa);var a=this.La($X.UZa);this.O.Va(a);UX(a,"Insert chart");a=this.La($X.i3a);this.V.Va(a);UX(a,"View full size");a=this.La($X.SWa);var b=this.La($X.uWa);this.getHandler().R(this.Da,"keydown",this.b1b).R(a,"focus",this.Slb).R(b,"focus",this.Ekb).R(this.O,"action",this.dub).R(this.O.Da,"mousedown",this.dsa).R(this.V,"action",this.yGb).R(this.V.Da,"mousedown",this.dsa).R(this.La($X.U1),"mousedown",this.dsa).R(jI(this.Ab),"tb",this.c1b);IGc(this);this.L.Xb(2790,
this.J);this.D&&this.L.Xb(2791,this.J)};p.AA=function(a){ZX.ma.AA.call(this,a);IGc(this);this.Yb()&&JGc(this)};function IGc(a){if(a.Yb()){var b=a.Gd();a.O.setVisible(!b);a=a.oa().La($X.p1a,zGc(a));G(a,!b)}}p.b1b=function(a){13==a.keyCode&&a.target==this.Da&&(a.preventDefault(),a.stopPropagation(),KGc(this,2255))};
function LGc(a){var b=a.getChartType(),c=!!W(a.C,14),d=W(a.C,16),e=!!W(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=Dtc(Uv(a.F,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=h[m].rect;q=c!=b?osc(q,new Gd(q.width,1)):osc(q,new Gd(1,q.height));Tb(l,q)}c=RG(a.xb).D;var t=[];for(w in Hx)t.push(Osb(c,Hx[w]));var w=Ab(l,function(a){return Ab(t,Fa(Qz,a))});f&&e&&(w=Ub(w,1));a.Oa=MGc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=RG(a.xb);for(e=0;e<w.length;e++)for(f=a.Oa[e],b=0;b<w[e].length;b++)w[e][b]&&bA(w[e][b])&&
(k=Usc(d,w[e][b],$X.W1a),a.va(k),IN(d.O,"default",k,!0),Af(k.Da,"background-color",f),k.setVisible(!0),a.kb.push(k),k=KN(d,w[e][b],$X.V1a,1,0),a.va(k),pCb(k,f),k.setVisible(!0),a.Ua.push(k))}function NGc(a){ec(a.kb);ec(a.Ua);a.kb=[];a.Ua=[];a.Oa=[]}p.c1b=function(){this.Ka&&(NGc(this),LGc(this))};p.m1=function(){ZX.ma.m1.call(this);this.ea=Ha();this.Ka||(LGc(this),this.Ka=!0)};
p.RT=function(){ZX.ma.RT.call(this);pa(this.ea)&&500<Ha()-this.ea&&this.L.Xb(2789,this.J);this.ea=null;NGc(this);this.Ka=!1};p.Slb=function(){var a=this.La($X.U1);Xf(a)?a.focus():this.Da.nextSibling&&this.Da.nextSibling.focus()};p.Ekb=function(){var a;if(a=this.Ga)a=this.Ga,a.yb("waffle-assistant-feedback-card-hidden")?a=!1:(a.La("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.V.Da.focus()};p.dub=function(){KGc(this,2255)};p.dsa=function(a){a.stopPropagation()};
p.yGb=function(){Z2a.yc(this,this.J)};p.eJa=function(a,b){KGc(this,2257,a,b)};function KGc(a,b,c,d){HGc(a,v(function(a){a=new cGc(a,this.qa,this.H&&this.H.Pd(),b,c,d,Aka(this.J));this.dispatchEvent(a)},a),!1)}
p.d1b=function(a,b){if(b){var c=this.La($X.Wva);if(b.ji())dK.kE(c,b);else{a.Wd(b.Pd());NV(a,a.Pd());VU(a,"ready",v(this.a1b,this,a));b=[];try{var d=new mz;d.setContext(a.toJSON());var e=!!W(this.C,14);X(d,3,e);var f=W(this.C,16);X(d,4,f);X(d,5,"ROWS"==(e?"ROWS":"COLS"));X(d,8,0);if(W(this.C,24)){var h=W(this.C,25);X(d,9,h)}var k=Dtc(Uv(this.F,4));for(e=0;e<k.length;e++)d.addRange(iA(k[e].rect,k[e].ud));var l=this.Uc.serialize(d);b=Ab(Uyc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
Ryc)}catch(m){b=[]}d=this.La($X.U1);G(d,0<b.length);0<b.length&&(d.appendChild(b[0]),re(d,!0));this.H=a;kW(a,c,this.Eb,this.L,DA)}}};p.a1b=function(a){null!==this.$&&(Al(yl(),this.$),this.$=null);this.isDisposed()||(a.Kl()&&(eK(a.Kl(),"onmouseover",v(this.Z0b,this)),eK(a.Kl(),"onmouseout",v(this.$0b,this))),this.rb(),JGc(this))};p.Z0b=function(){this.Na=Ha()};p.$0b=function(){pa(this.Na)&&500<Ha()-this.Na&&this.L.Xb(2795,this.J);this.Na=null};
function JGc(a){if(!a.Gd()){var b=a.La($X.Wva);if(!a.Ta.contains(b)){var c=a.Ta;a=new qGc(b,a);kyb(c,a)}}}function OGc(a){a.Bc&&(a.$=zl(yl(),mA.Qsa),a.Bc=!1);W(a.C,16);var b=uGc(a.C);b.V$(sK);var c=Zyc(a.F);b.aj(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}
function GGc(a){var b=OGc(a);b=vGc(b,a.La("waffle-assistant-card-inner"));(new rV(sK,b.ag())).send(v(a.d1b,a,b));a.D&&HGc(a,v(function(a){var c=this.D,e=b;a=new nK(a.toJSON());e=new nK(e.toJSON());var f=c.Ki("waffle-assistant-faceted-chart");if(1<f.length){oGc(a);var h=e;nGc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");CA&&BA||DA||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,oGc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),nGc(e);h=Dtc(Uv(c.J,27));Ymb(c.F,h);h=W(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Ga,t=new rz;X(t,1,q);na(l)&&t.Qa(l);X(m,7,t);c.F.Ac("dt",encodeURIComponent(JSON.stringify(c.Uc.serialize(m))));
q=new nK(a.toJSON());q.aj(c.F.toString());m=e.clone();m.aj(c.F.toString());var w=c,x=q.xc("title");x||(x=EFc(q));t=x+(' when "'+(w.C+('" is "'+(l+'"'))));w=x+(' by "'+(w.C+'"'));t=l?t:w;q.setOption("title",t);m.setOption("title",t);w=new eGc(q,m,c.C,l,c.Ka,c.Na,c.Aa,c.oa());c.Ha(w);t=f[k];w.Va(t);c.ea.push(w);w=c;x=EFc(q);q=x+(' broken down by "'+(w.C+('" for "'+(l+'"'))));w=x+(' broken down by "'+(w.C+'"'));sg(t,l?q:w);c.H=m}pGc(c);c.Da.style.visibility="visible"},a),!1)}
function HGc(a,b,c){var d=OGc(a);(new rV(sK,d.ag())).send(function(a){a?(a=a.Pd(),c&&d.Wd(a),NV(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function MGc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=rwc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Tb(d,d);return d};function qGc(a){wM.apply(this,arguments)}r(qGc,wM);qGc.prototype.gja=g("element");function PGc(){uM.call(this);this.Ka.push(this);this.qa=this.Aa=!0;this.Ta="waffle-assistant-dragged-card"}y(PGc,jyb);PGc.prototype.contains=function(a){return!!A(this.L,function(b){if(b.element==a)return!0})};PGc.prototype.eja=function(a){var b=PGc.ma.eja.call(this,a);if(CA&&BA||DA){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=Ab(b.querySelectorAll("clippath"),function(a){return a.id}),QGc(b,a);return b};
function QGc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&gb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=ie(a);for(c=0;c<a.length;c++)QGc(a[c],b)};function RGc(){return R('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function SGc(a,b){XX.call(this,a,b);this.C=W(a,8)}y(SGc,XX);p=SGc.prototype;p.sA=ta;p.jz=n("assistantWordCloudFeedback");p.UB=n(2634);p.TB=n(2633);p.xa=function(){SGc.ma.xa.call(this);YX(this).appendChild(P(RGc));Te(YX(this),"waffle-assistant-word-cloud-content-container")};
p.zA=function(a){for(var b=Uv(this.C,19),c=Uv(this.C,20),d=this.La("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(TGc(this,b,c,e),120<d.clientHeight){TGc(this,b,c,e-1);break}b=this.oa();c=W(this.C,2);c=Be(b,c);d=this.La("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function TGc(a,b,c,d){var e=a.La("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Be(a," "));var l=a.createElement("SPAN");a.appendChild(l,Be(a,b[k]));a.appendChild(e,l);Te(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function UGc(a){return R('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+T(a.iconSize)+'px" width="'+T(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+T(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function VGc(){var a=R;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+Q(UGc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=R(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function WGc(a,b,c){b=c||b;return R('<div class="waffle-assistant-panel-title-bar">'+Q(er({Ed:"waffle-assistant-panel-back-button",content:$p(""+Q(as({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"},null,b))),style:4},null,b))+'<div class="waffle-assistant-title-text" role="heading">'+Q(a.title)+"</div></div>")};function aY(a){H.call(this,a);this.Bc=new sW(!1,"#4285f4");this.Ha(this.Bc);this.H=new H(this.oa());this.Ha(this.H);this.C=[];this.xe=this.fc=!1;this.vd=this.Xc=this.Ta=this.$=null;this.Cb=new fr("",a,4);ih(this.Cb,2,!1);this.Ha(this.Cb)}y(aY,H);var XGc={defaultHelpArticleId:"6280499"};p=aY.prototype;p.xa=function(){aY.ma.xa.call(this);this.Da=P(VGc);this.Xc=this.La("waffle-assistant-panel-content-container");this.vd=this.La("waffle-assistant-empty-list")};
p.Ia=function(){aY.ma.Ia.call(this);var a=this.La("waffle-assistant-spinner-container");this.Bc.render(a);this.H.Va(this.La("waffle-assistant-panel-card-holder"));this.Cb.Va(this.La("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Cb,"action",this.A1b).R(this.Da,"scroll",htc(this.rba,10,this))};p.setVisible=function(a){var b=this;G(this.Da,a);A(this.C,function(a){if(!a.Yb()){var c=b.H.cd();a.qa=c;b.H.Ha(a,!0);a.bJ()}});this.fc=a};
p.Yoa=function(a,b){var c=this.oa();this.$&&this.V3();this.$=new H;this.Ha(this.$);a=Kp(a,WGc,{title:b});this.Ta=new fr("",this.oa());this.$.Ha(this.Ta);this.Ta.Va(c.La("waffle-assistant-panel-back-button",a));UX(this.Ta.Da,"Back");this.$.getHandler().R(this.Ta,"action",this.Jlb)};p.V3=function(){this.$.dispose();this.$=null};function YGc(a,b){tW(a.Bc,b);G(a.La("waffle-assistant-panel-pane"),!b)}p.uH=function(a){G(this.vd,a);G(this.Xc,!a)};
function ZGc(a,b){Nb(a.C,b);a.H.removeChild(b);a.H.lh(b,0);a.C.push(b)}p.fH=function(a){Nb(this.C,a);-1!=lg(this.H,a)&&this.H.removeChild(a,!0)};p.RV=function(){this.H.Hd(!0);ec(this.C);this.C=[]};p.rba=function(){var a=this.Da;a=a.scrollTop+Tf(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(BGc(d,!0),b+=Tf(d.Da).height):BGc(d,!1)}};function $Gc(a,b){a.xe=b;A(a.C,function(a){a.AA(b)})}p.Gd=g("xe");p.A1b=function(){N.qo.yc(XGc)};p.Jlb=function(){this.dispatchEvent("Jd")};function aHc(a,b,c){b=c||b;a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+Q(a.title)+"</div>"+Q(er({Ed:"waffle-assistant-section-more-button",content:$p("More"),style:4},null,b))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return R(a)};function bY(a,b,c,d){H.call(this,d);this.$=a;this.Ta=b;this.ea=new fr("",this.oa());this.Ha(this.ea);this.L=new H(this.oa());this.Ha(this.L);this.C=null;this.Ra=[];this.Oa=this.Na=!1;this.V=c}y(bY,H);p=bY.prototype;p.sLa=Ge;p.$pa=He;p.xa=function(){bY.ma.xa.call(this);this.Da=P(aHc,{title:this.getTitle()})};
p.Ia=function(){bY.ma.Ia.call(this);this.L.Va(this.La("waffle-assistant-section-card-holder"));this.ea.Va(this.La("waffle-assistant-section-more-button"));this.getHandler().R(this.ea,"action",this.twb);this.C=this.HAa();this.va(this.C);G(bHc(this),this.sLa());this.setVisible(!1)};p.setVisible=function(a){if(this.Yb()&&this.isVisible()!=a&&(G(this.Da,a),a)){G(this.ea.Da,this.fTa());a=new ei;J(a,4,this.n1());var b=new ci;Uh(b,58,a);a=hj(gj(new fj,10),b).build();this.V.Xb(2774,a)}};
p.isVisible=function(){return this.Yb()&&Xf(this.Da)};p.fTa=function(){return this.Ra.length>this.$};p.HAa=function(){return new aY(this.oa())};p.iN=function(a){this.Oa=a;A(cHc(this),function(b){b.AA(a)});$Gc(this.C,a)};p.Gd=g("Oa");p.Lf=ta;
p.hN=function(a){this.Ra=a;for(var b=0;b<a.length;b++){if(this.L.cd()<this.$){var c=this.OO(a[b]);c.AA(this.Oa);var d=this.L.cd();c.qa=d;this.L.Ha(c,!0)}if(this.$pa()&&(this.C.uH(!1),c=this.C,d=this.OO(a[b]),c.C.push(d),c.fc)){YGc(c,!1);var e=c.H.cd();d.qa=e;c.H.Ha(d,!0);d.bJ()}}};function cHc(a){var b=[];a.L.Df(function(a){b.push(a)});return b}function bHc(a){return a.La("waffle-assistant-section-content")}p.pla=function(){return this.L.R7()};
p.UT=function(){this.Ra=[];ec(this.L.Hd(!0));this.setVisible(!1);this.$pa()&&(this.C.RV(),this.C.uH(!0))};function dHc(a){a.L.Df(function(a,c){c<this.$&&a.bJ()},a)}p.jN=function(a){var b=0;if(this.Na)this.C.rba();else if(this.pla()){this.setVisible(!0);b=Tf(this.La("waffle-assistant-section-header")).height+Tf(bHc(this)).height;for(var c=cHc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.BIa(c[d]),BGc(c[d],!0),b+=Tf(c[d].Da).height):BGc(c[d],!1)}else this.setVisible(!1);return a-b};p.BIa=ta;
p.o1=function(a){(this.Na=a)||this.C.V3()};p.Rb=g("Na");p.UVa=function(a){this.C&&YGc(this.C,a)};function eHc(a,b){a.C.Yoa(b,a.getTitle())}p.twb=function(){this.o1(!0);this.dispatchEvent("Od")};function cY(a,b,c,d,e,f){bY.call(this,20,e,d,f);this.qa=a;this.J=b;this.Aa=c;this.D=new PGc;this.va(this.D);this.F=null;this.H=0;this.O=null}y(cY,bY);p=cY.prototype;p.Ia=function(){cY.ma.Ia.call(this);this.D.Ke();this.getHandler().R(this.D,"drag",this.Y0b).R(this.D,"dragend",this.X0b)};p.getTitle=n("Analysis");p.FV=function(a){return 0==a};p.OO=function(a){return"WordCloud"==W(a,8).getChartType()?new SGc(a,this.oa()):new ZX(a,this.qa,this.J,this.Aa,this.V,this.D,this.O,this.oa())};
p.iN=function(a){cY.ma.iN.call(this,a);a&&Nxb(this.D)};p.BIa=function(a){this.getHandler().Vc(a,"content-rendered",this.W0b);this.H++};p.hN=function(a,b){this.O=b||null;cY.ma.hN.call(this,a,b)};p.W0b=function(){0==--this.H&&this.dispatchEvent("Ld")};p.Y0b=function(){this.F=Pf(this.D.fd.target)};p.X0b=function(a){var b=this.F,c=RG(this.J).C;if(xf(qL(c,"page",!1,!1)).contains(b)){var d=pL(c,b.x,b.y,"page");c=tL(c,d,"page");b=new Dd(b.x-c.left,b.y-c.top);a.C.getData().eJa(d,b)}this.F=null};p.n1=n(2);var fHc={F2a:0,mda:1,Jba:2,Ica:3,T2a:4,R1a:5,sva:6,fU:7,K1a:8,L1a:9},gHc={UNKNOWN_ERROR:0,fCc:1,rsc:2,aec:3},hHc={PBc:0,vec:1,Oba:2,ek:3,HBc:4,E4b:5,Pfc:6},iHc={MBc:0,RA:1,xsc:2,csc:3,Zuc:4},jHc={IBc:0,tsc:1,gE:2,ypc:3},kHc={zBc:0,gBc:1,xic:2,aAc:3,$zc:4,g8b:5,hqc:6},lHc={dzc:0,hE:1,xXa:2,$Ac:3,Wxc:4,t0a:5,dCc:6,ava:7,Nsa:8,vta:9,qU:10},mHc={UNKNOWN:0,o4b:1,n4b:2,m4b:3,H5b:4,u7b:5,a8b:6,Jac:7,Zec:8,Vqc:9,lvc:10,wvc:11,rzc:12,szc:13,EAc:14,Kuc:15};var nHc={DEFAULT:0,RIGHT:1,LEFT:2,dB:3,HA:4},oHc={Q1a:0,aqc:1};function pHc(){V.call(this)}y(pHc,V);var qHc=null;function dY(){V.call(this)}y(dY,V);var rHc=null;dY.prototype.getTitle=function(){return W(this,1)};function eY(){V.call(this)}y(eY,V);var sHc=null;eY.prototype.getPosition=function(){return W(this,1)};eY.prototype.setPosition=function(a){X(this,1,a)};function fY(){V.call(this)}y(fY,V);var tHc=null;function gY(){V.call(this)}y(gY,V);var uHc=null;
gY.prototype.getTitle=function(){return W(this,3)};pHc.prototype.Ca=function(){var a=qHc;a||(qHc=a=Wv(pHc,{0:{name:"ChartScale",sb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",Ba:14,defaultValue:0,type:oHc},2:{name:"factor",Ba:1,type:Number}}));return a};pHc.Ca=pHc.prototype.Ca;dY.prototype.Ca=function(){var a=rHc;a||(rHc=a=Wv(dY,{0:{name:"ChartTitle",sb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",Ba:9,type:String}}));return a};dY.Ca=dY.prototype.Ca;
eY.prototype.Ca=function(){var a=sHc;a||(sHc=a=Wv(eY,{0:{name:"ChartLegend",sb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",Ba:14,defaultValue:0,type:nHc}}));return a};eY.Ca=eY.prototype.Ca;fY.prototype.Ca=function(){var a=tHc;a||(tHc=a=Wv(fY,{0:{name:"ChartAxis",sb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",Ba:11,type:pHc}}));return a};fY.Ca=fY.prototype.Ca;
gY.prototype.Ca=function(){var a=uHc;a||(uHc=a=Wv(gY,{0:{name:"ChartOptions",sb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",Ba:11,type:fY},2:{name:"v_axis",Ba:11,type:fY},3:{name:"title",Ba:11,type:dY},4:{name:"subtitle",Ba:11,type:dY},5:{name:"legend",Ba:11,type:eY},6:{name:"chart_conversation",Ba:8,type:Boolean}}));return a};gY.Ca=gY.prototype.Ca;function hY(){V.call(this)}y(hY,V);var vHc=null;hY.prototype.Nj=function(){return W(this,1)};function iY(){V.call(this)}y(iY,V);var wHc=null;iY.prototype.getText=function(){return W(this,1)};iY.prototype.$q=function(){return Pv(this,1)};function jY(){V.call(this)}y(jY,V);var xHc=null;jY.prototype.getStatus=function(){return W(this,1)};jY.prototype.getError=function(){return W(this,9)};function kY(){V.call(this)}y(kY,V);var yHc=null;function zHc(){V.call(this)}y(zHc,V);var AHc=null;
function lY(){V.call(this)}y(lY,V);var BHc=null;lY.prototype.lC=function(){return Pv(this,1)};lY.prototype.getType=function(){return W(this,3)};lY.prototype.setType=function(a){X(this,3,a)};function CHc(){V.call(this)}y(CHc,V);var DHc=null;function EHc(){V.call(this)}y(EHc,V);var FHc=null;
hY.prototype.Ca=function(){var a=vHc;a||(vHc=a=Wv(hY,{0:{name:"Error",sb:"ritz.assistant.Error"},1:{name:"message",Ba:9,type:String},2:{name:"code",Ba:14,defaultValue:0,type:gHc},3:{name:"unsupported_op_reason",Ba:14,defaultValue:0,type:hHc}}));return a};hY.Ca=hY.prototype.Ca;
iY.prototype.Ca=function(){var a=wHc;a||(wHc=a=Wv(iY,{0:{name:"AnswerQueryPhrase",sb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ba:9,type:String},2:{name:"start_byte",Ba:5,type:Number},3:{name:"num_bytes",Ba:5,type:Number}}));return a};iY.Ca=iY.prototype.Ca;
jY.prototype.Ca=function(){var a=xHc;a||(xHc=a=Wv(jY,{0:{name:"AnswerResponse",sb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ba:5,type:Number},10:{name:"parse_status",Ba:14,defaultValue:0,type:iHc},11:{name:"answer_status",Ba:14,defaultValue:0,type:jHc},2:{name:"formula",Ba:9,type:String},3:{name:"debug_parse_response",Ba:9,type:String},4:{name:"interpretation",Ba:9,type:String},5:{name:"debug_interpretation_response",Ba:9,type:String},6:{name:"unused_phrase",Ic:!0,Ba:11,type:iY},7:{name:"used_entity_phrase",
Ic:!0,Ba:11,type:iY},8:{name:"unused_entity_phrase",Ic:!0,Ba:11,type:iY},9:{name:"error",Ba:11,type:hY},12:{name:"alternate_suggestion",Ic:!0,Ba:11,type:lY},14:{name:"deprecated_formula_builder_used",Ba:9,type:String},15:{name:"answer_visualization_type",Ic:!0,Ba:14,defaultValue:0,type:lHc},16:{name:"formula_builder_used",Ba:14,defaultValue:0,type:mHc},17:{name:"charting_info",Ba:11,type:zHc},18:{name:"answer_field_info",Ic:!0,Ba:11,type:kY},19:{name:"charting_formula",Ba:9,type:String},21:{name:"parse_info",
Ic:!0,Ba:11,type:CHc},22:{name:"answer_field_info_for_ranges",Ic:!0,Ba:11,type:kY},23:{name:"va_query",Ba:9,type:String},24:{name:"pivot_table_def",Ba:11,type:ty}}));return a};jY.Ca=jY.prototype.Ca;kY.prototype.Ca=function(){var a=yHc;a||(yHc=a=Wv(kY,{0:{name:"AnswerFieldInfo",sb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ba:14,defaultValue:0,type:qUa},2:{name:"range_ref",Ba:9,type:String}}));return a};kY.Ca=kY.prototype.Ca;
zHc.prototype.Ca=function(){var a=AHc;a||(AHc=a=Wv(zHc,{0:{name:"ChartingInfo",sb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Ic:!0,Ba:14,defaultValue:0,type:lHc},2:{name:"recommended",Ba:8,type:Boolean},3:{name:"user_requested_type",Ic:!0,Ba:14,defaultValue:0,type:lHc},4:{name:"show_only_chart",Ba:8,type:Boolean},5:{name:"chart_options",Ba:11,type:gY}}));return a};zHc.Ca=zHc.prototype.Ca;
lY.prototype.Ca=function(){var a=BHc;a||(BHc=a=Wv(lY,{0:{name:"QuerySuggestion",sb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ba:9,type:String},2:{name:"formula",Ba:9,type:String},3:{name:"type",Ba:14,defaultValue:0,type:kHc},4:{name:"deprecated_formula_builder_used",Ba:9,type:String},5:{name:"formula_builder_used",Ba:14,defaultValue:0,type:mHc}}));return a};lY.Ca=lY.prototype.Ca;
CHc.prototype.Ca=function(){var a=DHc;a||(DHc=a=Wv(CHc,{0:{name:"ParseInfo",sb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Ic:!0,Ba:11,type:EHc}}));return a};CHc.Ca=CHc.prototype.Ca;EHc.prototype.Ca=function(){var a=FHc;a||(FHc=a=Wv(EHc,{0:{name:"IntentInfo",sb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ba:14,defaultValue:0,type:fHc}}));return a};EHc.Ca=EHc.prototype.Ca;function GHc(){this.D=this.J="";this.L=!1;this.F=0;this.O=!1;this.H=0;this.C=""}GHc.prototype.getTitle=g("J");var HHc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),IHc=[{Vj:["Thank you","Thankyou","Thanks"],xq:"No problem"},{Vj:["you are amazing","This is great","omg"],xq:"Happy to help"},{Vj:["I love you"],xq:"Must be in the air"},{Vj:["How do you know","How are you so smart"],xq:"It's all in the data"},{Vj:["Are you sure"],xq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Vj:["How are you"],xq:"Pretty good, thanks"},
{Vj:["Hi","Hello","Hey"],xq:"Hi, there. Try asking a question about your data."},{Vj:["You are stupid","This is dumb","You are wrong"],xq:"Help improve this experience by sending feedback"},{Vj:["How smart are you"],xq:"Pretty smart"}];function JHc(a){for(var b=0;b<IHc.length;++b)if(-1!=Fb(IHc[b].Vj,function(b){return Ua(a,b)}))return b;return-1};function KHc(a,b,c,d){var e=new qFc;J(e,2,c);A(b,function(a){Qh(e,1).push(a)});J(e,3,d);d=new NX;J(d,1,a);J(d,3,b[c]);Uh(d,11,e);return d}function LHc(a,b,c,d){var e=new mFc;J(e,2,c);A(b,function(a){Qh(e,1).push(a)});J(e,3,d);d=new NX;J(d,1,a);J(d,2,b[c]);Uh(d,10,e);return d}function MHc(a){var b=new kFc;A(a,function(a){var c=a.type;Qh(b,1).push(c);a.PEa&&(a=a.PEa,Qh(b,2).push(a))});return b}function NHc(a){var b=new oFc;A(a,function(a){a=a.type;Qh(b,1).push(a)});return b}
function OHc(a,b,c,d){var e=new sFc;a&&J(e,1,a);b&&J(e,2,b);for(a=0;a<c.length;a++)b=c[a],Qh(e,3).push(b);J(e,4,d);return e};function mY(a,b){this.D=a;this.C=b}mY.prototype.getChartType=g("D");var nY={2:new mY("ColumnChart","Column chart"),3:new mY("LineChart","Time series"),4:new mY("ScatterChart","Scatter chart"),5:new mY("PieChart","Pie chart"),10:new mY("Histogram","Histogram"),7:new mY("LineChart","Line chart")};function oY(a,b,c,d,e,f,h){this.D=a;this.hB=b;this.H=(void 0===h?null:h)||b;this.C=d;this.Wm=c;this.Ga=d?Uv(d,6):[];this.Ka=d?Uv(d,7):[];this.Aa=d?Uv(d,8):[];this.error=e||1;this.interpretation=d&&Pv(d,4)?W(d,4):null;this.TVa=new GHc;this.O=d?Uv(d,12):[];this.qa=d?Uv(d,21):[];this.ea=f;this.F=null;this.$=this.J=!1;this.L=[];this.V=null;AA&&PHc(this)}function QHc(a){return 1==a.error&&null!=a.Wm}
function RHc(a){return{RL:SHc(a),interpretation:a.interpretation,hB:a.hB,Wm:a.Wm,kL:1<a.hB.length&&1<a.hB[0].length,Rj:a.Rj(),nqa:a.$,sx:a.sx(),k8:a.L}}oY.prototype.Rj=function(){return AA&&null!=this.F&&(this.F in nY?!0:!1)&&2<this.H.length};oY.prototype.sx=function(){return zA&&L(K(),"feapt")&&null!==this.C&&Pv(this.C,24)};oY.prototype.getChartType=function(){if(!this.Rj())return null;var a=this.F;if(a in nY)return nY[a].getChartType();throw Error("Unknown chart type.");};
function THc(a){a.Rj();return a.H[0][0]}function UHc(a){return Ab(Uv(a.C,22),function(b){if(W(b,2)){var c=a.ea.C;b=W(b,2);return MG(b,c)}},a)}function VHc(a){return{RL:SHc(a),error:WHc(a)}}function XHc(a,b,c){var d=c.length;if(0==d)return a;1<d&&Nb(a,10);c=W(c[0],1);2<d&&9==c&&Nb(a,4);2<d&&Nb(a,5);2!=c&&3!=c&&12!=c&&Nb(a,3);Gb(b,10)&&Gb(a,10)&&dba(a,function(a){return 10!=a});return a}
function PHc(a){var b=null;a.J=!1;a.F=null;if(a.C&&Pv(a.C,17)){var c=W(a.C,17);a.$=W(c,4)||!1;var d=Uv(c,3),e=XHc(Uv(c,1),d,Uv(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=zb(e,function(a){return Gb(d,a)}),c=zb(d,function(a){return!Gb(e,a)}),Nb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):Gb(d,10)&&Gb(e,2)?(a.J=!0,a.F=2,Nb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=YHc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=YHc(a,e),a.J=W(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=OHc(a.F,b,e,a.J))}}function YHc(a,b){if(!Uv(a.C,18).length)return b[0];a=ZHc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(Gb(b,a[c]))return a[c];return b[0]}function $Hc(a,b,c){var d={};null!=b?(d.v=aIc(a,b,c),d.f=b):d.v=null;return d}
function ZHc(a){for(var b=new PJ,c=a.H[0],d=Ub(a.H,1),e=Uv(a.C,18),f=[],h=0;h<c.length;h++)null!=e[h]&&Pv(e[h],1)?f.push(bIc(W(e[h],1))):f.push(0==h?"string":"number"),b.Gs({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push($Hc(a,d[e][k],f[k]));b.Wu(h)}return b}
function aIc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=a.ea.L.H,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),tb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&ab(a[0])&&ab(a[1])&&(ab(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)ab(a[d])&&(c[d]=tb(a[d]));
"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function bIc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function cIc(a){if(!Pv(a.C,9))return"";if(Pv(a.C.getError(),3))switch(W(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Nj()||""}
function WHc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return cIc(a)||"Sorry, couldn't understand your question.";case 7:return a=JHc(a.D),-1!=a?IHc[a].xq:""}return""}
function SHc(a){var b=[];if(QHc(a)){var c=[];A(Qb(a.Ga,a.Aa),function(a){c.push(dIc(a,"waffle-assistant-answercard-question-unused-phrase"))});A(a.Ka,function(a){c.push(dIc(a,"waffle-assistant-answercard-question-used-entity"))});Yb(c,function(a,b){return a.pT>b.pT?1:-1});var d=0;A(c,function(c){var e=c.length,h=c.pT;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Ck}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function dIc(a,b){return{pT:W(a,2),length:W(a,3),Ck:b}};function eIc(a){this.C=a}function fIc(a,b){var c=new MX;J(c,3,b);J(c,8,$0a);b=new xU;Uh(b,4,c);c=new ci;Uh(c,46,b);c=hj(gj(new fj,10),c).build();a.C.Xb(2753,c)};function gIc(a,b,c){return R('<div class="waffle-assistant-answers-card-remove">'+Q(as({icon:"docs-icon-img docs-icon-trash"},null,c||b))+"</div>")}
function hIc(a,b){var c=a.error;a=a.showHelp;b='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+Q(as({icon:"docs-icon-img docs-icon-unsupported-black"},null,b||null))+'</div><div class="waffle-assistant-errorcard-content">';a?(c=Q(c)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',b+='<div class="waffle-assistant-errorcard-text">'+c+"</div>"):b+='<div class="waffle-assistant-errorcard-text">'+
Q(c)+"</div>";return R(b+"</div></div>")};function iIc(a,b,c){b=c||b;c=R;var d='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+jIc({RL:a.iB.RL}),e={hB:a.iB.hB,Wm:a.iB.Wm,interpretation:a.iB.interpretation,kL:a.iB.kL,Rj:a.iB.Rj,sx:a.iB.sx,nqa:a.iB.nqa,k8:a.iB.k8};b=b||null;null==e.hB||za(e.hB);var f=e.hB;a=e.Wm;var h=e.kL,k=e.Rj,l=e.sx,m=e.nqa;za(e.k8);var q=e.k8;e=e||{};e=e.interpretation;e=""+('<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+cq("Answer")+'"><span aria-hidden="true">Answer</span></div>'+
(e?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+Q(e)+"</div></div>":"")+"");var t='<div class="waffle-assistant-answercard-answer-container">'+R(e)+'<div class="waffle-assistant-answercard-answer-content">';if(f){if(!m)if(k&&(t+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
l)t+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{t+='<div class="waffle-assistant-answercard-answer">';if(h){t+='<div class="waffle-assistant-answercard-answer-rowheader">';m=f[0];e=m.length;for(var w=0;w<e;w++)t+='<span class="waffle-assistant-answercard-answer-col">'+Q(m[w])+"</span>";t+="</div>"}t+='<div class="waffle-assistant-answercard-answer-rows">';m=Vp("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));e=f.length;for(w=
0;w<e;w++){var x=f[w];if(h&&0==w)x="";else{var z=m;za(x);z='<div class="'+T(z)+'">';for(var C=x.length,M=0;M<C;M++){var O=x[M];z=O?z+('<span class="waffle-assistant-answercard-answer-col">'+Q(O)+"</span>"):z+('<span class="'+T("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}x=R(z+"</div>")}t+=x}t+="</div></div>"}t+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<q.length){t+='<div class="waffle-assistant-answercard-info-msgs">';f=q.length;for(h=0;h<f;h++)t+='<div class="waffle-assistant-answercard-info-msg">* '+Q(q[h])+"</div>";t+="</div>"}t+='<div class="waffle-assistant-answercard-footer">';l&&(t+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>');k&&(t+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');l||(t+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
Q(as({icon:"docs-icon-img docs-icon-insert-formula"},null,b))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+Q(a)+"</div></div></div></div></div>");b=R(t+"</div></div></div>");return c(d+b+"</div></div>")}
function jIc(a){za(a.RL);a=a.RL;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+cq("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+T(e.className)+'">'+Q(e.text)+"</span>":Q(e.text)}return R(b+"</div></div></div>")}
function kIc(a,b,c){b=c||b;a=a.sx;return R(""+Q(gIc(null,null,b))+(a?'<div class="waffle-assistant-button-separator"></div>'+Q(er({Ed:"waffle-assistant-zoom-button",content:$p(""+Q(as({icon:"docs-icon-img docs-icon-zoom-in"},null,b))),style:4},null,b)):"")+"")};function lIc(a,b,c,d){F.call(this);this.$=a;this.V=b;this.ea=c;this.Ka=d;this.Ja=new rf(this);this.va(this.Ja);this.C=new zW;this.va(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;qzc(this.C,this.$);this.C.qa=10;this.C.Ra=!0;this.C.V=!1;this.C.pSa("waffle-assistant-visible");this.C.L=bb("waffle-assistant-dragged-formula").split(" ");this.C.Ke();this.Ja.R(this.C,jzc,this.Aa).R(this.C,mzc,this.Ga).R(this.C,nzc,this.qa)}y(lIc,F);
lIc.prototype.Aa=function(a){a=xb(this.$.childNodes,a.C);this.O=this.L[a]};
lIc.prototype.Ga=function(a){var b=a.event instanceof cp?a.event.xm:a.event;this.H?(a.J.sz(b,!0),a.preventDefault()):(Hf(a.F,a.event.clientX,a.event.clientY),a=If(a.F),b=RG(this.V).C,xf(qL(b,"page",!1,!1)).contains(a)?(a=pL(b,a.x,a.y,"page"),(b=wI(HK(this.ea),a.y,a.x))?a=new Dd(b.rc(),b.wc()):b=Nz(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=RG(this.V),D(this.D),this.D=Usc(a,b,"waffle-assistant-formula-insertion-rect"),this.va(this.D),IN(a.O,"default",this.D),D(this.F),this.F=KN(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.va(this.F),pCb(this.F,"#000"),this.F.setVisible(!0))):mIc(this))};lIc.prototype.qa=function(a){if(this.J){oO(RG(this.V),!1);var b=this.J,c=HK(this.ea);b=new CO(c,b,this.O);this.Ka.C(b);this.dispatchEvent(new E("formula_inserted"))}a.J.sz(null,!0);a.preventDefault();this.O="";mIc(this)};function mIc(a){a.J=null;D(a.D);a.D=null;D(a.F);a.F=null};function pY(a,b,c,d,e,f,h,k,l,m,q,t,w){XX.call(this,new rG,w);this.D=a;this.Xh=UHc(a);this.Ta=a.Rj();this.Na=a.sx();this.hf=q;this.$=this.C=this.xb=null;this.kb=a.Rj()&&a.J;this.Kd=a.$;this.Eb=!1;this.eg=b;this.Xe=c;this.Je=d;this.cj=l;this.Zh=h;this.V=e;this.hh=f;this.Ag=k;this.Pe=m;this.xe=gj(new fj,10).build();this.Bd=new dr("",new RX,this.oa());this.Ha(this.Bd);this.wh=t;this.Ua=new dr("",new RX,this.oa());this.Ha(this.Ua);this.Ab=new dr("",new RX,this.oa());this.Ha(this.Ab);this.ea=null;this.O=
new dr("",new uW,this.oa());this.Ha(this.O);this.H=a.TVa;this.Oa=new dr("",new uW,this.oa());this.Ha(this.Oa);this.rb=new dr("",new RX,this.oa());this.Ha(this.rb);this.L=new oV;this.Ha(this.L);this.Ka=new WN("");this.Ha(this.Ka);this.J=null;this.Fc=ZHc(this.D);this.Xc=new wW(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.va(this.Xc);this.vd=!1}y(pY,XX);p=pY.prototype;p.fia=g("Ag");
p.xa=function(){pY.ma.xa.call(this);zGc(this).appendChild(P(kIc,{sx:this.Na}))};
p.Ia=function(){pY.ma.Ia.call(this);var a=this.La("waffle-assistant-answers-card-remove");this.Bd.Va(a);UX(a,"Remove card",0);this.getHandler().Vc(this.Bd,"action",this.n1b);if(this.D.sx()){a=HK(this.Xe).jc();var b=this.D;b.sx();b=b.C?W(b.C,24):null;var c=azc(this.wh,b);this.xb=new dzc(c,b,this.cj.L.C,this.hf,a,this.Je)}else this.getHandler().R(this.O,"action",this.RBb).R(this.Oa,"action",this.htb).Vc(this.O,"action",this.vNa).Vc(this.Oa,"action",this.uJb)};
function nIc(a){function b(b,d,e,f){var c=new mV("");c.Va(a.La(b));a.L.Ha(c);a.getHandler().Vc(c,"action",v(a.rJb,a,d));f||c.setVisible(!1);e&&a.L.rH(c)}a.L.Va(a.La("waffle-assistant-answercard-tabs"));a.getHandler().R(a.L,"select",a.mEb);b("waffle-assistant-answercard-formula-tab",0,!a.kb,!a.Na);b("waffle-assistant-answercard-pivot-tab",1,!a.kb,a.Na);b("waffle-assistant-answercard-chart-tab",2,a.kb,!0)}
function oIc(a){var b=W(a.D.C,17);b=Uv(b,1);for(var c=0;c<b.length;c++)a.Ka.Nd(pIc(b[c]));a.Ka.Va(a.La("waffle-assistant-answercard-chart-type-select"));ur(a.Ka,pIc(a.D.F));b=a.La("waffle-assistant-answercard-insert-chart");a.rb.Va(b);qIc(a);a.getHandler().R(a.rb,"action",a.k1b).R(a.Ka.Cc(),"action",a.Ymb)}
p.zA=function(a){YX(this).appendChild(P(iIc,{iB:RHc(this.D)}));if(this.D.sx()){this.Ta&&(nIc(this),oIc(this));var b=this.La("waffle-assistant-answercard-insert-pivot");this.Ua.Va(b);b=this.La("waffle-assistant-zoom-button");this.Ab.Va(b);UX(b,"Preview Pivot Table");this.getHandler().R(this.Ua,"action",this.l1b).R(this.Ab,"action",this.m1b);rIc(this);this.C=this.oa().xa("CANVAS","waffle-pivottable-pivot-canvas-border");b=this.La("waffle-assistant-answercard-pivot-content");this.oa().appendChild(b,
this.C);fzc(this.xb,this.C)}else this.O.Va(this.La("waffle-assistant-answercard-see-formula-link")),this.Oa.Va(this.La("waffle-assistant-answercard-hide-formula-link")),this.ea=new lIc(this.La("waffle-assistant-answercard-formula-text-container"),this.eg,this.Xe,this.Je),b=this.Gd(),this.ea.H=b,this.ea.L=[this.D.Wm],this.va(this.ea),b=this.La("waffle-assistant-answercard-formula-text"),sg(b,"Formula: "+(this.D.Wm+". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Vc(this.ea,
"formula_inserted",this.tJb).Wg(this.La("waffle-assistant-answercard-formula-text"),nf,this.psb),sIc(this,this.Pe),tIc(this),this.Pe&&(uIc(this,!0),this.getHandler().Rc(this.O,"action",this.vNa)),this.Ta&&(this.Kd?(vIc(this,this.D.getChartType()),this.Eb=!0):nIc(this),oIc(this));a()};p.uM=function(){return this.Ta&&!this.Kd&&!this.kb};function pIc(a){if(a in nY)return new ek(nY[a].C,a);throw Error("Unknown chart type.");}
p.Ymb=function(a){a=a.target.Sa();if(a in nY)vIc(this,nY[a].getChartType());else throw Error("Unknown chart type model.");};function wIc(a,b){a.H.D&&b.setOption("subtitle",a.H.D);b.setOption("hAxis.logScale",a.H.L);b.setOption("vAxis.logScale",a.H.O);a.H.C&&b.setOption("legend.position",a.H.C);a.H.F&&b.setOption("hAxis.formatOptions.scaleFactor",a.H.F);a.H.H&&b.setOption("vAxis.formatOptions.scaleFactor",a.H.H)}
function vIc(a,b){a.J=new jG;X(a.J,1,b);X(a.J,2,a.D.interpretation||"");if("Histogram"===b)b=THc(a.D),X(a.J,3,b),X(a.J,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.Fc.dd(0)&&(b=a.Fc.Pf(0),X(a.J,3,b),b=1),1==a.Fc.getNumberOfColumns()-b?(b=a.Fc.Pf(b),X(a.J,6,b)):X(a.J,6,"Values");else{b=a.J;var c=THc(a.D);X(b,3,c);c=a.D;c.Rj();X(b,6,c.H[0][1]||"")}b=uGc(a.J);b.Wd(a.Fc);c=a.La("waffle-assistant-answercard-chart");b=vGc(b,c);NV(b,b.Pd());wIc(a,b);b.setOption("title",a.H.getTitle());
kW(b,c,a.hf.C,a.V,DA);a.Eb=!0}p.l1b=function(){ezc(this.xb);this.dispatchEvent("close-sidebar");this.V.C(35619,gj(new fj,67).build())};p.m1b=function(){var a=gj(new fj,67).build();this.V.C(35620,a);D(this.$);this.$=new hzc(this.xb,this.Ab,this.D.interpretation||"",this.V,a,35621,this.oa());this.$.render();this.va(this.$);CFc(this.$,this.Gd())};
p.k1b=function(){if(this.J){var a=uGc(this.J);a.Wd(this.Fc);wIc(this,a);this.H.getTitle()&&a.setOption("title",this.H.getTitle());NV(a,a.Pd());var b=this.qa,c=this.Fc,d=this.D.F,e=new uFc;J(e,1,d);d=new MX;Uh(d,11,e);e=new xU;Uh(e,4,d);d=new ci;Uh(d,46,e);this.dispatchEvent(new cGc(a,b,c,2874,void 0,void 0,d))}};p.sA=function(){sg(this.Da,"Answer Card for question: "+this.D.D)};p.yA=He;p.jz=n("assistantAnswersFeedback");p.UB=n(2628);p.TB=n(2627);p.e6=n("Was this answer correct?");p.Wia=n("Correct");
p.Via=n("Incorrect");p.gN=g("D");p.AA=function(a){pY.ma.AA.call(this,a);this.ea&&(this.ea.H=a);this.$&&CFc(this.$,a);tIc(this);qIc(this);rIc(this)};p.m1=function(){pY.ma.m1.call(this);if(!this.vd){var a=this.Xc,b=this.Xh;yW(a);for(var c=0;c<b.length;c++)bzc(a,b[c]);this.vd=!0}};p.RT=function(){pY.ma.RT.call(this);yW(this.Xc);this.vd=!1};p.mEb=function(){switch(qV(this.L)){case 0:xIc(this,!1);break;case 1:xIc(this,!1);rIc(this);break;case 2:xIc(this,!0);rIc(this);break;default:qV(this.L)}};
function xIc(a,b){G(a.La("waffle-assistant-answercard-chart-container"),b);a.Na?G(a.La("waffle-assistant-answercard-pivot-content"),!b):(G(a.La("waffle-assistant-answercard-answer"),!b),G(a.La("waffle-assistant-answercard-formula-holder"),!b));qIc(a);!a.Eb&&b&&vIc(a,a.D.getChartType())}function tIc(a){var b=a.yb("waffle-assistant-answercard-formula-help");b&&G(b,!a.Gd())}function qIc(a){var b=(a.Kd||2==qV(a.L))&&!a.Gd();a.rb.setVisible(b)}
function rIc(a){var b=a.Na&&!a.Gd()&&(!a.Ta||1==qV(a.L));a.Ua.setVisible(b)}function sIc(a,b){a.O.setVisible(!b);a.Oa.setVisible(b);G(a.La("waffle-assistant-answercard-formula"),b);b?a.La("waffle-assistant-answercard-formula-text").focus():(a.O.Da.focus(),a.O.Mp(!0))}p.n1b=function(){fIc(this.hh,!0);this.dispatchEvent(new E("rc"))};p.RBb=function(){sIc(this,!0)};p.htb=function(){sIc(this,!1)};p.vNa=function(){uIc(this,!0)};p.uJb=function(){uIc(this,!1)};
function uIc(a,b){var c=new MX;J(c,9,b);b=new xU;Uh(b,4,c);c=new ci;Uh(c,46,b);c=hj(gj(new fj,10),c).build();a.V.Xb(2849,c)}p.rJb=function(a){var b=this.D.V,c=new tFc;Uh(c,1,b);switch(a){case 0:J(c,2,2);break;case 1:J(c,2,3);break;case 2:J(c,2,1);break;default:J(c,2,0)}a=new MX;Uh(a,10,c);c=new xU;Uh(c,4,a);a=new ci;Uh(a,46,c);c=hj(gj(new fj,10),a).build();this.V.Xb(2850,c)};p.tJb=function(){this.V.Xb(2709,this.xe)};
p.psb=function(){var a=this.oa().Gb(),b=a.createElement("textarea");b.textContent=this.D.Wm;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(yIc(this.Zh,"Formula copied to clipboard",this.oa()),this.V.C(35534,this.xe))};function zIc(a,b,c){b=c||b;return R('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Q(jIc({RL:a.VDa.RL}))+Q(hIc({error:a.VDa.error,showHelp:a.showHelp},b))+"</div></div>")}function AIc(){return R('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function qY(a,b,c,d,e){XX.call(this,new rG,e);this.H=a;this.O=b;this.L=d;this.V=c;this.J=new dr("",new RX,this.oa());this.Ha(this.J);this.C=new dr("",new uW,this.oa());this.Ha(this.C);this.D=new dr("",new uW,this.oa());this.Ha(this.D)}y(qY,XX);p=qY.prototype;p.sA=function(){sg(this.Da,"Error Card for question: "+this.H.D)};p.jz=n("assistantAnswersFeedback");p.yA=He;p.X7=Ge;p.xa=function(){qY.ma.xa.call(this);zGc(this).appendChild(P(gIc))};
p.Ia=function(){qY.ma.Ia.call(this);var a=this.La("waffle-assistant-answers-card-remove");this.J.Va(a);this.D.setVisible(this.L);UX(a,"Remove card",0);this.getHandler().Vc(this.J,"action",this.t1b).Vc(this.C,"action",this.cCb).R(this.D,"action",this.s1b)};
p.zA=function(a){YX(this).appendChild(P(zIc,{VDa:VHc(this.H),showHelp:this.L}));if(yA){var b=P(AIc);this.oa().appendChild(this.Da,b);this.C.Va(this.La("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.Va(this.La("waffle-assistant-answers-helpcenter-link"));a()};p.fia=g("O");p.gN=g("H");p.cCb=function(){this.C.setVisible(!1);G(this.La("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new E("trigger_feedback"))};p.t1b=function(){fIc(this.V,!1);this.dispatchEvent(new E("rc"))};
p.s1b=function(){N.qo.yc()};function BIc(a){XX.call(this,new rG,a);this.C=this.oa().createElement("div");pe(this.C,"Previous")}y(BIc,XX);p=BIc.prototype;p.sA=function(){sg(this.Da,"Previous questions below")};p.xa=function(){BIc.ma.xa.call(this);Ve(this.Da,"waffle-assistant-card");Te(this.Da,"waffle-assistant-answers-previousheadercard")};p.zA=function(a){0<this.oa().Oh(YX(this)).length||YX(this).appendChild(this.C);a()};p.X7=Ge;p.jz=n("assistantAnswersFeedback");function CIc(a,b,c){b=c||b;c=""+(""+(a.Y4?Q(hIc({error:a.Y4,showHelp:a.showHelp},b)):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+Q(a.title)+"</div>":""));var d=Vp("Suggested question");c+='<div class="waffle-assistant-suggested-questions">';a=a.jw;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+T(d)+'">'+Q(as({icon:"docs-icon-img docs-icon-help"},
null,b))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+Q(h)+"</div></div></div>"}return R(c+"</div>")};function rY(a,b,c,d,e,f){XX.call(this,a,f);this.C=e||null;this.O=b;this.D=d;this.V=c;this.L=this.C?5==this.C.error:!1;this.H=new dr("",new uW,this.oa());this.Ha(this.H);this.J=new dr("",new RX,this.oa());this.Ha(this.J)}y(rY,XX);p=rY.prototype;p.xa=function(){rY.ma.xa.call(this);this.yA()&&zGc(this).appendChild(P(gIc))};
p.Ia=function(){rY.ma.Ia.call(this);Te(this.Da,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.u1b);if(this.yA()){var a=this.La("waffle-assistant-answers-card-remove");this.J.Va(a);UX(a,"Remove card",0);this.getHandler().Vc(this.J,"action",this.v1b)}};p.UB=function(){return Gb([DIc,EIc],this.D)?2799:Gb([FIc,GIc],this.D)?2801:null};p.TB=function(){return Gb([DIc,EIc],this.D)?2798:Gb([FIc,GIc],this.D)?2800:null};p.e6=n("Were these interesting?");
p.Wia=n("Interesting");p.Via=n("Not interesting");p.jz=n("assistantAnswersFeedback");p.yA=function(){return this.C?!QHc(this.C):!1};p.sA=function(){var a=this.D.title;a&&this.C?sg(this.Da,a+(" for question : "+this.C.D)):sg(this.Da,"Suggested questions")};
p.zA=function(a){var b=this;this.V.then(function(c){if(b.Yb()){if(0==c.length)G(b.Da,!1);else{var d=b.oa(),e=YX(b);if(0==d.Oh(e).length){var f=P(CIc,{title:b.D.title,jw:Ab(c,function(a){return a.query}),Y4:b.C?WHc(b.C):"",showHelp:b.L});e.appendChild(f);var h=Ab(c,function(a){return a.type});e=b.Ki("waffle-assistant-answercard-question-container");A(e,function(a,e){var f=new dr("",new RX,d);b.Ha(f);f.Va(a);b.getHandler().R(f,"action",v(b.XDb,b,c[e],h,e))});b.L&&b.H.Va(b.La("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.v1b=function(){fIc(this.O,!1);this.dispatchEvent(new E("rc"))};p.XDb=function(a,b,c){this.dispatchEvent(new JFc(this.D.D0,a.Wm||null,b,c,this.D.KV,a.query))};p.u1b=function(){N.qo.yc()};var HIc={title:"",KV:0,D0:null},DIc={title:"",KV:5,D0:1},EIc={title:"Suggested questions",KV:5,D0:1},GIc={title:"Did you mean?",KV:2,D0:4},FIc={title:"Related questions",KV:4,D0:4};function IIc(a){var b=[];if(Pv(a,25)&&(a=W(a,25)))for(var c=0;c<Qv(a,1);c++){var d=W(a,1,c);if(Pv(d,2)){var e=W(d,2);e&&b.push(JIc(e,KIc(d)))}}return b}function LIc(a){var b=IIc(a);Pv(a,6)&&(a=W(a,6))&&b.push(JIc(a,0));return b}function KIc(a){return(a=Pv(a,4)?W(a,4):0)?a:0}function JIc(a,b){return{name:a,E3a:b}};function MIc(a,b,c){this.qa=a;this.Aa=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.ea=[];this.C={};this.F={};this.V={};this.D={};NIc(this,c)}function OIc(a,b){return a[b]?a[b].values.Cd():[]}
function NIc(a,b){for(var c=new Qq,d=new Qq,e=0;e<b.length;e++){for(var f=LIc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.qa[m]){var q=a.qa[m];c.add(q);h.push(q)}void 0!=a.Aa[m]&&(m=a.Aa[m],d.add(m),k.push(m))}PIc(a,h,k)}a.L=c.Cd();a.O=d.Cd();Yb(a.L);Yb(a.O);a.H=Ab(nc(a.C),function(a){return a.key});Yb(a.H);a.J=Ab(nc(a.F),function(a){return a.key});Yb(a.J);a.$=Ab(nc(a.V),function(a){return a.key});Yb(a.$);a.ea=Ab(nc(a.D),function(a){return a.key});Yb(a.ea)}
function PIc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(QIc(a.C,b[d],b[e]),QIc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)QIc(a.F,b[d],c[e]),QIc(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(QIc(a.D,c[b],c[d]),QIc(a.D,c[d],c[b]))}function QIc(a,b,c){var d;a[b]?d=a[b].values:d=new Qq;d.add(c);a[b]={key:b,values:d}};function RIc(a,b){this.C=a;for(var c={},d=0;d<a.Kj();d++)c[a.hd(d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Qv(a,1);d++)c[W(a,1,d).getName().toLowerCase()]=d;this.V=c;c={};for(d=0;d<this.C.Kj();d++)c[W(this.C.hd(d),11)]=d;this.ea=c;c={};for(d=0;d<Qv(this.C,1);d++)c[W(W(this.C,1,d),4)]=d;this.qa=c;c=[];for(d=0;d<a.Kj();d++)sY(a.hd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Qv(a,1);d++)sY(W(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Qv(a,1);d++){for(var e=W(a,1,d).getName(),
f=!0,h=0;h<SIc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+SIc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ga=c;this.Na=TIc(a,0);this.$=TIc(a,1);c=[];for(d=0;d<a.Kj();d++).8<=W(a.hd(d),6)&&c.push(d);this.Aa=c;c=[];for(d=0;d<a.Kj();d++)e=a.hd(d),.95<=Uv(e,2).length/W(e,8)&&c.push(d);this.Oa=c;c=[];for(d=0;d<Qv(a,3);d++){e=a.hd(W(a,3,d));a:if(.5<Uv(e,2).length/W(e,8)||.3>Qv(e,3)/Qv(e,2))e=!1;else{for(f=0;f<Qv(e,10);f++)if(.95<W(e,10,f)/W(e,8)){e=!1;break a}e=!0}e&&c.push(W(a,3,d))}Yb(c);this.Ka=
c;this.F=UIc(a.Kj());this.H=UIc(Qv(a,1));this.D=new MIc(this.O,this.V,b)}function UIc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function TIc(a,b){for(var c=[],d=0;d<a.Kj();d++)a.hd(d).getType()==b&&c.push(d);return c}function VIc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=WIc(c,a[d]);for(a=0;a<b.length;a++)d=WIc(c,b[a]),c=0<d.length?d:c;return c}
function tY(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.Na),m.push(a.Aa));d&&m.push(a.Ka);e&&m.push(a.Oa);null!=h&&-1!=h?l.push(OIc(a.D.V,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=VIc(m,l);b=WIc(a,b);return 0<b.length?{index:QX(b),tB:3}:0<a.length?{index:QX(a),tB:1}:XIc()}
function uY(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Ga);null!=e&&-1!=e?h.push(OIc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.ea);a=VIc(k,h);b=WIc(a,b);return 0<b.length?{index:QX(b),tB:3}:0<a.length?{index:QX(a),tB:1}:XIc()}function YIc(a,b){for(var c=5;;){var d=a.C.hd(b),e=PX(Qv(d,2),1)[0];c--;if(sY(OX(d,e))||0==c)return e}}function ZIc(a,b){for(var c=5;;){var d=a.C.hd(b),e=PX(Qv(d,3),1)[0];e=W(d,3,e);c--;if(sY(OX(d,e))||0==c)return e}}
function vY(a,b){b=a.C.hd(b);a=b.getName();sY(a)||(b=$Ic(Uv(b,7)),a=null==b?a:b);return a}function wY(a,b){b=W(a.C,1,b);a=b.getName();sY(a)||(b=$Ic(Uv(b,2)),a=null==b?a:b);return a}function $Ic(a){for(var b=0;b<a.length;b++)if(sY(a[b]))return a[b];return null}function sY(a){return null==a?!1:50>=a.length}function aJc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function XIc(){return{index:-1,tB:0}}
function bJc(a){for(var b=PX(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],tB:1});return c}function WIc(a,b){Yb(a);Yb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var SIc=["average","total","sum","mean","median"];function xY(a){this.Na=a;this.jw=[];this.C=this.qa=this.ea=this.UK=this.yH=null;this.V=[];this.Ka=[];this.O=new Qq;this.Aa=new Qq;this.$=!1;this.D=[];this.F=[]}p=xY.prototype;p.Ke=function(a,b,c,d,e,f){this.reset();this.yH=b;this.UK=c;this.ea=d;this.qa=a;this.Ka=f;this.V=L0a?e:[];this.C=new RIc(a,e)};
p.u9=function(){cJc(this);var a=[];if(L0a)for(var b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.wk(13)||this.wk(2)){var d=W(c,6);if(d&&-1!=aJc(this.C,d)){var e=dJc(this,c);1<e.length&&(AA&&this.wk(23)?yY(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.wk(2)&&yY(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=dJc(this,c);1<f.length&&(AA&&this.wk(23)?yY(this,a,"Scatter chart of "+f[0].name+" vs "+
f[1].name,23,2):this.wk(2)&&yY(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=IIc(c),m=0;m<l.length&&-1!=aJc(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].E3a&&(AA&&this.wk(20)?yY(this,a,"Chart of distribution of "+h[0].name,20,2):this.wk(14)&&yY(this,a,"Distribution of "+h[0].name,14,1.5))}}if(this.wk(26))for(var q=ja(this.Ka),t=q.next();!t.done;t=q.next()){var w=t.value;Pv(w,3)&&yY(this,a,w.Sg(),26,2)}if(this.wk(1)){var x=
this.C.C,z=uY(this.C,this.F,!1,!0),C=z.index,M=tY(this.C,this.D,!0,!1,!0,!0,C),O=M.index;if(-1!=O&&-1!=C){var S=10<=Qv(x.hd(O),2)?"5 ":"",fa=vY(this.C,O),ca=wY(this.C,C);if(fa!=ca){var qa=zY(1,[z],[M]);yY(this,a,this.DGa(1)+" "+S+fa+" by "+ca,1,qa)}}}if(this.wk(2)&&1<Qv(this.C.C,1)){a:{var va=this.C,wa=this.F;if(2>va.H.length)var ya=[XIc(),XIc()];else{var Xa=uY(va,wa,!1,!1,void 0,!0),Wa=Xa.index;if(-1!=Wa){var Qa=OIc(va.D.D,Wa);if(0<Qa.length){var wb=[Xa],Pc=QX(Qa),Pb=2,Sc=WIc(Qa,wa);0<Sc.length&&
(Pc=QX(Sc),Pb=3);wb.push({index:Pc,tB:Pb});ya=wb;break a}}ya=bJc(2<=va.L.length?va.L:va.H)}}var Tc=ya,he=wY(this.C,Tc[0].index),xd=wY(this.C,Tc[1].index);if(he!=xd){var Sb=zY(1,Tc,[]);yY(this,a,"Correlation of "+he+" and "+xd,2,Sb)}}if(this.wk(3)){var vf=this.C.C,sb=uY(this.C,this.F,!0),Yd=sb.index;if(-1!=Yd){var Zd=zY(1,[sb],[]);yY(this,a,this.FP(Uv(W(vf,1,Yd),3),3)+" of "+wY(this.C,Yd),3,Zd)}}if(this.wk(5)){var Df=this.C.C,Uf=uY(this.C,this.F,!0,!0),$i=Uf.index,Hi=tY(this.C,this.D,!0,!0,!1,!0,$i),
Yh=Hi.index;if(-1!=$i&&-1!=Yh){var Ii=wY(this.C,$i),Rk=Df.hd(Yh),Sk=vY(this.C,Yh);if(0<Qv(Rk,3)&&Sk!=Ii){var Ol=zY(1,[Uf],[Hi]),Yj=ZIc(this.C,Yh);yY(this,a,this.FP(Uv(W(Df,1,$i),3),5)+" of "+Ii+" when "+Sk+" is "+OX(Rk,Yj),5,Ol)}}}if(this.wk(9)){var Og=uY(this.C,this.F,!1,!0),Ji=Og.index,Pl=tY(this.C,this.D,!0,!1,!0,!0,Ji),ll=Pl.index;if(-1!=ll&&-1!=Ji){var Zj=wY(this.C,Ji),xn=vY(this.C,ll);if(xn!=Zj){var aj=zY(1,[Og],[Pl]);yY(this,a,xn+" with "+this.Kia(9)+" "+Zj,9,aj)}}}if(this.wk(10)&&0<Qv(this.C.C,
1)){var Zh=uY(this.C,this.F),ak=zY(1,[Zh],[]),wj=wY(this.C,Zh.index);yY(this,a,this.Kia(10)+" "+wj,10,ak)}if(this.wk(11)){var ni=this.C.C,Ql=tY(this.C,this.D,!0,!0,!1,!1,-1),yn=Ql.index;if(-1!=yn){var xj=vY(this.C,yn);if(0<Qv(ni.hd(yn),3)){var xp=zY(1,[],[Ql]);yY(this,a,"Most frequent "+xj,11,xp)}}}if(this.wk(12)){var ho=this.C.C,zn=uY(this.C,this.F,!0),yp=zn.index;a:{var Hm=this.C;if(1==Hm.$.length){var io=Hm.$[0];if(!W(Hm.C.hd(io),5)){var wt=io;break a}}wt=-1}var yj=wt;if(-1!=yj&&-1!=yp){var Xq=
wY(this.C,yp),zp=ho.hd(yj);if(0<Qv(zp,2)){var cs=zY(1,[zn],[]),Yq=YIc(this.C,yj);yY(this,a,this.FP(Uv(W(ho,1,yp),3),12)+" of "+Xq+" "+QX(eJc)+" "+OX(zp,Yq),12,cs)}}}if(this.wk(15)){var ml=this.C.C,Ap=uY(this.C,this.F,!0),jo=Ap.index,An=tY(this.C,this.D,!1,!0,!1,!0,jo),Im=An.index;if(-1!=jo&&-1!=Im){var zj=wY(this.C,jo),ko=vY(this.C,Im);if(ko!=zj){var bk=ml.hd(Im);if(2<=Qv(bk,3)){var lo=zY(1,[Ap],[An]),Rl=PX(Qv(bk,3),2);yY(this,a,"Compare "+this.FP(Uv(W(ml,1,jo),3),15)+" "+zj+" for "+ko+" "+OX(bk,
W(bk,3,Rl[0]))+" and "+OX(bk,W(bk,3,Rl[1])),15,lo)}}}}if(this.wk(16)){var Bn=tY(this.C,this.D,!0,!0,!1,!1),Bp=Bn.index;if(-1!=Bp){var Cn=vY(this.C,Bp),Sl=zY(1,[],[Bn]);yY(this,a,"List unique values in "+Cn,16,Sl)}}if(this.wk(17)){var wk=this.C.C,nl=tY(this.C,this.D,!0,!0,!1,!1),Tl=nl.index;if(-1!=Tl){var Ul=wk.hd(Tl),Jm=vY(this.C,Tl);if(!(1>Qv(Ul,3))){var Cp=ZIc(this.C,Tl),Zq=zY(1,[],[nl]);yY(this,a,"What percentage of "+Jm+" is "+OX(Ul,Cp),17,Zq)}}}if(this.wk(13)){var Dp=this.C.C,ds=uY(this.C,this.F,
!0,!0),mo=ds.index,es=tY(this.C,this.D,!0,!0,!1,!0,mo),Ep=es.index;if(-1!=mo&&-1!=Ep){var xt=wY(this.C,mo),$q=vY(this.C,Ep);if($q!=xt){var ps=zY(1,[ds],[es]);yY(this,a,this.FP(Uv(W(Dp,1,mo),3),13)+" of "+xt+" by "+$q,13,ps)}}}if(AA&&this.wk(18)){var It=uY(this.C,this.F),pl=It.index;if(-1!=pl){var k0=zY(2,[It],[]);yY(this,a,"Histogram of "+wY(this.C,pl),18,k0)}}if(this.wk(24)){var vR=tY(this.C,this.D,!0,!0),l0=vR.index;if(-1!=l0){var TJ=zY(1,[vR],[]);yY(this,a,"Count of "+vY(this.C,l0),24,TJ)}}if(this.wk(25)){var m0=
this.C.C,eF=tY(this.C,this.D,!0,!0),RA=eF.index;if(-1!=RA){var Mv=m0.hd(RA),UJ=YIc(this.C,RA),wR=zY(1,[eF],[]);yY(this,a,"Count when "+vY(this.C,RA)+" is "+OX(Mv,UJ),25,wR)}}var n0=3>a.length;if((n0||0==PX(5,1)[0])&&this.wk(7)){var xR=this.C.C,fF=uY(this.C,this.F,!1,!0),VJ=tY(this.C,this.D,!1,!1,!1,!0,fF.index);if(-1!=VJ.index&&-1!=fF.index){var Wp=xR.hd(VJ.index),yR=vY(this.C,VJ.index),SA=wY(this.C,fF.index);if(0<Qv(Wp,2)&&yR!=SA){var WJ=zY(1,[fF],[VJ]),XJ=YIc(this.C,VJ.index);yY(this,a,"Show "+
SA+" for "+yR+" "+OX(Wp,XJ),7,WJ)}}}if((n0||0==PX(5,1)[0])&&this.wk(8)){var gF=this.C.C;a:{var As=this.C,TA=this.D;if(2>As.F.length)var YJ=[XIc(),XIc()];else{var hF=tY(As,TA,!0,!1,!1,!1,void 0,!0),Xp=hF.index;if(-1!=Xp){var ZJ=OIc(As.D.C,Xp);if(0<ZJ.length){var zR=[hF],$ca=QX(ZJ),AR=2,BR=WIc(ZJ,TA);0<BR.length&&($ca=QX(BR),AR=3);zR.push({index:$ca,tB:AR});YJ=zR;break a}}var Yp=bJc(2<=As.J.length?As.J:As.F);Yp[0].index!=Xp&&(Yp[1]=Yp[0],Yp[0]=hF);YJ=Yp}}var gy=YJ,CR=gy[0].index;if(1<gF.Kj()&&-1!=CR){var iF=
gy[1].index,DR=gF.hd(iF),Bs=vY(this.C,iF),Zp=vY(this.C,CR);if(0<Qv(DR,2)&&Bs!=Zp){var o0=zY(1,[],gy),jF=YIc(this.C,iF);yY(this,a,"What is "+Zp+" where "+Bs+" is "+OX(DR,jF),8,o0)}}}this.jw=fJc(a)};function cJc(a){if(a.$){var b=HK(a.Na).Bj(),c=Vv(a.C.C,4);A(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.ea[d+b],k=a.C.qa[d+b];h&&0<=h&&Jb(a.D,h);k&&0<=k&&Jb(a.F,k)}})}}p.reset=function(){this.jw=[];this.F=[];this.D=[];this.Aa=new Qq;this.O=new Qq};p.v9=function(){return Ag(this.jw.slice())};
function fJc(a){Yb(a,function(a,c){return c.weight-a.weight});return Ab(a,function(a){return a.Nqa})}function yY(a,b,c,d,e){e=a.BGa(d,e);a.Aa.contains(c)||(b.push({Nqa:{query:c,Wm:void 0,type:d},weight:e}),a.O.add(d),a.Aa.add(c))}p.wk=function(a){return!this.O.contains(a)};function gJc(a,b){return a.v9().then(function(a){return a.length<=b?a:Ub(a,0,b)},null,a)}function zY(a,b,c){A(b,function(b){3==b.tB&&a++});A(c,function(b){3==b.tB&&a++});return a}
function dJc(a,b){var c=[];b=IIc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.V?e.V[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.FP=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=hJc;break a;case 4:a=iJc;break a}a=jJc}return QX(a)};p.DGa=function(){return QX(kJc)};p.Kia=function(){return QX(lJc)};
var jJc=["Average","Median"],hJc=["Total","Average","Median"],iJc=["Median"],lJc="Minimum Maximum Most Least Highest Lowest".split(" "),kJc=["Top","Bottom"],eJc=["before","after"];var mJc={};hc({F2a:{type:0,rA:"",oA:[]},mda:{type:1,rA:"Sum",oA:[3,5,13,12,15]},Jba:{type:2,rA:"Average",oA:[3,5,13,12,15]},Ica:{type:3,rA:"Mode",oA:[3]},T2a:{type:4,rA:"Variance",oA:[3]},R1a:{type:5,rA:"Standard deviation",oA:[3]},sva:{type:6,rA:"Median",oA:[3,5,13,12]},fU:{type:7,rA:"Count",oA:[24,25]},K1a:{type:8,rA:"Bottom",oA:[1,10,14]},L1a:{type:9,rA:"Top",oA:[1,11,10,14]}},function(a){mJc[a.type]=a});function nJc(a){if(a=mJc[a])return a};function oJc(a){xY.call(this,a);this.H=[]}r(oJc,xY);p=oJc.prototype;p.reset=function(){xY.prototype.reset.call(this);this.H=[]};p.BGa=function(a,b){return 1+b};p.wk=function(a){return!this.O.contains(a)&&0<pJc(this,a).length};p.DGa=function(a){return qJc(this,a)};p.FP=function(a,b){return qJc(this,b)};p.Kia=function(a){return qJc(this,a)};function rJc(a,b){a.reset();A(b,function(b){A(Uv(b,1),function(b){a.H.push(W(b,1))},a)},a);FFc(a.H);a.u9();return gJc(a,3)}
function pJc(a,b){return zb(a.H,function(a){return Gb(nJc(a).oA,b)},a)}function sJc(a,b){a=Eb(a.H,function(a){return nJc(a).type==b},a);return nJc(a)}function qJc(a,b){b=pJc(a,b);return sJc(a,QX(b)).rA};function AY(a,b,c,d,e,f,h,k,l,m,q,t,w,x){aY.call(this,x);this.Je=c;this.Yd=d;this.Xe=e;this.Mc=a;this.Ua=new oJc(this.Yd);this.Ra=h;this.qa=m;this.hf=q;this.Pe=t;this.J=this.V=this.O=this.Ab=this.D=null;this.Eb="";this.Ga=new LFc;this.L=f;this.Ka=this.Pb=this.Oa=this.F=null;this.Na=k;this.Kd=!1;this.xb=gj(new fj,10).build();this.Uc=new Yv;this.rb=l;this.ea={};this.Bd=yl();this.kb="";this.Aa=null;this.Kf=w}y(AY,aY);p=AY.prototype;p.Ia=function(){AY.ma.Ia.call(this);this.uH(null==this.F)};
p.Yoa=function(a,b){AY.ma.Yoa.call(this,a,b);b=this.oa();var c=this.$;this.O=new SX(b);c.Ha(this.O,!0);b.appendChild(a,this.O.Da);this.O.Ia();this.V=new VFc(this.O,this.L,this.Ga,10);c.va(this.V);c.getHandler().R(this.O,"answers-submit-query",v(this.p1b,this))};p.V3=function(){AY.ma.V3.call(this);this.V=this.O=null};
p.uH=function(a){var b=this;this.O&&this.O.setVisible(!a);a?(this.Aa&&this.Aa.dispose(),this.Aa=new Lg(function(){AY.ma.uH.call(b,a)},300,this),this.va(this.Aa),this.Aa.start()):(this.Aa&&this.Aa.stop(),AY.ma.uH.call(this,a))};p.Lf=da("Ab");
function tJc(a,b,c,d,e,f,h){h=void 0===h?[]:h;var k=void 0===k?[]:k;a.Ua.Ke(c,b,d,e,h,k);h=Ab(Uv(c,1),function(a){return a.getName()});var l=[],m=[];A(Uv(c,2),function(a){l.push(a.getName());m=m.concat(Uv(a,2))});MFc(a.Ga,h,l,m);a.Mc.v9().then(function(a){this.Ga.F=a;this.V&&(a=this.V,Ee(a.O.oa())==a.D&&a.tRa())},null,a);a.F=b;a.Oa=d;a.Pb=e;a.Ka=c;a.xb=hj(gj(new fj,10),uJc(a)).build();if(f&&IA)for(c=Ab(a.C,function(a){if(a instanceof pY||a instanceof qY)return a.gN().D}),a.RV(),d=0;d<c.length;d++)if(e=
c[d])f=new NX,J(f,1,5),vJc(a,e,f);a.uH(null==b)}p.reset=function(){NU(this.ea);NU(this.Ga.D);var a=this.Ga;a.F=[];a.C.clear();this.J=null;this.jBa()};
function vJc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;J(c,13,a.qa.L.F);var f=new MX;Uh(f,5,c);aGc(a.V);if(!a.Ab||a.Ab.getStatus().getState().Ih())if(a.ea[b])wJc(a,b,!1);else{d=new oY(b,null,null,null,2,a.qa);xJc(a,d,!0,f);return}else{var h=a.ea[b];h&&h instanceof qY&&2==h.gN().error&&delete a.ea[b]}if(b&&a.F)if(a.ea[b])a.L.Xb(2681,a.xb),wJc(a,b,!0);else{h=uJc(a);var k=Sh(Sh(h,xU,46),MX,4);J(k,2,e);e=hj(gj(new fj,10),h).build();a.L.Xb(2635,e);e=OG(a.F.rect);f=qv(Jt(ms(Ht(vq(a.Ab.Ie("/answers/parse").Bf("q",
b,"qt",I(c,1),"gid",a.F.ud,"range",e,"context",a.Eb),v(a.fl,a,b,f)),v(a.o1b,a,b,f)),"POST"),2));IA&&a.Oa&&null!=a.Pb&&(b=0==a.Oa.rect.width||0==a.Oa.rect.height?"":OG(a.Oa.rect),f.Bf("headerRange",b,"tableRecordDimension",""+a.Pb));d&&f.Bf("sgfml",d);f.ue();a.kb=zl(a.Bd,mA.Msa);yJc(a,!0)}else ZFc(a.V,"")}function wJc(a,b,c){var d=a.ea[b];d!=vb(a.C)&&(1<a.C.length&&zJc(a),c&&AJc(a,d.gN()).then(function(a){BJc(this,d,a)},null,a),ZGc(a,d))}
p.p1b=function(a){var b=a.C;var c=a.Ga;var d=a.J,e=a.Aa;c?c=KHc(b,d,e,c):(c=new NX,J(c,1,b));vJc(this,a.$,c,a.F,a.V)};p.o1b=function(a,b){if(this.F){var c=I(Sh(b,NX,5),1);c=1==c||4==c?DFc.Bxa:DFc.cya;var d=uJc(this),e=Sh(Sh(d,xU,46),MX,4);J(e,1,c);J(b,1,c);c=hj(gj(new fj,10),d).build();this.L.Xb(2640,c);CJc(this,a,b)}};function CJc(a,b,c){yJc(a,!1);b=new oY(b,null,null,null,3,a.qa);xJc(a,b,!1,c);DJc(a)}
p.fl=function(a,b,c){this.F&&this.Na.C.D.C.then(function(){var d=null,e=null,f=!1,h=Sh(b,NX,5),k=I(h,1),l=uJc(this);k=1==k||4==k?DFc.Bxa:DFc.cya;var m=Sh(Sh(l,xU,46),MX,4);J(m,1,k);J(b,1,k);k=hj(gj(new fj,10),l).build();if(c.Hk()){e=this.Uc.yd(jY.Ca(),c.Ye());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.L.Xb(q,k)}q=W(e,10);J(h,4,q);q=W(e,11);J(h,5,q);Pv(e,16)&&(q=W(e,16),J(h,16,q));if(1==
f){CJc(this,a,b);return}if(2==f){e=-1!=EJc(a);h=-1!=JHc(a);f=4;d=Sh(b,NX,5);e?(f=5,J(d,8,2)):h&&(f=7,J(d,8,1));h=new oY(a,null,null,null,f,this.qa);e?(e=new qY(h,!0,this.rb,!0,this.oa()),FJc(this,h,e,b)):xJc(this,h,!0,b);yJc(this,!1);DJc(this);return}l=Pv(e,2)?W(e,2):null;f=!0;if(l){q="";d=AFc(this.Na,l,this.F,!!this.Ka&&!!W(this.Ka,4));J(h,14,!!d);if(!d){if(m=l.match(/([A-Z]*)\(/)){var t=Sh(Sh(Aka(k),xU,46),MX,4);J(t,7,m[1]);J(b,7,m[1])}this.L.Xb(2645,k)}d&&BFc(d)||(q=this.Na,t=this.F,k="="!=l[0]?
"="+l:l,m=yFc(q),t=zFc(m,t),q=z0b(q.C,k,m,t.row,t.sj));k=Pv(e,19)?AFc(this.Na,W(e,19)||"",this.F,!!this.Ka&&!!W(this.Ka,4)):d;d=new oY(a,d,"="!=l[0]?"="+l:l,e,null,this.qa,k);if(Pv(e,23)&&d.Rj()){if(Pv(e,17)&&Pv(W(e,17),5)){k=d;l=W(W(e,17),5);k=k.TVa;if(Pv(l,5))switch(W(l,5).getPosition()){case 1:k.C="right";break;case 2:k.C="left";break;case 3:k.C="top";break;case 4:k.C="bottom"}Pv(l,1)&&Pv(W(l,1),1)&&Pv(W(W(l,1),1),1)&&1==W(W(W(l,1),1),1)&&(k.L=!0);Pv(l,2)&&Pv(W(l,2),1)&&Pv(W(W(l,2),1),1)&&1==W(W(W(l,
2),1),1)&&(k.O=!0);Pv(l,1)&&Pv(W(l,1),1)&&Pv(W(W(l,1),1),2)&&(m=W(W(W(l,1),1),2),k.F=m);Pv(l,2)&&Pv(W(l,2),1)&&Pv(W(W(l,2),1),2)&&(m=W(W(W(l,2),1),2),k.H=m);Pv(l,3)&&(m=l.getTitle().getTitle(),k.J=m);Pv(l,4)&&(l=W(l,4).getTitle(),k.D=l)}this.Eb=Vv(e,23)}else this.Eb="";q&&d.L.push(q);d.Rj()&&Uh(h,15,d.V)}else Pv(e,9)&&(q=e.getError(),d=new oY(a,null,null,e||null,6,this.qa),l=W(q,2),J(h,6,l),Pv(q,3)&&(q=W(q,3),J(h,12,q)))}else this.L.Xb(2640,k);d||(d=new oY(a,null,null,e||null,4,this.qa));yJc(this,
!1);QHc(d)?GJc(this,d,f,b):xJc(this,d,f,b);DJc(this)},function(){CJc(this,a,b)},this)};function DJc(a){""!=a.kb&&(Al(a.Bd,a.kb),a.kb="")}function HJc(a){if(null!=a.Wm)return FIc;switch(a.error){case 4:case 6:return 0<a.O.length?GIc:EIc;case 5:return EIc}return HIc}function uJc(a){var b=new MX;J(b,8,$0a);var c=new xU;Uh(c,4,b);a=FGc(a.F);Uh(a,46,c);return a}function EJc(a){return Fb(HHc,function(b){return Ua(a,b)})}
function IJc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=a.Na;var f=W(b[d],2);var h=!!a.Ka&&!!W(a.Ka,4);f=AFc(e,f,a.F,h);BFc(f)&&(f={query:W(b[d],1),Wm:W(b[d],2),type:b[d].getType()},Pv(b[d],5)&&(f.PEa=W(b[d],5)),c.push(f))}return Ag(c)}function GJc(a,b,c,d){c=new pY(b,a.Je,a.Yd,a.Xe,a.L,a.rb,a.Ra,c,a.qa,a.Kd,a.Kf,a.Na,a.oa());FJc(a,b,c,d)}
function JJc(a,b,c){if(a.D&&a.D.isVisible())VQ(a.D);else{var d=a.hf.D.C["ritz-ap"]||null;c.uM()&&(a.D=TZb(a.Pe,a.oa(),d,void 0,"answersChartsPromo"),a.D&&(a.D.show(),a.va(a.D),a.getHandler().Vc(a,"Jd",a.jBa)));b.Rj()&&MIa(d,"answersChartsPromo")}}p.rba=function(){AY.ma.rba.call(this);this.D&&this.D.isVisible()&&this.D.C.zd()};p.jBa=function(){this.D&&this.D.isVisible()&&VQ(this.D)};function xJc(a,b,c,d){c=new qY(b,c,a.rb,!1,a.oa());FJc(a,b,c,d)}
function FJc(a,b,c,d){zJc(a);var e=AJc(a,b,d);KJc(a,c);c instanceof pY&&JJc(a,b,c);LJc(a);QHc(b)&&NFc(a.Ga,b.D);e.then(function(a){if(d){var b=uJc(this),e=Sh(b,xU,46);Uh(e,4,d);b=hj(gj(new fj,10),b).build();this.L.Xb(2781,b)}BJc(this,c,a)},null,a);c.fia()&&(a.ea[b.D]=c);a.getHandler().R(c,"rc",a.BKa)}function BJc(a,b,c){b instanceof qY&&null!=c&&Xf(c.getElement())&&(b=b.getElement(),G(b,!1),a.getHandler().R(c,"rc",a.BKa))}
function zJc(a){MJc(a);A(a.C,function(a){a instanceof qY&&(a=a.getElement(),G(a,!0))});NJc(a)}function NJc(a){0!=a.C.length&&(a.J?ZGc(a,a.J):(a.J=new BIc(a.oa()),KJc(a,a.J)))}function MJc(a){A(a.C,function(b){b instanceof pY||b instanceof qY||b==a.J||a.fH(b)})}function OJc(a,b){var c=Ag([]);b=b.qa;0<b.length&&(c=rJc(a.Ua,b));return c=c.then(function(b){var c=3-b.length;return 0<c?gJc(a.Mc,c).then(function(a){return Qb(b,a)}):Ag(b)})}
function AJc(a,b,c){var d=HJc(b),e=null;d==FIc||d==GIc?0<b.O.length&&(e=IJc(a,b)):d==EIc&&(e=OJc(a,b));var f=null;return e?(f=new rY(new rG,a.rb,e,d,b,a.oa()),KJc(a,f),a.L.Xb(2769,a.xb),a.getHandler().R(f,"sqc",v(a.WDb,a)),e.then(function(a){if(c){var b=Sh(c,NX,5);Gb([FIc,GIc],f.D)?(a=MHc(a),Uh(b,7,a)):Gb([DIc,EIc],f.D)&&(a=NHc(a),Uh(b,9,a))}return f},null,a)):Ag(f)}p.WDb=function(a){ZFc(this.V,a.F,!0);var b=a.$;b=1==b?KHc(b,a.C,a.J,3):LHc(b,a.C,a.J,a.Aa);vJc(this,a.F,b,a.V);this.L.Xb(2762,this.xb)};
function yJc(a,b){a.O&&(a=a.O,G(a.H,b),G(a.oa().La("waffle-assistant-answers-button-container",a.C),!b),tW(a.F,b))}function KJc(a,b){b.AA(a.Gd());a.C.push(b);if(a.fc){YGc(a,!1);var c=a.H.cd();b.qa=c;a.H.lh(b,0,!0);b.bJ()}BGc(b,!0)}function LJc(a){for(var b=a.C;5<b.length;)a.fH(b[0])}p.RV=function(){AY.ma.RV.call(this);this.reset()};
p.BKa=function(a){var b=this,c=this.oa();a=a.target;if(a instanceof pY)this.fH(a),yIc(this.Ra,"Answer removed",c,v(this.MAb,this,a));else if(a instanceof qY)this.fH(a),yIc(this.Ra,"Card removed",c);else if(a instanceof rY&&a.C&&!QHc(a.C)){var d=a.C.D;A(this.C,function(a){a instanceof qY&&a.gN().D==d&&(b.fH(a),yIc(b.Ra,"Card removed",c))})}a=this.C;!this.J||a[0]!=this.J&&a[a.length-1]!=this.J||(this.fH(this.J),this.J=null)};
p.MAb=function(a){GJc(this,a.gN(),a.fia());yIc(this.Ra,"Remove answer undone",this.oa())};p.fH=function(a){if(a.Yb()){if(a instanceof pY||a instanceof qY)delete this.ea[a.gN().D],a==vb(this.C)&&MJc(this);AY.ma.fH.call(this,a)}D(a)};function PJc(a,b,c){b=c||b;a=""+(""+R('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
Q(as({icon:"docs-icon-img docs-icon-search-this-document"},null,b))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+cq("Ask a question about your data")+'"/></div></form></div>');return R(a)};function QJc(a,b,c){xY.call(this,a);this.J=[];this.L=this.H=null;this.Ga=b;this.Ra=c;this.Oa=gj(new fj,10).build()}r(QJc,xY);p=QJc.prototype;p.u9=function(){this.reset();xY.prototype.u9.call(this);K0a&&RJc(this)};p.reset=function(){xY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.v9=function(){return K0a&&this.H?this.H.then(function(){return this.J.slice()},null,this):xY.prototype.v9.call(this)};p.BGa=function(a,b){return Math.pow(Math.random(),1/(SJc(a)*b))};
p.Lf=da("L");function SJc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;case 26:return.5;default:return.3}}
function RJc(a){var b=null;a.H=new yg(function(a){if(!this.L||this.L.getStatus().getState().Ih())this.J=this.jw,a();var c=OG(this.yH.rect),e=Ab(this.jw,function(a){return a.query});c=ms(qv(Jt(Ht(vq(this.L.Ie("/answers/parsesuggestions").Bf("gid",this.yH.ud,"range",c),v(function(b){TJc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.Ra.Xb(2833,this.Oa);this.J=this.jw;a()},this)).setContent(["queries",Tn(e)]).setTimeout(2E3),1)),"POST");IA&&this.UK&&null!=this.ea&&(e=0==this.UK.rect.width||
0==this.UK.rect.height?"":OG(this.UK.rect),c.Bf("headerRange",e,"tableRecordDimension",""+this.ea));b=c.ue()},a);Fg(a.H,function(){b&&b.dispose()})}function TJc(a,b){return a.Ga.C.D.C.then(function(){var a=[];if(b.Hk())for(var d=b.Ye(),e=0;e<d.length;e++){var f;if(f=d[e]){f=this.Ga;var h=!!this.qa&&!!W(this.qa,4);f=AFc(f,d[e],this.yH,h);f=BFc(f)}f&&(this.jw[e].Wm=d[e],a.push(this.jw[e]))}this.J=a},function(){this.J.length=0},a)};function BY(a,b,c,d,e,f,h,k,l,m,q){bY.call(this,1,f,e,q);this.rb=c;this.Ga=null;this.qa=new dr("",new uW,this.oa());this.Ha(this.qa);this.Ka=new dr("",new uW,this.oa());this.Ha(this.Ka);f=new U3b(a,!0,!0);f=new $yc(f,c);this.Ua=new eIc(e);this.O=new QJc(this.rb,f,e);this.H=new AY(this.O,a,b,c,d,e,this.Ta,f,this.Ua,h,k,l,m,q);a=UJc;this.D=new wW(b,a.pca,a.qca);this.va(this.D);this.F=this.J=null;this.kb=gj(new fj,10).build();this.Aa=!1}y(BY,bY);
var UJc={pca:"waffle-assistant-answers-styled-border",qca:"waffle-assistant-answers-styled-rect",TZa:"waffle-assistant-answers-input-box",J0a:"waffle-assistant-answers-query-box",Mvc:"waffle-assistant-answers-query-box-focused",i_a:"waffle-assistant-answers-learn-more",bqc:"waffle-assistant-answers-logging-message-container",e0a:"waffle-assistant-answers-logging-opt-out"};p=BY.prototype;p.xa=function(){BY.ma.xa.call(this);var a=P(PJc);this.oa().appendChild(bHc(this),a)};
p.Ia=function(){BY.ma.Ia.call(this);var a=UJc,b=this.La(a.J0a),c=this.La(a.TZa);this.Ka.Va(this.La(a.e0a));this.qa.Va(this.La(a.i_a));this.getHandler().R(b,"focus",this.bAb,!0).R(b,"blur",this.$zb,!0).R(b,"mouseover",this.dAb).R(b,"mouseout",this.cAb).R(b,"click",this.aAb).R(c,"input",this.q1b).R(this.Ka,"action",this.cyb).R(this.qa,"action",this.Lub).R(jI(this.rb),"tb",htc(this.r1b,25,this));this.setVisible(null!=this.J);VJc(this,J0a&&M0a&&JA("showAnswersLoggingOptOut"))};p.fTa=Ge;p.sLa=He;
p.$pa=Ge;p.getTitle=n("Answers");p.n1=n(1);p.FV=function(a){return 3==a||0==a||1==a};p.hN=function(a,b){Yb(a,function(a,b){return W(b,2)-W(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Vv(a[f],1);3==h?e=a[f]:0==h?c.push(W(a[f],8)):1==h&&d.push(a[f])}if(e&&W(e,2)){f=b||null;h=Pv(e,11)?W(e,11):null;var k=null==h?null:AU(W(e,10));0<Qv(e,4)?WJc(this,AU(BU(e)),W(e,9),k,h,c,d):WJc(this,f,W(e,9),k,h,c,d);this.F||(BY.ma.hN.call(this,a,b),this.getHandler().R(this.F,"sqc",this.UDb))}else this.UT(!0)};
p.OO=function(a){if(!this.F){var b=gJc(this.O,3);this.F=new rY(a,this.Ua,b,DIc,void 0,this.oa())}return this.F};p.HAa=g("H");p.pla=function(){return this.isVisible()};
p.UT=function(a,b,c){this.O.reset();(a||b)&&this.F&&(BY.ma.UT.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(BY.ma.UT.call(this,a,b,c),this.F.dispose(),this.F=null),this.Yb()&&(this.O.reset(),this.J=null,a=this.H,a.Yb()&&(b=a.Ga,b.F=[],b.C.clear(),a.V&&(b=a.V,b.O.Yb()&&(UFc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.RV(),a.Ua.reset(),a.F=null,a.uH(!0)),this.setVisible(!1),this.Rb()&&yW(this.D));c&&this.H.reset()};p.UVa=function(a,b){b||YGc(this.H,a)};
p.Lf=function(a){this.Ga=a;this.H.Lf(a);this.O.Lf(a)};p.o1=function(a){BY.ma.o1.call(this,a);a?xW(this.D,this.J):yW(this.D)};function XJc(a,b){a.Rb()&&(b?yW(a.D):xW(a.D,a.J))}function VJc(a,b){G(a.La("waffle-assistant-answers-logging-message-container"),b)}function YJc(a,b){a=a.La("waffle-assistant-answers-query-box");Xe(a,"waffle-assistant-answers-query-box-focused",b)}p.r1b=function(){this.Rb()&&xW(this.D,this.J)};p.bAb=function(){YJc(this,!0);xW(this.D,this.J)};
p.$zb=function(){YJc(this,!1);this.Rb()||yW(this.D)};p.dAb=function(){xW(this.D,this.J)};p.cAb=function(){this.Rb()||yW(this.D)};p.aAb=function(){ZJc(this,"")};p.q1b=function(){var a=this.La("waffle-assistant-answers-input-box");ZJc(this,a.value);a.value=""};p.UDb=function(a){var b=this,c=a.F;ZJc(this,c);var d=KHc(1,a.C,a.J,1),e=new Lg(function(){vJc(b.H,c,d,a.V)},300);this.va(e);e.start();this.V.Xb(2652,this.kb)};function ZJc(a,b,c){a.o1(!0);a.dispatchEvent("Od");$Jc(a,b,c)}
function $Jc(a,b,c){c=void 0===c?!1:c;var d=new Lg(function(){ZFc(a.H.V,b,!0);var d=a.H,f=c||!1;d.Kd=f;d.Mc.$=f;d.Ua.$=f},300);a.va(d);d.start()}function WJc(a,b,c,d,e,f,h){c=c||new mG;a.J=b;a.O.Ke(c,b,d,e,f,h);a.O.u9();a.setVisible(null!=b);tJc(a.H,b,c,d,e,a.Aa,f);a.Aa=!1;a.Rb()&&xW(a.D,a.J)}p.cyb=function(a){a.stopPropagation();a.preventDefault();this.Ga&&(ms(Ht(vq(this.Ga.Ie("/answers/logoptout"),v(this.tvb,this)),v(this.svb,this)),"POST").ue(),this.V.Xb(2663,this.kb))};
p.Lub=function(a){a.stopPropagation();a.preventDefault();Wn("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.tvb=function(a){a.Hk()&&VJc(this,!1)};p.svb=ba();function aKc(a,b,c){b=c||b;a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+Q(er({content:Vp("INSERT CHART"),style:4,Ed:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},null,b))+Q(er({Ed:"waffle-autovis-lightbox-close",content:$p(""+Q(as({icon:"docs-icon-img docs-icon-close-white"},null,b))),style:4,title:Vp("Close")},null,b))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
Q(er({content:$p("&#10094;"),style:4,Ed:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:aq('aria-label="'+cq("Previous chart")+'"')},null,b))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+Q(er({content:$p("&#10095;"),style:4,Ed:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:aq('aria-label="'+cq("Next chart")+'"')},null,b))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
Q(a.ZLb)+"</div></div></div>");return R(a)}function bKc(){return R('<div class="waffle-autovis-lightbox-chart"></div>')};function cKc(a,b,c,d,e){H.call(this,e);this.F=a;this.D=b;this.$=c;this.V=d;this.H=[];this.C=new fr("",this.oa());this.Ha(this.C);this.O=new fr("",this.oa());this.Ha(this.O);this.L=new fr("",this.oa());this.Ha(this.L);this.J=new fr("",this.oa());this.Ha(this.J)}y(cKc,H);p=cKc.prototype;p.xa=function(){cKc.ma.xa.call(this);this.Da=P(aKc,{ZLb:this.F.length})};
p.Ia=function(){cKc.ma.Ia.call(this);var a=wB.isEnabled();dKc(this,!a);a=this.La("waffle-autovis-lightbox-close");this.C.Va(a);a=this.La("waffle-autovis-lightbox-insert");this.O.Va(a);var b=this.La("waffle-autovis-lightbox-previous");this.L.Va(b);b=this.La("waffle-autovis-lightbox-next");this.J.Va(b);eKc(this);fKc(this,this.D,!1);this.getHandler().R(document.body,df,this.FXb).R(this.Da,"keydown",this.HXb).R(Td(),"resize",this.KXb).R(this.C,"action",this.close).R(this.O,"action",this.GXb).R(this.L,
"action",this.JXb).R(this.J,"action",this.IXb);b=new mN(this.Da,this.oa());nN(b);this.va(b);a.focus()};function eKc(a){var b=a.La("waffle-autovis-lightbox-content"),c=a.La("waffle-autovis-lightbox-content-inner");a=a.La("waffle-autovis-lightbox-page-count");var d=Rd();a=Tf(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Qf(c,d,e);Qf(b,d,e+a.height+35)}function dKc(a,b){Xe(a.Da,"waffle-autovis-lightbox-readonly",b)}
function fKc(a,b,c){c&&aB("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?gKc(a,b):a.F[b]&&HGc(a.F[b],v(a.anb,a,b),!0)}p.anb=function(a,b){if(!this.isDisposed()&&b){var c=this.La("waffle-autovis-lightbox-container"),d=P(bKc);c.appendChild(d);this.H[a]=d;kW(b,d,this.$,this.V,DA);gKc(this,a)}};function gKc(a,b){G(a.H[a.D],!1);G(a.H[b],!0);a.L.Pa(0!=b);a.J.Pa(b!=a.F.length-1);var c=a.La("waffle-autovis-lightbox-page-number");pe(c,b+1);a.D=b}p.FXb=function(a){!ne(this.Da,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.HXb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&fKc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||hKc(this);a.stopPropagation()};p.KXb=function(){var a=this.La("waffle-autovis-lightbox-container");ce(a);this.H=[];eKc(this);fKc(this,this.D,!0)};p.GXb=function(){this.close();KGc(this.F[this.D],2256)};p.JXb=function(){0!=this.D&&fKc(this,this.D-1,!0);0==this.D&&this.J.Da.focus()};p.IXb=function(){hKc(this);this.D==this.F.length-1&&this.L.Da.focus()};
function hKc(a){a.D!=a.F.length-1&&fKc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.ld=function(){cKc.ma.ld.call(this);var a=this.F[this.D];a&&a.Da&&a.Da.focus()};function iKc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+T(a.title)+'">'+Q(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+cq("Press enter to insert formula")+'"></span></div>');return R(a)};function CY(a,b){H.call(this);this.C=a;this.D=b}y(CY,H);p=CY.prototype;p.xa=function(){this.Da=P(iKc,{name:this.C,title:this.D})};p.Ia=function(){CY.ma.Ia.call(this);var a=this.La("waffle-assistant-quicksum-entry-name");UX(a);this.getHandler().R(this.Da,"keypress",this.V0b);G(this.Da,!1)};p.getFunctionName=g("C");p.Qa=function(a){pe(this.La("waffle-assistant-quicksum-entry-value"),a||"");G(this.Da,!!a)};p.isVisible=function(){return Xf(this.Da)};
p.V0b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new E("insert",this)))};function jKc(a,b,c,d,e){H.call(this,e);this.Ka=a;this.Aa=b;this.O=c;this.J=d;this.D=a.C;this.Ga=new Yv;this.$=gj(new fj,17).build();this.V=gj(new fj,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}y(jKc,H);
jKc.prototype.Ia=function(){jKc.ma.Ia.call(this);this.lh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.lh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.lh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.lh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.lh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new lIc(this.Da,
this.Aa,this.D,this.O);this.C.H=this.L;this.va(this.C);this.getHandler().R(this,"insert",this.ea).R(this.C,"formula_inserted",this.qa)};
function kKc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(SG(a.D)){var c=HK(a.D),d=c.Bj(),e=GK(a.D);if(Db(d,c.vt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=fA(e+"",h.wc(),h.rc(),h.Tc(),h.Wc());c.push(a.Ga.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){G(a.Da,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.kd(0).Qa(b(d.sum));a.kd(1).Qa(b(d.average));a.kd(2).Qa(b(d.min));a.kd(3).Qa(b(d.max));
1<e?a.kd(4).Qa(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):G(a.Da,!1);if(a.C){a.C.L=[];a.H=[];for(d=0;d<a.cd();++d)e=a.kd(d),a.H.push(lKc(a,e.getFunctionName()));a.C.L=a.H}}else G(a.Da,!1)}else G(a.Da,!1)}else G(a.Da,!1)}jKc.prototype.ea=function(a){var b=a.target;a=this.F[0];a=new Dd(a.left,a.Tc());b=b.getFunctionName();b=lKc(this,b);a=new CO(HK(this.D),a,b);this.O.C(a);this.J.Xb(2624,this.V)};jKc.prototype.qa=function(){this.J.Xb(2624,this.$)};
function lKc(a,b){var c=a.Ka.L.D;a=Ab(a.F,function(a){return OG(a)});return"="+b+"("+a.join(c)+")"};function mKc(a,b,c){F.call(this);this.C=lab(uG.getInstance(),a,b,c);this.D=rl()}y(mKc,F);mKc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!Eb(c,function(a){return CZa(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].oh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&usc(this.C),this.D=nKc(),this.D.addCallback(function(){return Fsc(d.C,b,!0)}))};mKc.prototype.Lf=function(a){this.C.Lf(a)};
function nKc(){var a=null,b=new gl(function(){null===a||Jg(a)});a=Ig(function(){b.Ob()});return b};function DY(a,b,c,d,e,f,h){vW.call(this,h);this.Pe=a;this.vd=b.C;this.Na=c;this.Xe=d;this.H=f;this.hf=e;this.Ua=new jKc(b,c,d,f,this.oa());this.Ha(this.Ua);this.V=new sW(!1,"#4285f4");this.Ha(this.V);this.O=null;this.Xc=this.Mc=!1;this.Eb=!0;this.Cb=yl();this.xb=this.rb="";this.fc=null;this.Oa=gj(new fj,10).build()}y(DY,vW);p=DY.prototype;p.xa=function(){DY.ma.xa.call(this);this.Da=P(oKc,{vM:zA})};
p.Ia=function(){DY.ma.Ia.call(this);var a=this.La("waffle-assistant-quicksum-panel");this.Ua.Va(a);a=this.La("waffle-assistant-spinner-container");this.V.render(a);a=this.Pe.C;this.getHandler().R(this,"close-sidebar",this.dla).R(a,"recommender-load-started",this.Rka).R(a,"recommender-load-ended",this.Qka).R(a,"recommender-calc-started",this.rka).R(a,"recommender-calc-ended",this.qka).R(this.La("waffle-assistant-scroll-pane"),"scroll",htc(this.uba,10,this));a=wB.isEnabled();this.tba(!a)};
p.resize=function(){var a=this.La("waffle-assistant-sidepane-content");a=Tf(a).height;var b=this.La("waffle-assistant-spinner-container");Af(b,"margin-top",a/2-16+"px");this.uba()};p.Lf=ta;function pKc(a,b){var c=qKc(a);0!=c.length&&(D(a.O),c=c.filter(function(a){return a instanceof ZX}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new cKc(c,b,a.hf,a.H,a.oa()),a.O.render(),a.va(a.O),dKc(a.O,a.Xc)))}
p.tba=function(a){this.Xc=a;Xe(this.Da,"waffle-assistant-readonly",a);var b=this.Ua;b.L=a;b.C&&(b.C.H=a);Xe(b.Da,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&dKc(this.O,a)};
p.setVisible=function(a){var b=this.isVisible();DY.ma.setVisible.call(this,a);if(a&&!b){var c=Esc(this.Pe.C,a);c?(b=new vFc,J(b,1,Zz(c,"r")),J(b,2,Zz(c,"c")),J(b,3,c.oh()),c=new dj,Uh(c,4,b),b=jj(kj(this.Oa),c).build()):b=this.Oa;this.xb=zl(this.Cb,mA.iua,!1,b);tW(this.V,!0);rKc(this)}a||sKc(this,!0)};p.Rka=function(){this.isVisible()&&(sKc(this,!0),tW(this.V,!0),rKc(this))};p.Qka=function(){this.isVisible()&&(tW(this.V,!1),rKc(this))};
p.rka=function(a){this.isVisible()&&(this.H.C(2775,this.Oa),sKc(this,void 0,a.C,a.F),tKc(this)||tW(this.V,!0),rKc(this),this.Eb=!1)};
p.qka=function(a){if(this.isVisible()){this.H.C(2776,this.Oa);var b=a.C;0<b.length&&(this.rb=zl(this.Cb,mA.gua));sKc(this,!1);tW(this.V,!1);a=a.F;for(var c=ja(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ja(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Vv(h,1);d.FV(k)&&e.push(h)}0<e.length?d.hN(e,a):d.UT(!0)}if(IA)for(b=ja(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Vv(a,1)){this.q3();this.Aa=W(a,12);this.ea=BU(a);this.Ga=W(a,11);uKc(this);a=this.ea;c=!1;for(d=this.Ra.length-
1;0<=d;d--)Btc(this.Ra[d],a)&&(c=!0,this.Ra.splice(d,1));this.Ra.push(a);a=c;2!=this.Aa||a||vKc(this,!0)}b=qKc(this);0<b.length&&this.Mc&&(b[b.length-1].Bc=!0);this.Mc=!1;rKc(this);wKc(this);this.uba()}};function rKc(a){var b=tKc(a),c=Xf(a.La("waffle-assistant-quicksum-panel")),d=a.V.Rb();b=b||c||d;a=a.La("waffle-assistant-empty-list");G(a,!b)}p.Lc=ta;p.dpa=ta;p.Gd=g("Xc");p.dla=ta;
p.OJb=function(){""!=this.rb&&(Al(this.Cb,this.rb),this.rb="");""!=this.xb&&(Al(this.Cb,this.xb),this.xb="");this.fc=Ha();this.Eb||(this.H.Xb(2777,this.Oa),this.Eb=!0)};function oKc(a,b,c){b=c||b;a=a||{};c=R;var d=$p('<div class="waffle-assistant-replaceable-title">'+xKc(null,null,b)+"</div>");var e=e=a||{};var f=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+Q(UGc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');f=e.vM?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=R(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');e=R(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(""+Q(BW(Tp({title:d,Xk:$p(""+e),id:Vp("autovis"),vH:Vp("waffle-assistant-sidepanel"),Haa:Vp("waffle-assistant-title"),bW:Vp("waffle-assistant-sidepane-content")},a),b))+"")}
function xKc(){return R('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+Q(UGc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+Q("Explore")+"</div></div>")};function yKc(a,b,c){a=R;b=""+Q(er({Ed:"waffle-assistant-datavalidation-apply-button",content:Vp("Apply"),style:4},null,c||b||null));b=R(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function zKc(a){return R('<div class="waffle-assistant-datavalidation-detail-chip">'+Q(a.U6a)+"</div>")};function AKc(a,b,c,d){XX.call(this,a,d);this.D=new wW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.D);this.C=new fr("",this.oa());this.Ha(this.C);this.H=BU(a);this.J=c}r(AKc,XX);p=AKc.prototype;p.xa=function(){XX.prototype.xa.call(this);YX(this).appendChild(P(yKc))};
p.Ia=function(){XX.prototype.Ia.call(this);var a=this.La("waffle-assistant-datavalidation-apply-button");this.C.Va(a);UX(a,"Apply data validation");this.getHandler().R(this.C,"action",this.glb).R(this.Da,"mouseenter",this.qKb).R(this.Da,"mouseleave",this.rKb);a=new ei;var b=Dw(W(W(this.F,13),3));jsc(a,Azc(b));b=new ci;Uh(b,58,a);a=hj(gj(new fj,10),b).build();this.J.C(35577,a)};
p.zA=function(a){var b=OG(kA(this.H)),c=W(W(this.F,13),3);switch(Dw(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Uv(c,2).map(function(a){return W(W(a,5).Ma(),2)});break;case 1:d="Numeric validation";c=["Greater than "+W(W(Uv(c,2)[0],5).Ma(),3)];break;case 7:d="Numeric validation";c=Uv(c,2);c=["Between "+(W(W(c[0],5).Ma(),3)+(" and "+W(W(c[1],5).Ma(),
3)))];break;default:d="unrecognized",c=[]}var e=new Sn,f=e.text(d)+(" for "+(e.re("SPAN".toString(),{sE:"waffle-assistant-datavalidation-range"})+e.text(b)+e.we("SPAN".toString())));rd(this.La("waffle-assistant-datavalidation-description"),e.format(f));var h=this.La("waffle-assistant-datavalidation-details");A(c,function(a){a=P(zKc,{U6a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));sg(this.Da,b);a()};p.sA=ba();p.jz=n("assistantDataValidationFeedback");
p.UB=n(35551);p.TB=n(35550);p.glb=function(){this.dispatchEvent(new VX("Id",this,35549))};p.qKb=function(){xW(this.D,AU(this.H))};p.rKb=function(){yW(this.D)};function EY(a,b,c,d){is.call(this,a,b,c,d,void 0,void 0,!0)}y(EY,is);EY.prototype.xa=function(){EY.ma.xa.call(this);Te(this.Da,"waffle-assistant-toast");Te(this.La("docs-ui-toast-content"),"waffle-assistant-toast-content")};EY.prototype.fB=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=ig(this,b);EY.ma.fB.call(this,a,b,c)};EY.prototype.Gg=function(a,b,c,d){this.fB(a,b,d);a=kg(this,b);this.getHandler().Wg(a,nf,v(function(){this.setVisible(!1);c()},this))};function BKc(){this.C=null}y(BKc,B);BKc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function yIc(a,b,c,d){a.clear();a.C=new EY(b,c,!1,5E3);a.C.render();d&&a.C.Gg("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}BKc.prototype.Fa=function(){BKc.ma.Fa.call(this);this.clear()};function CKc(a,b,c,d){bY.call(this,1,b,a,d);this.D=c}r(CKc,bY);p=CKc.prototype;p.getTitle=n("Data Validation");p.FV=function(a){return 6==a};p.OO=function(a){var b=W(a,1);switch(b){case 6:return new AKc(a,this.D,this.V,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};p.iN=function(a){bY.prototype.iN.call(this,a);this.setVisible(!a)};p.jN=function(a){return this.Gd()?(this.setVisible(!1),a):bY.prototype.jN.call(this,a)};p.n1=n(4);function DKc(a,b,c){a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+EKc(c||b)+"</div>");return R(a)}
function FKc(a,b,c){return R('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+EKc(c||b)+"</div>")}function EKc(a){a=""+Q(er({Ed:"waffle-assistant-formatting-edit-button",content:Vp("Edit"),style:4},null,a||null));return R(a)};function GKc(a,b,c){XX.call(this,a,c);a=Ab(Uv(this.F,7),Czc);this.C=new Hzc(!1,a,7);this.Ha(this.C);this.J=new fr("",this.oa());this.Ha(this.J);this.L=b;this.H=!1;this.D=-1}y(GKc,XX);var HKc={tXa:"waffle-assistant-banding-color-picker-container",gca:"waffle-assistant-formatting-edit-button",kI:"waffle-assistant-banding-range"};p=GKc.prototype;p.xa=function(){GKc.ma.xa.call(this);YX(this).appendChild(P(DKc))};
p.Ia=function(){GKc.ma.Ia.call(this);this.getHandler().R(this.J,"action",this.Fqb).R(this.C,"wd",this.Mlb);this.L.C(2768)};p.zA=function(a){var b=this.La(HKc.tXa);this.C.render(b);Izc(this.C);b=this.La(HKc.kI);var c=BU(this.F);var d=kA(c);pe(b,OG(d));IKc(this,c);b=this.La(HKc.gca);this.J.Va(b);a()};p.sA=function(){sg(this.Da,"Suggested alternating background colors");Nj(this.C,"Choose a color scheme")};p.jz=n("assistantBandingFeedback");p.UB=n(2672);p.TB=n(2671);
p.Fqb=function(a){ZA.dispatchEvent({type:"show-banding-pane-recommendation",ZQa:this.F,A6a:Kzc(this.C)});a.stopPropagation()};p.Mlb=function(a){if(!this.H&&Jzc(this.C)){var b=this.D;this.D=this.C.Zg();this.D==b?this.dispatchEvent(new VX("Nd",this,2797)):this.dispatchEvent(new VX("Gd",this,2673));a.stopPropagation()}};
function IKc(a,b){a.H=!0;var c=b.zb();b=kA(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.wc(),b.rc(),b.Tc(),b.Wc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Yv).yd(dx.Ca(),c),c=Czc(c)):c=null;c?(c=Lzc(a.C,c),WL(a.C,c?c.getElement():null)):WL(a.C,null);a.D=a.C.Zg();a.H=!1};function JKc(a,b){XX.call(this,a,b);this.C=new fr("",this.oa());this.Ha(this.C);this.fc=Uv(a,6)}y(JKc,XX);var FY={gca:"waffle-assistant-formatting-edit-button",qZa:"waffle-assistant-conditionalformat-format-preview",g1a:"waffle-assistant-conditionalformat-rule-holder",uN:"waffle-assistant-conditionalformat-description",b0a:"one-rule",B2a:"two-rules",o2a:"three-rules",F0a:"waffle-assistant-conditionalformat-format-preview-label"};p=JKc.prototype;p.xa=function(){JKc.ma.xa.call(this);YX(this).appendChild(P(FKc))};
p.Ia=function(){JKc.ma.Ia.call(this);var a=this.La(FY.gca);this.C.Va(a);UX(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.elb)};p.zA=function(a){pe(this.La(FY.uN),Vv(this.F,3));var b=this.La(FY.g1a),c=new KKc(this,this.oa());this.Ha(c);c.Va(b);UX(b,"Apply conditional format rules");a()};p.sA=ta;p.jz=n("assistantConditionalFormatFeedback");p.UB=n(2630);p.TB=n(2629);
p.elb=function(){this.dispatchEvent(new VX("Hd",this,2563));this.dispatchEvent(new VX("Kd",this,2670,void 0,void 0,kA(W(this.fc[0],1,0))));d2a()};function KKc(a,b){Lj.call(this,void 0,void 0,b);this.C=a}y(KKc,Lj);
KKc.prototype.xd=function(a){KKc.ma.xd.call(this,a);var b=this.C.fc;switch(b.length){case 0:break;case 1:var c=FY.b0a;break;case 2:case 4:c=FY.B2a;break;default:c=FY.o2a}for(var d=0;d<b.length;d++){var e=b[d],f=Ud("DIV");Ue(f,[FY.qZa,c]);var h=Ud("DIV");Te(h,FY.F0a);f.appendChild(h);pe(h,"123");if(Pv(e,2)){var k=W(W(e,2),1);switch(Dw(W(k,1))){case 9:case 13:k=Uv(W(k,1),2)[0];var l=Uv(e,1)[0];pe(h,QH(k,Vv(l,1),Vv(l,2),Vv(l,4)))}}duc(e,f);a.appendChild(f)}};
KKc.prototype.Dh=function(){var a=this.C;a.dispatchEvent(new VX("Hd",a,2563));return!0};function LKc(a,b,c){bY.call(this,2,b,a,c)}y(LKc,bY);p=LKc.prototype;p.getTitle=n("Formatting");p.FV=function(a){return 2==a||4==a};p.OO=function(a){var b=W(a,1);switch(b){case 2:return new JKc(a,this.oa());case 4:return a=new GKc(a,this.V,this.oa()),this.getHandler().R(a,"Gd",this.zUb).R(a,"Nd",this.PGb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.zUb=function(a){yIc(this.Ta,"Alternating colors applied",this.oa(),v(this.Nlb,this,a.C))};p.PGb=function(){this.Ta.clear()};
p.Nlb=function(a){this.dispatchEvent(new VX("Sd",a,2796))};p.iN=function(a){LKc.ma.iN.call(this,a);this.setVisible(!a)};p.jN=function(a){return this.Gd()?(this.setVisible(!1),a):LKc.ma.jN.call(this,a)};p.n1=n(3);function MKc(a,b,c,d,e,f,h,k,l,m){XX.call(this,k,m);this.Na=b;this.Oa=c;this.ea=d;this.Ta=l;this.V=e;this.$=f;this.H=new dr("",new RX,this.oa());this.Ha(this.H);this.L=new dr("",new RX,this.oa());this.Ha(this.L);this.J=this.D=null;this.C=Ud("CANVAS","waffle-pivottable-pivot-canvas-border");this.Ka=this.Oa.L.C;this.O=gj(new fj,66).build()}r(MKc,XX);p=MKc.prototype;p.yA=n(!0);p.xa=function(){XX.prototype.xa.call(this);YX(this).appendChild(P(GFc));zGc(this).appendChild(P(HFc))};
p.Ia=function(){XX.prototype.Ia.call(this);var a=W(this.F,5);var b=azc(this.$,a),c=HK(this.Na).jc();this.J=new dzc(b,a,this.Ka,this.Ta,c,this.ea);a=this.La("waffle-assistant-insert-pivottable-button");this.H.Va(a);UX(a,"Insert Pivot Table");a=this.La("waffle-assistant-zoom-button");this.L.Va(a);UX(a,"Preview Pivot Table");this.getHandler().R(this.H,"action",this.sKb).R(this.L,"action",this.tKb)};
p.zA=function(a){pe(this.La("waffle-assistant-answercard-interpret"),Vv(this.F,3));this.C=Ud("CANVAS","waffle-pivottable-pivot-canvas-border");this.La("waffle-assistant-answercard-pivot-content").appendChild(this.C);fzc(this.J,this.C);a()};p.AA=function(a){XX.prototype.AA.call(this,a);this.H&&this.H.setVisible(!a);this.D&&CFc(this.D,this.Gd())};p.sA=function(){sg(this.Da,"Suggested Pivot Table")};p.jz=n("assistantPivotTableFeedback");p.UB=n(2632);p.TB=n(2631);
p.sKb=function(){ezc(this.J);this.dispatchEvent("close-sidebar");this.V.C(35619,this.O)};p.tKb=function(){this.V.C(35620,this.O);D(this.D);this.D=new hzc(this.J,this.L,Vv(this.F,3),this.V,this.O,35621,this.oa());this.D.render();this.va(this.D);CFc(this.D,this.Gd())};function NKc(a,b,c,d,e,f,h,k){bY.call(this,1,f,e,k);this.O=d;this.D=b;this.qa=c;this.Aa=h;this.H=gj(new fj,10).build();a=new U3b(a,!0,!0);this.J=new $yc(a,this.D);this.F=null}r(NKc,bY);p=NKc.prototype;p.getTitle=n("Pivot Table");p.FV=function(a){return 1==a};p.OO=function(a){var b=W(a,1);switch(b){case 1:return new MKc(this.F,this.D,this.qa,this.O,this.V,this.J,this.H,a,this.Aa,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};
p.hN=function(a,b){W(a[0],5)&&(this.F=b?b:null,bY.prototype.hN.call(this,a,b))};p.jN=function(a){return this.Gd()?(this.setVisible(!1),a):bY.prototype.jN.call(this,a)};p.n1=n(5);function GY(a,b,c,d,e){H.call(this);this.O=a;this.Oa=b;this.ea=c;this.H=d;this.D=e}r(GY,H);GY.prototype.getTableRange=g("ea");GY.prototype.w9=function(a,b,c){this.ea=a;this.H=b;this.D=c};GY.prototype.Ia=function(){H.prototype.Ia.call(this);this.getHandler().R(this.O.C,"Ca",this.Ra)};GY.prototype.Ra=function(){this.Oa.yc()};function OKc(a,b){B.call(this);this.F=a;this.H=b;this.C=new wW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.va(this.C);this.D=new wW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.va(this.D)}r(OKc,B);OKc.prototype.Fa=function(){yW(this.C);yW(this.D);B.prototype.Fa.call(this)};
function PKc(a,b,c,d,e,f){tXb(b);var h=kA(d);h=new Lz(h.wc(),h.rc(),Math.min(h.Tc(),h.wc()+6),Math.min(h.Wc(),h.rc()+6));var k=pQ(b),l=RG(a.F).C,m=l.jg(new vu(h.wc(),h.Tc()),"r",!0,!1,!0,!0)-1,q=l.jg(new vu(h.rc(),h.Wc()),"c",!0,!1,!0,!0)-1;l.dc()&&--q;m=Math.min(200,m);q=Math.min(c.offsetWidth-2,q);qQ(b,k,q,m);c=DGc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.wc();k=d.rc();switch(e){case 0:h=Math.min(d.Tc(),d.wc()+f);break;case 1:k=Math.min(d.Wc(),d.rc()+f)}d=fA(d.zb(),h,k,d.Tc(),d.Wc());xW(b,AU(d));xW(a.D,
AU(c))};function QKc(a){var b=a.oQa,c=a.nQa,d=a.OOa;a=a.Bza;return R('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+T(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+Q(b)+'</div></div><div class="waffle-tables-popup-content">'+Q(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
Q(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+Q(a)+"</div></div></div></div>")}
function RKc(){var a=Vp("Edit data range");var b=R('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+(""+QKc({oQa:a,nQa:$p(""+b),OOa:Vp("Update"),Bza:Vp("Cancel")})+"");return R(a)}function SKc(){var a=""+(""+QKc({oQa:Vp("Improve suggestions"),nQa:$p('<div class="waffle-tables-popup-header-message"></div>'),OOa:Vp("No"),Bza:Vp("Yes")})+"");return R(a)}function TKc(a){a='For <span class="waffle-assistant-table-bar-range">'+(Q(a.yH)+"</span>");return R(""+(""+a+""))}
function UKc(a){a='Is <span class="waffle-assistant-table-first-header">'+(Q(a.UK)+"</span> a header row, containing titles that describe the columns below?");return R(""+(""+a+""))};function VKc(a,b,c,d,e,f,h){GY.call(this,a,F6a,d,e,f);this.C=(new uk).build();this.va(this.C);this.J=new dr("",new RX,this.oa());this.Ha(this.J);nh(this.C,this.J,G6a);this.F=new dr("",new RX,this.oa());this.Ha(this.F);nh(this.C,this.F,F6a);this.V=new OKc(b,c);this.va(this.V);this.L=new Qe(this);this.va(this.L);this.qa=h}r(VKc,GY);VKc.prototype.xa=function(){this.Da=P(SKc)};
VKc.prototype.Ia=function(){GY.prototype.Ia.call(this);this.J.Va(this.La("waffle-tables-popup-done"));this.F.Va(this.La("waffle-tables-popup-cancel"));var a=DGc(this.getTableRange(),this.D,1);a=OG(kA(a));a=P(UKc,{UK:a});this.La("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(G6a,"action",this.Aa).subscribe(F6a,"action",this.$);a=this.La("waffle-assistant-table-canvas");var b=this.La("waffle-assistant-canvas-container");PKc(this.V,a,b,this.getTableRange(),this.D,this.H);a=this.La("waffle-tables-popup");
Xe(a,"waffle-tables-popup-answers-enabled",this.qa);b=new mN(a,this.oa());this.va(b);nN(b);a.focus()};VKc.prototype.$=function(){this.dispatchEvent("Qd")};VKc.prototype.Aa=function(){var a=kA(this.getTableRange());switch(this.D){case 0:a=qZa(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=qZa(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=OG(a);this.dispatchEvent(new dGc(a,this.H-1,this.D));this.dispatchEvent("Qd")};function WKc(a,b,c,d,e,f,h,k,l){GY.call(this,a,cE,d,e,f);var m=this;this.Ta=b;this.Na=d;this.rb=e;this.xb=f;a=kA(d);this.F=OG(a);this.Ka=new OKc(b,c);this.va(this.Ka);this.C=null;this.qa=h;this.J=(new uk).build();this.va(this.J);this.$=new dr("",new RX,this.oa());this.Ha(this.$);nh(this.J,this.$,D6a);this.V=new dr("",new RX,this.oa());this.Ha(this.V);nh(this.J,this.V,cE);b=this.O.C.C.qe();this.L=new lW(this.Ta,function(a,b,c){XKc(m,a,b,c)},!1,"e.g., A2:D5",!0,b,this.oa());this.Ha(this.L);this.Aa=
null;this.Ga=new Qe(this);this.va(this.Ga);this.Ua=k;this.kb=l}r(WKc,GY);p=WKc.prototype;p.xa=function(){this.Da=P(RKc)};
p.Ia=function(){GY.prototype.Ia.call(this);this.$.Va(this.La("waffle-tables-popup-done"));this.V.Va(this.La("waffle-tables-popup-cancel"));this.L.render(this.La("waffle-assistant-tables-data-range-wrapper"));var a=this.La("waffle-range-selection-input");og(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.yKb).R(a,"keyup",this.zKb).R(a,iea,this.tEb).R(this.L,"change",this.AKb);this.Ga.subscribe(D6a,"action",this.BKb).subscribe(cE,"action",this.imb);YKc(this);
a=this.La("waffle-tables-popup");Xe(a,"waffle-tables-popup-answers-enabled",this.kb);var b=new mN(a,this.oa());this.va(b);nN(b);a.focus()};p.Fa=function(){D(this.Aa);GY.prototype.Fa.call(this)};function XKc(a,b,c,d){CU(a.Ua,null,b,c,d,!1,void 0,function(b){a.Aa=b})}function ZKc(a){var b=a.La("waffle-assistant-table-canvas"),c=a.La("waffle-assistant-canvas-container");PKc(a.Ka,b,c,a.getTableRange(),a.D,a.H)}p.imb=function(){this.dispatchEvent("Qd")};
p.BKb=function(){var a=!ibb.test(this.F);G(this.yb("waffle-assistant-tables-range-error"),a);Xe(this.La("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.rb!=this.H||this.xb!=this.D;var b=!Etc(this.Na,this.getTableRange());if(a||b)a&&this.qa.Xb(35506),b&&this.qa.Xb(35507),this.dispatchEvent(new dGc(this.F,this.H,this.D));this.dispatchEvent("Qd")}};
function YKc(a){var b=a.La("waffle-range-selection-input"),c=kA(a.Na);a.F=OG(c);b.value=a.F;$Kc(a);ZKc(a)}p.w9=function(a,b,c){GY.prototype.w9.call(this,a,b,c);ZKc(this)};function aLc(a){var b=HK(a.O.C),c=b.jc();b=mbb(a.F,b);null!=b&&(c=iA(b,c),a.w9(c,bLc(a,c),a.D),$Kc(a))}function bLc(a,b){b=cLc(b,a.D);return a.H>b?b:a.H}function cLc(a,b){a=0==b?a.Tc()-Vv(a,2):a.Wc()-Vv(a,4);return Math.min(a-1,3)}
function $Kc(a){D(a.C);a.C=new WN;a.Ha(a.C);nh(a.J,a.C,C6a);yU(a.C,EW.getInstance());a.C.render(a.La("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.atb);for(var b=cLc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new et("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Nd(new ek(d))}c=cLc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new et("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Nd(new ek(e))}c=a.H;a.C.wf(0==a.D?c:c+b+1);og(a.C.Da,"label","Headers")}p.tEb=function(){var a=this.La("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,aLc(this))};p.AKb=function(){var a=this.L.Ma();this.F=a;var b=this.La("waffle-range-selection-input");b.value=a;b.select();aLc(this)};
p.yKb=function(a){var b=this.La("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;aLc(this);D6a.yc();break;case 27:a.stopPropagation(),a.preventDefault(),YKc(this),cE.yc()}};p.zKb=function(){this.F=this.La("waffle-range-selection-input").value;aLc(this)};p.atb=function(){var a=this.C.Zg(),b=cLc(this.getTableRange(),0);this.w9(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function HY(a,b,c,d,e,f,h,k,l,m,q,t){DY.call(this,a,b,c,e,d,f,t);this.Je=q;this.Yd=h;this.Ka=b;this.Ta=new H(this.oa());this.Ha(this.Ta);this.qa=new BKc;this.va(this.qa);this.D=[];this.F=null;this.Ab=new fr("",t,4);ih(this.Ab,2,!1);this.Ha(this.Ab);this.xe=k;this.Ag=l;this.Kd=m;this.ea=null;this.Aa=0;this.Ga=null;this.Pb=new dr("",new RX,this.oa());this.Ha(this.Pb);this.Bc=new H(this.oa());this.Ha(this.Bc);this.Bd=(new uk).build();this.va(this.Bd);nh(this.Bd,this.Pb,E6a);this.$=this.J=null;this.Ra=
[]}y(HY,DY);var IY={XD:"waffle-assistant-scroll-pane-feature-content",Rbc:"waffle-assistant-empty-list",eZa:"waffle-assistant-features",h_a:"waffle-assistant-empty-list-learn-more",Tca:"waffle-assistant-expanded-panel",lwa:"waffle-assistant-replaceable-title",l1a:"waffle-assistant-scroll-pane",h2a:"waffle-assistant-sidepane-tables-range",i2a:"waffle-sidebar-tables-bar",Gxa:"waffle-assistant-tables-scroll-pane",j2a:"waffle-assistant-tables-edit-range-button",xw:"waffle-assistant-title"},dLc={defaultHelpArticleId:"6280499"};
p=HY.prototype;
p.Ia=function(){var a=this;HY.ma.Ia.call(this);this.Ta.Va(this.La(IY.Tca));UX(this.C.Da,"Close");IA&&(this.Bc.Va(this.La(IY.h2a)),uKc(this),this.Pb.Va(this.La(IY.j2a)));var b=this.Ka.L.F;zA&&(a1a||"en"==tG(b))&&(b=new BY(this.Yd,this.Na,this.vd,this.Xe,this.H,this.qa,this.Ka,this.Ag,this.Kd,this.Je,this.oa()),this.Ha(b),this.D.push(b));b=new LKc(this.H,this.qa,this.oa());this.Ha(b);this.D.push(b);L(K(),"fedvs")&&(b=new CKc(this.H,this.qa,this.Na,this.oa()),this.Ha(b),this.D.push(b));g1a&&(b=new NKc(this.Yd,
this.vd,this.Ka,this.Xe,this.H,this.qa,this.Je,this.oa()),this.Ha(b),this.D.push(b));b=new cY(this.vd,this.Na,this.hf,this.H,this.qa,this.oa());this.Ha(b);this.D.push(b);var c=this.La(IY.eZa);A(this.D,function(b){b.render(c);a.Ta.Ha(b.C,!0)});this.Ab.Va(this.La(IY.h_a));this.getHandler().R(this.Ab,"action",this.B1b).R(this,"Qd",this.q3).R(this,"Pd",this.C1b);eLc(this)};p.C1b=function(){var a=fLc(this);a&&(a.Aa=!0)};p.B1b=function(){N.qo.yc(dLc)};function wKc(a){A(a.D,function(a){dHc(a)})}
function sKc(a,b,c,d){A(a.D,function(a){a.UT(b,c,d)})}function tKc(a){return!!Eb(a.D,function(a){return a.pla()})}p.uba=function(){var a=this,b=this.La("waffle-assistant-scroll-pane").scrollTop+Tf(this.La("waffle-assistant-sidepane-content")).height;A(this.D,function(c){a.F&&a.F!=c||(c instanceof cY&&a.getHandler().Vc(c,"Ld",a.OJb),b=c.jN(b))})};function qKc(a){if(a.F)return a.F.C.C;var b=[];A(a.D,function(a){Tb(b,cHc(a))});return b}p.tba=function(a){HY.ma.tba.call(this,a);eLc(this)};
p.Lf=function(a){A(this.D,function(b){b.Lf(a)})};p.dpa=function(){var a=this.La(IY.lwa),b=this.La(IY.xw);Sf(b,Tf(a).height)};
p.Lc=function(){var a=this,b=this.La(IY.XD),c=this.La(IY.lwa),d=this.Ta.Da;if(this.F)this.F.C.setVisible(!1),this.F.o1(!1),this.F=null,G(b,!0),G(d,!1),Kp(c,xKc),pg(c,"label"),this.resize();else if(this.F=Eb(this.D,function(a){return a.Rb()}))G(b,!1),G(d,!0),this.F.C.setVisible(!0),eHc(this.F,c),sg(c,this.F.getTitle());this.dpa();b=new Lg(function(){var b=nt;b&&b.dispatchEvent("resize");a.uba()},300);this.va(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();HY.ma.setVisible.call(this,a);a&&!b&&gLc(this,!0);a||this.qa.clear()};p.dla=function(){HY.ma.dla.call(this);this.F&&this.Lc();this.q3()};p.Rka=function(){HY.ma.Rka.call(this);gLc(this,!0)};p.Qka=function(){HY.ma.Qka.call(this);gLc(this,!1)};p.rka=function(a){HY.ma.rka.call(this,a);gLc(this,!0,a.C)};p.qka=function(a){HY.ma.qka.call(this,a);gLc(this,!1)};
function hLc(a,b){if(IA){var c=fLc(a);b?(Xec(a.J),a.J=new WKc(a.Ka,a.Na,a.xe,a.ea,a.Aa,a.Ga,a.H,a.Kd,null!=c&&c.Rb()),a.Ha(a.J),a.J.render(a.getElement())):a.J&&(a.removeChild(a.J,!0),D(a.J),a.J=null);c&&XJc(c,b)}}function vKc(a,b){if(IA&&1!=a.Ga){var c=fLc(a);b?(a.$=new VKc(a.Ka,a.Na,a.xe,a.ea,a.Aa,a.Ga,null!=c&&c.Rb()),a.Ha(a.$),a.$.render(a.getElement())):a.$&&(a.removeChild(a.$,!0),D(a.$),a.$=null);c&&XJc(c,b)}}function eLc(a){A(a.D,function(b){b.iN(a.Gd())})}
function fLc(a){a=Eb(a.D,function(a){return a instanceof BY});return null!=a?a:null}function gLc(a,b,c){A(a.D,function(a){a.UVa(b,c)});IA&&b&&(a.ea=null,a.Aa=0,a.Ga=null,a.q3(),uKc(a))}function uKc(a){var b=a.La(IY.i2a),c=a.La(IY.l1a);if(a.ea){var d=kA(a.ea);d=OG(d);d=P(TKc,{yH:d});a=a.Bc.Fb();ce(a);a.appendChild(d);G(b,!0);Te(c,IY.Gxa)}else G(b,!1),Ve(c,IY.Gxa)}p.q3=function(){hLc(this,!1);vKc(this,!1)};function iLc(a,b,c,d,e,f,h,k,l,m,q,t){var w=this;KW.call(this,b,h);this.ea=a;this.C=b;this.$=c;this.Na=d;this.Ta=e;this.L=f;this.H=c.C;this.Oa=this.Ka=!1;this.F=null;this.O=l;this.Ra=t;this.Uc=new Yv;this.J=null;jLc(this);Y2a.Pa(!0);a=new ei;J(a,6,kLc());b=new ci;Uh(b,58,a);this.Aa=gj(hj(new fj,b),10).build();yl();this.Ga=-1;a=new Lg(function(){return lLc(w,!1)},100);this.va(a);a.start()}y(iLc,KW);
function jLc(a){var b=jI(a.Ta);a.Ja.R(a.Na,"selectionChange",a.F1b).R(a.H,"Ca",a.D1b).R(b,"Ya",a.gwb).R(a.C,"Id",a.ilb).R(a.C,"Hd",a.hlb).R(a.C,"Gd",a.flb).R(a.C,"Nd",a.LAb).R(a.C,"Kd",a.Cmb).R(a.C,"Md",a.E1b).R(a.C,"Rd",a.FDb).R(a.C,"Od",a.hCb).R(a.C,"Jd",a.Ilb).R(a.C,"Sd",a.H1b).R(a.ea.C,"recommender-confidence-update",a.Znb).R(a.C,"Pd",a.G1b);a.V.Kb(wB,Na,a.jub).subscribe(xB,"action",a.Flb).subscribe(Z2a,"action",a.mDb).subscribe(W2a,"action",a.HPa).subscribe(jC,"action",a.Qxb).subscribe(E6a,"action",
a.ADb)}p=iLc.prototype;p.qh=function(){return $2a};p.qs=function(){return a3a};p.Dq=function(a){iLc.ma.Dq.call(this,a);Z2a.Pa(a);lLc(this,!1);!this.Ka&&a&&(this.Ka=!0);qs(this.Ra,{qc:a});a||this.C.Lc()};p.OY=function(a){var b=this;this.C.dpa();var c=new Lg(function(){iLc.ma.OY.call(b,a)},300);this.va(c);c.start()};p.vka=function(){iLc.ma.vka.call(this);mLc(this,!1)};p.Lf=function(a){this.C.Lf(a);this.ea.Lf(a)};
p.ilb=function(a){var b=a.C.F,c=W(W(b,13),3);b=BU(b);var d=new Fw;X(d,1,c);var e=new Qx;X(e,1,d);X(e,3,!0);nsc(e,!0);this.L.C(new HS(e,b));a=a.ej();c=Dw(c);JY(this,a,!1,Azc(c))};p.Flb=function(){var a=this.C.isVisible();this.qh().setVisible(!a);a||this.C.focus();mLc(this,!a)};function mLc(a,b){b?(JY(a,2253),a.Ga=Ha()):JY(a,2226,!0)}p.HPa=function(){this.C.isVisible()||this.Dq(!0)};p.Qxb=function(){var a=fLc(this.C);a&&(a.Rb()?$Jc(a,"",!0):(this.HPa(),ZJc(a,"",!0)))};p.mDb=function(a){pKc(this.C,a)};
p.ADb=function(){hLc(this.C,!0)};p.F1b=function(){mJ(this.$)&&null==this.C.J&&lLc(this,!0)};function lLc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(kKc(d.Ua),rKc(d));a.ea.update(!b,a.C.isVisible(),c)}
p.Znb=function(a){var b=a.C,c=b?b.H:null;a=b?b.C:0;var d=!!b&&b.D,e=b?b.H.rect:null;e=!!e&&e.oh()>=V0a&&Zz(e,"r")>=X0a&&Zz(e,"c")>=Y0a&&e.oh()<=W0a;b=!!b&&b.F&&e;if(b!==this.Oa||c&&!c.equals(this.F))this.Oa=b,this.F=c,this.Ga=Ha(),Y2a.yc({u8:b,yH:c});e&&c&&c.rect&&(b=1E3>=c.rect.oh(),c=ritz_api.RitzModelApi.isFormsRegion(""+c.ud,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ka&&d&&b&&!this.$.Ih(),c=O0a&&c,b=P0a&&this.$.Gd(),d&&(c||b)&&(d=new ei,
J(d,1,a),J(d,2,c),J(d,3,b),J(d,5,HA),J(d,6,kLc()),a=new ci,Uh(a,58,d),a=hj(gj(new fj,10),a).build(),this.aza(a)))};p.aza=function(a){var b=this;this.C.Mc=!0;var c=bJ(HK(this.H));if(!Yac.C&&!c){var d=a||this.Aa;this.qh().setVisible(!0);this.O.Xb(2225,d);JY(this,2253);a=new Lg(function(){b.C.isVisible()||b.O.Xb(2752,d)},5E3);this.va(a);a.start()}};function kLc(){switch(Z0a){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}
p.Ilb=function(){this.C.Lc()};p.H1b=function(a){var b=a.C;var c=BU(b.F);var d=parseInt;var e=c.zb();d=d(e,10);this.J=kA(c);this.L.C(new lbc(d));IKc(b,c);JY(this,a.ej())};p.D1b=function(){SG(this.H)?(this.C.Pa(!0),lLc(this,!1)):(this.qh().setVisible(!1),this.C.Pa(!1))};p.jub=function(){this.C.tba(!wB.isEnabled())};p.gwb=function(a){lLc(this,!1,Lab(a))};
p.hlb=function(a){var b=HK(this.H),c=""+b.jc(),d=[],e=cuc(b);if(e){b=new Hy;var f=Vv(e,2);X(b,3,f);f=Vv(e,2);X(b,2,f);e=Vv(e,1);X(b,1,e);d.push(b)}b=a.C.fc;for(e=0;e<b.length;e++)f=new Hy,X(f,2,b[e]),d.push(f);this.L.C(new JW(d,c));JY(this,a.ej())};
p.flb=function(a){var b=a.C,c=Kzc(b.C);var d=BU(b.F);var e=c.Ju?c.tx:null,f=c.C?c.Tw:null,h=parseInt;var k=d.zb();h=h(k,10);k=nLc(d);this.J=kA(d);k?this.L.C(new MW(k,h,this.J,e,c.Xr,c.Zs,f)):this.L.C(new IW(h,this.J,e,c.Xr,c.Zs,f));d=new isc;J(d,1,1);c=new xU;b=W(b.F,2);J(c,2,b);Uh(c,5,d);b=FGc(this.F);Uh(b,46,c);b=hj(gj(new fj,10),b).build();this.O.C(a.ej(),b)};p.LAb=function(a){a=a.C;var b=BU(a.F);var c=parseInt;var d=b.zb();c=c(d,10);d=nLc(b);this.J=kA(b);this.L.C(new bAc(d,c));IKc(a,b)};
p.G1b=function(a){var b=HK(this.$.C),c=b.jc();b=iA(mbb(a.J,b),c);c=DGc(b,a.F,a.V);var d=this.ea,e=a.F;usc(d.C);d.C.Ka=b;d.C.Ga=c;d.C.Na=e;Asc(d.C,!0,!0,!1);JY(this,a.ej())};function nLc(a){var b=a.zb();a=kA(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.wc(),a.rc(),a.Tc(),a.Wc(),7,!1);return 0<b.length?b[0]:null}p.Cmb=function(a){TI(HK(this.H),a.Ka);JY(this,a.ej())};
p.FDb=function(a){var b=a.C;a=a.ej();if(b instanceof pY||b instanceof rY||b instanceof MKc)JY(this,a);else{var c=qKc(this.C),d=new xU,e=W(b.F,2);c=c.indexOf(b);J(d,1,c);J(d,2,e);e=new ci;Uh(e,46,d);if(b instanceof ZX){(d=b.H)?(b=oLc(this,b,d),b=pyc(b,d,d.ag())):b=null;if(!b)return;Uh(e,39,b)}else if(b instanceof SGc){var f=b.F;c=new iFc;if(b instanceof SGc)b=1;else throw Error("Unknown text analysis card type.");f=Uv(W(f,8),20).slice(0,10);J(c,2,f||[]);J(c,1,b);Uh(d,3,c)}e=hj(gj(new fj,10),e).build();
this.O.C(a,e)}};p.hCb=function(){this.C.Lc()};
p.E1b=function(a){var b=a.J;if(b){var c=HK(this.H),d=a.$;d||(d=aA(RG(this.Na).D.C));var e=16,f=16,h=a.Ga;h&&(e=h.x,f=h.y);h=Ksc(this.$.J);d={oid:null,ar:XI(c,d.y),ac:YI(c,d.x),x:e,y:f,h:oab.height,w:oab.width,p:{context:Qtc(h)}};(c=b.ag())?(e=new Tk(c),d=new tK(eJ(this.H)||0,d,!1,!1),f=bl(e,"headers"),f=null!=f&&na(f)&&ab(f)?parseInt(f,10):-1,d.Ga=f,d.L=0,f="1"==bl(e,"transpose"),d.qa=f,d.H=f?"ROWS":"COLS",f=bl(e,"range"),f=Ftc(Gtc(f,","),this.H),d.nH(f),(e=bl(e,"dt"))&&anb(d,this.Uc.yd(nz.Ca(),JSON.parse(decodeURIComponent(e))))):
(e=new uz,X(e,2,"0.6"),f=a.Pd().toJSON(),X(e,1,f),d=new tK(eJ(this.H)||0,d,!1,!1,e));uK(d);Isc(d,b);this.Na.dispatchEvent(new hN("objectRequest"));this.L.C(new lP(this.$,d));e=pLc(this,b,a.V,a.Pd());d=d.getId()||0;e.H=d;jW(this.O,a.ej(),e,10,b,c,void 0,a.F)}};function oLc(a,b,c){var d=qKc(a.C).filter(function(a){return a instanceof ZX});return pLc(a,c,d.indexOf(b),b.H&&b.H.Pd())}
function pLc(a,b,c,d){var e=new hW;a=qKc(a.C).filter(function(a){return a instanceof ZX}).map(function(a){return a.getChartType()});e.V=a;e.J=c;byc(e,b.getChartType());e.F=d?d.clone():null;return e}
function JY(a,b,c,d){if(a.F){var e=Sh(Aka(a.Aa),ei,58).getTableRange();if(c||!e||e.zb()!=a.F.ud||e.rc()!=a.F.rect.rc()||e.wc()!=a.F.rect.wc()||e.Wc()!=a.F.rect.Wc()||e.Tc()!=a.F.rect.Tc()){e=new ei;J(e,6,kLc());var f=EGc(a.F);Uh(e,7,f);c&&(c=Ha()-a.Ga,J(e,8,1E3*c),null!=a.C.fc&&(c=Ha()-a.C.fc,J(e,10,1E3*c)));d&&jsc(e,d);d=L(K(),"feacos");J(e,9,d);d=new ci;Uh(d,58,e);a.Aa=gj(hj(new fj,d),10).build()}}a.O.Xb(b,a.Aa)};function qLc(){B.call(this)}y(qLc,LA);qLc.prototype.nfb=function(){return mKc};qLc.prototype.pfb=function(){return HY};qLc.prototype.ofb=function(){return iLc};qLc.prototype.F=function(){return bGc};WA("assistant",qLc);
