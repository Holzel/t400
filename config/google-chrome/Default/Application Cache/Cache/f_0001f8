oW.prototype.GRa=QR(234,function(a){this.J=Kb(arguments,0)});var HBc=[2];function IBc(a){Uc(this,a,0,-1,HBc,null)}y(IBc,Tc);function MX(a){Uc(this,a,0,-1,null,null)}y(MX,Tc);var JBc=[1,2];function KBc(a){Uc(this,a,0,-1,JBc,null)}y(KBc,Tc);var LBc=[1];function MBc(a){Uc(this,a,0,-1,LBc,null)}y(MBc,Tc);var NBc=[1];function OBc(a){Uc(this,a,0,-1,NBc,null)}y(OBc,Tc);var PBc=[1];function QBc(a){Uc(this,a,0,-1,PBc,null)}y(QBc,Tc);var RBc=[3];function SBc(a){Uc(this,a,0,-1,RBc,null)}y(SBc,Tc);
SBc.prototype.getChartType=function(){return C(this,1)};function NX(a){Uc(this,a,0,-1,null,null)}y(NX,Tc);function TBc(a){Uc(this,a,0,-1,null,null)}y(TBc,Tc);function UBc(a){Uc(this,a,0,-1,null,null)}y(UBc,Tc);UBc.prototype.getChartType=function(){return C(this,1)};function VBc(a){Uc(this,a,0,-1,null,null)}y(VBc,Tc);VBc.prototype.wf=function(){return C(this,2)};function OX(a,b){return M(a,2,b)}
function WBc(a,b,c,d,e){return pMb(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function XBc(a,b,c){return pMb(a,v(function(){return a.C.calculatePivotTableResultProto(b.serialize(c))},a))}function YBc(a,b){var c=Oe(a,1)?M(a,1):Number.MIN_VALUE;a=Oe(a,2)?uf(a):Number.MAX_VALUE;var d=Oe(b,1)?M(b,1):Number.MIN_VALUE;b=Oe(b,2)?uf(b):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}var ZBc={$yc:0,exa:1,Fxa:2};
function $Bc(a){return ic(vqc,function(b){return b.match(a)}).getName()}
var aCc={m1a:0,Wca:1,xba:2,sca:3,A1a:4,C0a:5,Zua:6,RT:7,w0a:8,x0a:9},bCc={UNKNOWN_ERROR:0,Czc:1,Qpc:2,Kbc:3},cCc={mzc:0,ecc:1,Dba:2,fk:3,ezc:4,t2b:5,wdc:6},dCc={kzc:0,uA:1,Wpc:2,Bpc:3,zsc:4},eCc={gzc:0,Spc:1,WD:2,Ymc:3},fCc={Xyc:0,Fyc:1,hgc:2,zxc:3,yxc:4,X5b:5,Jnc:6},gCc={Bwc:0,fI:1,EWa:2,zyc:3,svc:4,l_a:5,Azc:6,Gua:7,usa:8,Zsa:9,E1:10},hCc={UNKNOWN:0,d2b:1,c2b:2,b2b:3,w3b:4,j5b:5,R5b:6,x9b:7,Hcc:8,voc:9,Nsc:10,Ysc:11,Owc:12,Pwc:13,cyc:14,ksc:15};var iCc={DEFAULT:0,RIGHT:1,LEFT:2,DA:3,pA:4},jCc={B0a:0,Cnc:1};function kCc(){K.call(this)}y(kCc,K);var lCc=null;function PX(){K.call(this)}y(PX,K);var mCc=null;function QX(){K.call(this)}y(QX,K);var nCc=null;QX.prototype.getPosition=function(){return M(this,1)};QX.prototype.setPosition=function(a){O(this,1,a)};function RX(){K.call(this)}y(RX,K);var oCc=null;function pCc(){K.call(this)}y(pCc,K);var qCc=null;
kCc.prototype.Na=function(){var a=lCc;a||(lCc=a=Ve(kCc,{0:{name:"ChartScale",Fb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",Ja:14,defaultValue:0,type:jCc},2:{name:"factor",Ja:1,type:Number}}));return a};kCc.Na=kCc.prototype.Na;PX.prototype.Na=function(){var a=mCc;a||(mCc=a=Ve(PX,{0:{name:"ChartTitle",Fb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",Ja:9,type:String}}));return a};PX.Na=PX.prototype.Na;
QX.prototype.Na=function(){var a=nCc;a||(nCc=a=Ve(QX,{0:{name:"ChartLegend",Fb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",Ja:14,defaultValue:0,type:iCc}}));return a};QX.Na=QX.prototype.Na;RX.prototype.Na=function(){var a=oCc;a||(oCc=a=Ve(RX,{0:{name:"ChartAxis",Fb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",Ja:11,type:kCc}}));return a};RX.Na=RX.prototype.Na;
pCc.prototype.Na=function(){var a=qCc;a||(qCc=a=Ve(pCc,{0:{name:"ChartOptions",Fb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",Ja:11,type:RX},2:{name:"v_axis",Ja:11,type:RX},3:{name:"title",Ja:11,type:PX},4:{name:"subtitle",Ja:11,type:PX},5:{name:"legend",Ja:11,type:QX},6:{name:"chart_conversation",Ja:8,type:Boolean}}));return a};pCc.Na=pCc.prototype.Na;function SX(){K.call(this)}y(SX,K);var rCc=null;SX.prototype.Rj=function(){return M(this,1)};function TX(){K.call(this)}y(TX,K);var sCc=null;TX.prototype.getText=function(){return M(this,1)};TX.prototype.Ot=function(){return Oe(this,1)};function UX(){K.call(this)}y(UX,K);var tCc=null;UX.prototype.getStatus=function(){return M(this,1)};UX.prototype.getError=function(){return M(this,9)};function VX(){K.call(this)}y(VX,K);var uCc=null;function vCc(){K.call(this)}y(vCc,K);var wCc=null;
function WX(){K.call(this)}y(WX,K);var xCc=null;WX.prototype.$B=function(){return Oe(this,1)};WX.prototype.getType=function(){return M(this,3)};WX.prototype.setType=function(a){O(this,3,a)};function yCc(){K.call(this)}y(yCc,K);var zCc=null;function ACc(){K.call(this)}y(ACc,K);var BCc=null;
SX.prototype.Na=function(){var a=rCc;a||(rCc=a=Ve(SX,{0:{name:"Error",Fb:"ritz.assistant.Error"},1:{name:"message",Ja:9,type:String},2:{name:"code",Ja:14,defaultValue:0,type:bCc},3:{name:"unsupported_op_reason",Ja:14,defaultValue:0,type:cCc}}));return a};SX.Na=SX.prototype.Na;
TX.prototype.Na=function(){var a=sCc;a||(sCc=a=Ve(TX,{0:{name:"AnswerQueryPhrase",Fb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ja:9,type:String},2:{name:"start_byte",Ja:5,type:Number},3:{name:"num_bytes",Ja:5,type:Number}}));return a};TX.Na=TX.prototype.Na;
UX.prototype.Na=function(){var a=tCc;a||(tCc=a=Ve(UX,{0:{name:"AnswerResponse",Fb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ja:5,type:Number},10:{name:"parse_status",Ja:14,defaultValue:0,type:dCc},11:{name:"answer_status",Ja:14,defaultValue:0,type:eCc},2:{name:"formula",Ja:9,type:String},3:{name:"debug_parse_response",Ja:9,type:String},4:{name:"interpretation",Ja:9,type:String},5:{name:"debug_interpretation_response",Ja:9,type:String},6:{name:"unused_phrase",Fc:!0,Ja:11,type:TX},7:{name:"used_entity_phrase",
Fc:!0,Ja:11,type:TX},8:{name:"unused_entity_phrase",Fc:!0,Ja:11,type:TX},9:{name:"error",Ja:11,type:SX},12:{name:"alternate_suggestion",Fc:!0,Ja:11,type:WX},14:{name:"deprecated_formula_builder_used",Ja:9,type:String},15:{name:"answer_visualization_type",Fc:!0,Ja:14,defaultValue:0,type:gCc},16:{name:"formula_builder_used",Ja:14,defaultValue:0,type:hCc},17:{name:"charting_info",Ja:11,type:vCc},18:{name:"answer_field_info",Fc:!0,Ja:11,type:VX},19:{name:"charting_formula",Ja:9,type:String},21:{name:"parse_info",
Fc:!0,Ja:11,type:yCc},22:{name:"answer_field_info_for_ranges",Fc:!0,Ja:11,type:VX},23:{name:"va_query",Ja:9,type:String},24:{name:"pivot_table_def",Ja:11,type:Cg}}));return a};UX.Na=UX.prototype.Na;VX.prototype.Na=function(){var a=uCc;a||(uCc=a=Ve(VX,{0:{name:"AnswerFieldInfo",Fb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ja:14,defaultValue:0,type:lja},2:{name:"range_ref",Ja:9,type:String}}));return a};VX.Na=VX.prototype.Na;
vCc.prototype.Na=function(){var a=wCc;a||(wCc=a=Ve(vCc,{0:{name:"ChartingInfo",Fb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Fc:!0,Ja:14,defaultValue:0,type:gCc},2:{name:"recommended",Ja:8,type:Boolean},3:{name:"user_requested_type",Fc:!0,Ja:14,defaultValue:0,type:gCc},4:{name:"show_only_chart",Ja:8,type:Boolean},5:{name:"chart_options",Ja:11,type:pCc}}));return a};vCc.Na=vCc.prototype.Na;
WX.prototype.Na=function(){var a=xCc;a||(xCc=a=Ve(WX,{0:{name:"QuerySuggestion",Fb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ja:9,type:String},2:{name:"formula",Ja:9,type:String},3:{name:"type",Ja:14,defaultValue:0,type:fCc},4:{name:"deprecated_formula_builder_used",Ja:9,type:String},5:{name:"formula_builder_used",Ja:14,defaultValue:0,type:hCc}}));return a};WX.Na=WX.prototype.Na;
yCc.prototype.Na=function(){var a=zCc;a||(zCc=a=Ve(yCc,{0:{name:"ParseInfo",Fb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Fc:!0,Ja:11,type:ACc}}));return a};yCc.Na=yCc.prototype.Na;ACc.prototype.Na=function(){var a=BCc;a||(BCc=a=Ve(ACc,{0:{name:"IntentInfo",Fb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ja:14,defaultValue:0,type:aCc}}));return a};ACc.Na=ACc.prototype.Na;function XX(){}y(XX,yu);wa(XX);XX.prototype.gc=n("waffle-assistant-button");function CCc(){var a=Bt("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+T(bw({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+V(a)+'" aria-label="'+V(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+V("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+T(bw({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return U(a)};function YX(a){R.call(this,a);this.D=new Au("",new XX,this.Aa());this.Qa(this.D);this.F=new tW(!1,"#4285f4");this.Qa(this.F);this.C=this.J=this.H=null}r(YX,R);YX.prototype.Ha=function(){this.jd(S(CCc))};YX.prototype.jd=function(a){R.prototype.jd.call(this,a)};
YX.prototype.Ra=function(){R.prototype.Ra.call(this);var a=this.Aa();this.C=a.Za("waffle-assistant-answers-query-box",this.La);this.D.kb(a.Za("waffle-assistant-answers-clear-query-button",this.C));this.H=a.Za("waffle-assistant-answers-spinner-container",this.C);this.F.render(this.H);this.J=a.Za("waffle-assistant-answers-input-box",this.C)};YX.prototype.setVisible=function(a){this.getElement()&&(Q(this.getElement(),a),(a=dx)&&a.dispatchEvent("resize"))};function ZX(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Sa(b),Gu(a,b,void 0),dqc(a),a.setAttribute("data-tooltip-delay",500),Q7b(a,u(c)?c:1))};function DCc(a){var b=a.type;switch(na(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function ECc(a,b){var c=a.type;switch(na(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function FCc(a,b,c,d,e,f){I.call(this,"sqc");this.O=a;this.F=f||"";this.L=b;this.J=d;this.$=e;this.C=c}y(FCc,I);function GCc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;I.call(this,"answers-submit-query");this.C=a;this.O=b;this.L=c;this.J=d;this.$=e;this.F=f;this.Pa=h}y(GCc,I);function $X(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function aY(a){return a[$X(a.length,1)[0]]}function HCc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return rb(a[b],function(b,d){return rb(a,function(a){return a[d]})})}
function ICc(a){var b={};A(a,function(a){b[a]||(b[a]=0);b[a]++});Lb(a);Ob(a,function(a,d){return b[d]-b[a]})};function JCc(){this.F=[];this.D={};this.J=null;this.C=new XI}function KCc(a,b,c,d){function e(a){return a.toLowerCase()}Lb(b,void 0,e);Lb(c,void 0,e);Lb(d,void 0,e);A(b,a.H,a);A(c,a.H,a);A(d,a.H,a)}JCc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function LCc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}JCc.prototype.ZG=function(a,b,c){if(Sa(a||"")){var d=this.J.Fm();d=MCc(this,a.substring(0,d));var e=NCc(this,b-d.length,a);d=Hb(d,e)}else d=NCc(this,b);d.length>b&&(d=Kb(d,0,b));c(a,d)};
function NCc(a,b,c){var d=c||"";c=Zb(a.D,function(a){return Ma(a,d)});var e=OCc(dc(c),d?1:2,1);a=qb(a.F,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=OCc(a,b-cc(e),2);b=dc(b);var f=rb(b,function(a,b){a.tqa=b;return a.mTa});A(b,function(a){a.rqa=f});return Hb(b,dc(e))}
function MCc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Baa:h.Baa,$Z:h.$Z,JR:h.JR},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.JR={};h.$Z=0;h.Baa=f.substr(k);var l=a.C.Pe(h.Baa);A(l,function(b){return function(c){var d=c.length-b.Baa.length;b.$Z=Math.max(d,b.$Z);c=a.C.get(c);b.JR[d]||(b.JR[d]=[]);Jb(b.JR[d],c)}}(h));for(l=0;l<=h.$Z&&0<d;++l){var m=h.JR[l];if(m)for(var q=0;q<m.length&&0<d;++q){var t=m[q];Ya(b.toLowerCase(),t.toLowerCase())||e[t]||(--d,c.push({text:t,Wm:"",
$z:0,nza:f.length-k,mTa:void 0,rqa:[],tqa:-1}),e[t]=!0)}}}return c}function OCc(a,b,c){b=$X(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,Wm:na(b)?"":b.Wm,$z:c,nza:0,mTa:na(b)?void 0:b.type,rqa:[],tqa:-1}});return d};function bY(){$K.call(this,"",null,!1)}y(bY,$K);bY.prototype.UC=function(a,b){if(2==a.$z||1==a.$z)return bY.qa.UC.call(this,a.text,b);var c=this.$a(),d=this.Fm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.nza)+a.text;e||(f+=" ");a=bY.qa.UC.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.gk;b.blur();b.focus();this.U_(f.length);return a};
bY.prototype.ag=function(a){var b=bY.qa.ag.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,dmb(b)&&b.zF()&&a.preventDefault(),b=!0);return b};function PCc(){return U('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+T(bw({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+T(bw({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+T(bw({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function QCc(a){this.xb=a||yn()}
QCc.prototype.fu=function(a,b,c){b=S(PCc);var d=this.xb.Za("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.xb.Ye(d,a.text);d=this.xb.Za("waffle-assistant-answers-ac-entity-icon",b);var e=this.xb.Za("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.xb.Za("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.$z);Q(e,2==a.$z);Q(f,1==a.$z);d="";switch(a.$z){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Rr(c,d);this.xb.appendChild(c,b)};function RCc(a,b,c,d){G.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new bY;this.H.iEa=!0;this.H.Pa=!0;this.Fa(this.H);this.R=c;this.R.J=this.H;a=new YK(null,new QCc(a.Aa()));this.C=new VK(this.R,a,this.H);this.Fa(this.C);this.va=b;this.J=!1;this.$=tq(new sq,d).build();this.Va=new Oi(this);this.Fa(this.Va);SCc(this)}r(RCc,G);
function SCc(a){TCc(a);a.H.C=a.C;a.C.WX=!1;a.C.X8=6;tmb(a.H,a.D);ZX(a.F.getElement(),"Clear query");a.Va.V(a.C,"update",a.Hjb).V(a.L,"submit",a.nIb).V(a.L,"focus",function(){return UCc(a,!0)},!0).V(a.L,"blur",function(){return UCc(a,!1)},!0).V(a.F,"action",a.c4a).V(a.D,"input",a.lUa).V(a.D,"focus",a.KQa);a.F.setVisible(!1)}p=RCc.prototype;p.Oa=function(){G.prototype.Oa.call(this);this.R.J=null};function VCc(a,b,c){c=void 0===c?!1:c;ECc(a.D,b);c&&a.D.focus();a.lUa()}
function TCc(a){a=a.C.Gd();a.className="waffle-assistant-answers-ac-renderer";a.QL="waffle-assistant-answers-ac-row";a.v2="waffle-assistant-answers-ac-active";a.jla="waffle-assistant-answers-ac-highlighted"}p.Hjb=function(a){a.row&&(a=a.row,2==a.$z?(WCc(this,1,a.rqa,a.tqa,a.Wm,2),this.va.Xb(2652,this.$)):0==a.$z?(this.J=!0,this.va.Xb(2651,this.$)):1==a.$z&&WCc(this,3))};function UCc(a,b){Vr(a.L,"waffle-assistant-answers-query-box-focused",b);a.C.Jf()&&!b&&a.C.ah()}p.lUa=function(){this.F.setVisible(!!DCc(this.D))};
p.KQa=function(){this.C.Rv(this.D);var a=fb(DCc(this.D));this.H.U_(a.length);amb(this.C,a||"  ");this.C.update(!0)};p.nIb=function(a){a.stopPropagation();a.preventDefault();WCc(this,2)};function WCc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Sa(DCc(a.D));a.F.setVisible(!!h);XCc(a);a.O.dispatchEvent(new GCc(b,h,a.J,c,d,e,f));a.J=!1}p.c4a=function(){ECc(this.D,"");this.F.setVisible(!1)};function XCc(a){a.D.blur();a.C.Jf()&&a.C.ah()};function YCc(a,b){R.call(this,b);this.F=a;this.H=new JCc;this.C=new YX(this.Aa());this.Qa(this.C);this.D=null}r(YCc,R);YCc.prototype.jd=function(a){R.prototype.jd.call(this,a);this.C.render(a)};YCc.prototype.Ra=function(){R.prototype.Ra.call(this);this.D=new RCc(this.C,this.F,this.H,4);this.Fa(this.D);Rr(this.C.La,"waffle-assistant-answers-input-with-icon")};function cY(a,b,c,d,e,f){I.call(this,a,b);this.C=b;this.Pa=c;this.$=d||null;this.Wa=e||null;this.J=f||null}y(cY,I);cY.prototype.hj=g("Pa");cY.prototype.Oe=g("$");function ZCc(a,b,c,d,e,f,h){h=void 0===h?null:h;cY.call(this,"Pd",null,d,e,f);this.L=a;this.O=b;this.xc=c;this.F=h}y(ZCc,cY);ZCc.prototype.Fd=g("xc");function $Cc(a,b,c){cY.call(this,"Sd",null,2859);this.L=a;this.O=b;this.F=c}y($Cc,cY);function aDc(){return U('<div class="waffle-assistant-card" tabindex="0" role="region">'+(zo?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(zo?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function bDc(){return U('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function cDc(a,b){R.call(this,b);this.D=a;this.C=new Au("",new AW,this.Aa());this.Qa(this.C)}y(cDc,R);p=cDc.prototype;p.Ha=function(){this.La=S(bDc)};p.Ra=function(){cDc.qa.Ra.call(this);var a=this.Za("waffle-assistant-feedback-card-link");this.C.kb(a);this.getHandler().V(this.La,"mousedown",this.m_b).V(this.C,"action",this.l_b);this.show(!1)};p.m_b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.La,c=this.Za("waffle-assistant-feedback-card-link");Vr(b,"waffle-assistant-feedback-card-hidden",!a);ho(c,a)};p.l_b=function(){P.Eu.mc({source:this.D});this.show(!1);this.dispatchEvent(new I("feedback-dialog-opened"))};function dDc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+T(bw({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+T(bw({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return U(a)};function dY(a){R.call(this,a);this.C=new Au("",new XX,this.Aa());this.Qa(this.C);this.D=new Au("",new XX,this.Aa());this.Qa(this.D)}y(dY,R);dY.prototype.Ha=function(){this.La=S(dDc)};dY.prototype.Ra=function(){dY.qa.Ra.call(this);var a=this.Za("waffle-assistant-thumbs-down-button");this.C.kb(a);ZX(a,"Not useful");a=this.Za("waffle-assistant-thumbs-up-button");this.D.kb(a);ZX(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.H)};
function eDc(a,b){a.Aa().Ye(a.Za("waffle-assistant-thumbs-text"),b)}dY.prototype.F=function(){this.dispatchEvent(new I("thumbs-down"));Q(this.La,!1)};dY.prototype.H=function(){this.dispatchEvent(new I("thumbs-up"));Q(this.La,!1)};function eY(a,b){var c=this;R.call(this,b);this.F=a;this.Pa=this.Ia=this.Ba=null;this.Lb=new tW(!0,"#4285f4");this.Qa(this.Lb);this.Vb=this.Zc=this.xe=!1;this.ib=new mn(function(){c.ib.stop();c.La.parentNode.querySelector(":hover")==c.La?c.ib.start():c.uT()},100);this.Fa(this.ib);this.zf=this.Mc=!1}y(eY,R);p=eY.prototype;p.kA=Mh;p.M7=Nh;p.AB=Oh;p.zB=Oh;p.U5=Oh;p.Eia=Oh;p.Dia=Oh;p.mA=da("zf");p.ud=g("zf");p.Ha=function(){this.La=S(aDc)};
p.Ra=function(){eY.qa.Ra.call(this);var a=this.Za("waffle-assistant-card-spinner-container");this.Lb.render(a);Mq(this.Za("waffle-assistant-card-inner"),"visibility","hidden");if(this.kA()){a=this.La;var b=new Yr(a);this.Fa(b);this.getHandler().V(b,"focusin",this.Ckb).V(b,"focusout",this.Bkb).V(a,"mouseenter",this.Y0).V(a,"mouseleave",this.uT)}fDc(this,!1);zo&&(this.Pa=new cDc(this.Ry(),this.Aa()),this.Pa.render(this.Za("waffle-assistant-card-feedback-container")),this.getHandler().V(this.Pa,"feedback-dialog-opened",
this.Ipb).V(this,"trigger_feedback",this.zUb),this.M7()?(this.Ia=new dY(this.Aa()),this.Ia.render(this.Za("waffle-assistant-thumbs-container")),gDc(this,!0),a=fb(this.U5()),Qa(a)||eDc(this.Ia,a),a=fb(this.Eia()),Qa(a)||ZX(this.Ia.Za("waffle-assistant-thumbs-up-button"),a),a=fb(this.Dia()),Qa(a)||ZX(this.Ia.Za("waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.Ia,"thumbs-down",this.j_b).V(this.Ia,"thumbs-up",this.k_b)):gDc(this,!1));this.dA()};
function fY(a){return a.Za("waffle-assistant-card-content-container")}function hDc(a){a.kA();return a.Za("waffle-assistant-card-options")}function gDc(a,b){zo&&Q(a.Za("waffle-assistant-thumbs-container"),a.M7()&&b)}p.UI=function(){this.isDisposed()||(this.xe=!0,iDc(this))};function jDc(a,b){!a.Zc&&b&&(a.Zc=!0,iDc(a))}function iDc(a){if(a.xe&&a.Zc){var b=v(a.i_b,a);a.lA(b)}}p.Y0=function(){this.Vb||(fDc(this,!0),this.Vb=!0,this.ib.start())};p.uT=function(){fDc(this,!1);this.Vb=!1};
p.Ckb=function(){fDc(this,!0)};p.Bkb=function(){var a=this,b=new mn(function(){co(a.La,document.activeElement)||a.La.parentNode.querySelector(":hover")==a.La||fDc(a,!1)},0);this.Fa(b);b.start()};p.j_b=function(){kDc(this,!0);gDc(this,!1);var a=this.zB();this.dispatchEvent(new cY("Ud",this,a))};p.k_b=function(){gDc(this,!1);var a=this.AB();this.dispatchEvent(new cY("Ud",this,a))};p.Ipb=function(){kDc(this,!1)};p.zUb=function(){kDc(this,!0)};
function fDc(a,b){var c=a.Za("waffle-assistant-card-options");a=a.kA();Q(c,a&&b)}p.i_b=function(){uW(this.Lb,!1);Q(this.Lb.La,!1);Mq(this.Za("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new I("content-rendered"))};function kDc(a,b){Vr(a.Za("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.Pa.show(b)};function lDc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+T(a.title)+"</div>"+T(Hu({vd:"waffle-assistant-section-more-button",content:Ct("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return U(a)};function mDc(a){return U('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+V(a.iconSize)+'px" width="'+V(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+V(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function nDc(){var a=U;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+T(mDc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=U(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function oDc(a){return U('<div class="waffle-assistant-panel-title-bar">'+T(Hu({vd:"waffle-assistant-panel-back-button",content:Ct(""+T(bw({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+T(a.title)+"</div></div>")};function gY(a){R.call(this,a);this.vc=new tW(!1,"#4285f4");this.Qa(this.vc);this.H=new R(this.Aa());this.Qa(this.H);this.C=[];this.xe=this.Yb=!1;this.hd=this.Zc=this.ib=this.$=null;this.Lb=new Iu("",a,4);Rs(this.Lb,2,!1);this.Qa(this.Lb)}y(gY,R);var pDc={defaultHelpArticleId:"6280499"};p=gY.prototype;p.Ha=function(){gY.qa.Ha.call(this);this.La=S(nDc);this.Zc=this.Za("waffle-assistant-panel-content-container");this.hd=this.Za("waffle-assistant-empty-list")};
p.Ra=function(){gY.qa.Ra.call(this);var a=this.Za("waffle-assistant-spinner-container");this.vc.render(a);this.H.kb(this.Za("waffle-assistant-panel-card-holder"));this.Lb.kb(this.Za("waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Lb,"action",this.n_b).V(this.La,"scroll",Qpc(this.jba,10,this))};p.setVisible=function(a){var b=this;Q(this.La,a);A(this.C,function(a){if(!a.Wb()){var c=b.H.Vc();a.Ba=c;b.H.Qa(a,!0);a.UI()}});this.Yb=a};
p.Boa=function(a,b){var c=this.Aa();this.$&&this.L3();this.$=new R;this.Qa(this.$);a=qt(a,oDc,{title:b});this.ib=new Iu("",this.Aa());this.$.Qa(this.ib);this.ib.kb(c.Za("waffle-assistant-panel-back-button",a));ZX(this.ib.La,"Back");this.$.getHandler().V(this.ib,"action",this.Wjb)};p.L3=function(){this.$.dispose();this.$=null};function qDc(a,b){uW(a.vc,b);Q(a.Za("waffle-assistant-panel-pane"),!b)}p.kH=function(a){Q(this.hd,a);Q(this.Zc,!a)};
function rDc(a,b){Fb(a.C,b);a.H.removeChild(b);a.H.vh(b,0);a.C.push(b)}p.WG=function(a){Fb(this.C,a);-1!=sr(this.H,a)&&this.H.removeChild(a,!0)};p.yV=function(){this.H.Hd(!0);ze(this.C);this.C=[]};p.jba=function(){var a=this.La;a=a.scrollTop+dr(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(jDc(d,!0),b+=dr(d.La).height):jDc(d,!1)}};function sDc(a,b){a.xe=b;A(a.C,function(a){a.mA(b)})}p.ud=g("xe");p.n_b=function(){P.$n.mc(pDc)};p.Wjb=function(){this.dispatchEvent("Md")};function hY(a,b,c,d){R.call(this,d);this.$=a;this.ib=b;this.va=new Iu("",this.Aa());this.Qa(this.va);this.J=new R(this.Aa());this.Qa(this.J);this.C=null;this.gb=[];this.cb=this.bb=!1;this.R=c}y(hY,R);p=hY.prototype;p.CKa=Mh;p.Epa=Nh;p.Ha=function(){hY.qa.Ha.call(this);this.La=S(lDc,{title:this.XM()})};
p.Ra=function(){hY.qa.Ra.call(this);this.J.kb(this.Za("waffle-assistant-section-card-holder"));this.va.kb(this.Za("waffle-assistant-section-more-button"));this.getHandler().V(this.va,"action",this.Hub);this.C=this.hAa();this.Fa(this.C);Q(tDc(this),this.CKa());this.setVisible(!1)};p.setVisible=function(a){if(this.Wb()&&this.isVisible()!=a&&(Q(this.La,a),a)){Q(this.va.La,this.Ipa());a=new Qp;D(a,4,this.Z0());var b=new Op;bd(b,58,a);a=uq(tq(new sq,10),b).build();this.R.Xb(2774,a)}};
p.isVisible=function(){return this.Wb()&&gr(this.La)};p.Ipa=function(){return this.gb.length>this.$};p.hAa=function(){return new gY(this.Aa())};p.YM=function(a){this.cb=a;A(uDc(this),function(b){b.mA(a)});sDc(this.C,a)};p.ud=g("cb");p.Yf=ta;
p.WM=function(a){this.gb=a;for(var b=0;b<a.length;b++){if(this.J.Vc()<this.$){var c=this.qO(a[b]);c.mA(this.cb);var d=this.J.Vc();c.Ba=d;this.J.Qa(c,!0)}if(this.Epa()&&(this.C.kH(!1),c=this.C,d=this.qO(a[b]),c.C.push(d),c.Yb)){qDc(c,!1);var e=c.H.Vc();d.Ba=e;c.H.Qa(d,!0);d.UI()}}};function uDc(a){var b=[];a.J.Ef(function(a){b.push(a)});return b}function tDc(a){return a.Za("waffle-assistant-section-content")}p.Zka=function(){return this.J.H7()};
p.vT=function(){this.gb=[];ze(this.J.Hd(!0));this.setVisible(!1);this.Epa()&&(this.C.yV(),this.C.kH(!0))};function vDc(a){a.J.Ef(function(a,c){c<this.$&&a.UI()},a)}p.$M=function(a){var b=0;if(this.bb)this.C.jba();else if(this.Zka()){this.setVisible(!0);b=dr(this.Za("waffle-assistant-section-header")).height+dr(tDc(this)).height;for(var c=uDc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.NHa(c[d]),jDc(c[d],!0),b+=dr(c[d].La).height):jDc(c[d],!1)}else this.setVisible(!1);return a-b};p.NHa=ta;
p.$0=function(a){(this.bb=a)||this.C.L3()};p.Tb=g("bb");function wDc(a,b){a.C.Boa(b,a.XM())}p.Hub=function(){this.$0(!0);this.dispatchEvent("Rd")};var xDc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function yDc(a){var b=new UH(pc(xDc));return Suc(a,b)}
function zDc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.hc("useFirstColumnAsDomain")&&a.Fd()&&"number"===a.Fd().Wc(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.hc("useFirstColumnAsDomain")&&a.Fd()&&"string"===a.Fd().Wc(0)){c=0;var d=Ln("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Fd().getNumberOfRows();b++)fo(d,a.Fd().Ff(b,0)),c=Math.max(c,kr(d).width);Wn(d);c=Math.min(27,Math.max(15,10+100*c/271))}Eo&&Do||Fo||(a.setOption("chartArea.top","15%"),b=a.hc("hAxis.title"),a.setOption("chartArea.height",Qa(fb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Qa(fb(a.hc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function ADc(a,b,c){var d=a.Lc(),e=a.Pc();switch(b){case 0:d=Math.min(d,a.kc()+c);break;case 1:e=Math.min(e,a.jc()+c)}return Yk(a.Jb(),a.kc(),a.jc(),d,e)}function BDc(a){var b=new KAa;D(b,1,""+a.C);var c=a.rect.kc();D(b,2,c);c=a.rect.Lc();D(b,3,c);c=a.rect.jc();D(b,4,c);a=a.rect.Pc();D(b,5,a);return b}function CDc(a){var b=new Op;if(a){var c=new Qp;a=BDc(a);bd(c,7,a);bd(b,58,c)}return b};function DDc(){return U('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function EDc(){return U(""+T(Hu({vd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(Hu({vd:"waffle-assistant-zoom-button",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4}))+"")};function FDc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(T(a.i4a)+"</span>"),d=0==a.BDa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=U('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.BDa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+T(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=U(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(zo?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return U(b)};function GDc(a,b,c,d,e,f,h){R.call(this,h);this.H=a;this.D=b;this.L=e;this.F=f;this.C=this.xc=null;this.J=tq(new sq,10).build()}y(GDc,R);p=GDc.prototype;p.Ra=function(){GDc.qa.Ra.call(this);(new FV(ZH,this.D.hg())).send(v(this.cnb,this,this.D))};p.qIa=function(a,b){a=new ZCc(this.H.clone(),this.L,this.xc,2746,a,b);this.dispatchEvent(a)};p.cnb=function(a,b){b&&(b.ri()?JH.$D(this.La,b):(b=b.Fd(),a.$d(b),jW(a,b),KH(a,"ready",v(this.WZb,this,a)),IW(a,this.La,this.F,Fo),this.xc=b))};
p.WZb=function(a){a.Ml()&&(KH(a.Ml(),"onmouseover",v(this.UZb,this)),KH(a.Ml(),"onmouseout",v(this.VZb,this)))};p.UZb=function(){this.C=Ha()};p.VZb=function(){qa(this.C)&&500<Ha()-this.C&&this.F.Xb(2750,this.J);this.C=null};function HDc(a,b,c,d,e){R.call(this,e);this.J=a;this.Wa=b;this.Ia=c;this.Ba=d;this.L=Te(this.J,23);this.Pa=M(this.J,22);this.D=M(this.J,26);this.va=[];this.Kc=new Wk;this.O=this.F=this.C=null;this.R=!1;this.$=new Iu("",this.Aa());this.Qa(this.$);this.H=null}y(HDc,R);p=HDc.prototype;p.Ha=function(){HDc.qa.Ha.call(this);this.La=S(FDc,{i4a:this.D,BDa:this.L});this.La.style.visibility="hidden"};
p.Ra=function(){HDc.qa.Ra.call(this);var a=this.Za("waffle-assistant-facet-toggle");this.$.kb(a);this.getHandler().V(this.La,"mousedown",this.RZb).V(this.$,"action",this.NCb);zo&&(this.O=new cDc("assistantAutovisFacetFeedback",this.Aa()),this.O.render(this.Za("waffle-assistant-facet-feedback-container")),this.C=new dY(this.Aa()),this.Qa(this.C),this.C.render(this.Za("waffle-assistant-facet-thumbs-container")),eDc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.TZb).V(this.C,"thumbs-down",this.SZb));IDc(this,nwa)};p.ud=g("R");p.RZb=function(a){a.stopPropagation()};p.NCb=function(){var a=Qr(this.Za("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");IDc(this,a);JDc(this,a?2647:2646)};
function IDc(a,b){var c=a.Za("waffle-assistant-facet-toggle");fo(c,b?"HIDE":"SHOW");Vr(a.Za("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(a.Ni("waffle-assistant-faceted-chart"),function(a){ho(a,b)});a.C&&Q(a.C.La,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');ZX(c,b?a:d)}
function KDc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function LDc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function MDc(a){a.R||A(a.va,v(function(a){var b=a.La;if(!this.Ba.contains(b)){var d=this.Ba;a=new NDc(b,a);ryb(d,a)}},a))}p.TZb=function(){JDc(this,2649)};p.SZb=function(){JDc(this,2648);this.O.show(!0)};function JDc(a,b){var c=a.Ia,d=new FW,e=a.H.getChartType();d.C=e;e=a.H.Fd();d.F=e?e.clone():null;GW(c,b,d,10,a.H,a.H.hg())};function iY(a,b,c,d,e,f,h){eY.call(this,a,h);this.C=M(a,8);this.Kb=b;this.Db=c;this.L=d;this.gb=e;this.Ob=f;this.O=new Iu("",this.Aa());this.Qa(this.O);this.R=new Iu("",this.Aa());this.Qa(this.R);this.Kc=new Wk;this.Ab=null;this.Wa=!1;this.wb=[];this.jb=[];this.cb=[];this.bb=this.va=this.D=this.H=this.$=null;a=CDc(this.Ob);this.J=uq(tq(new sq,10),a).build()}y(iY,eY);
var jY={DVa:"waffle-assistant-after-chart-preview",YVa:"waffle-assistant-before-chart-preview",jWa:"waffle-assistant-card-draggable",D1:"waffle-assistant-chart-highlights",PYa:"waffle-assistant-insert-chart-button",xva:"waffle-assistant-chart-preview",c0a:"waffle-assistant-button-separator",F0a:"waffle-assistant-styled-border",G0a:"waffle-assistant-styled-rect",P1a:"waffle-assistant-zoom-button"};p=iY.prototype;p.lA=function(a){this.Ab=a;ODc(this)};
p.dA=function(){PDc(this,v(function(a){a=wqc(this.Kb,a);Or(this.La,a)},this),!1)};p.kA=Nh;p.Ry=n("autovisFeedback");p.AB=n(2208);p.zB=n(2207);p.U5=n("Was this chart useful?");p.Ha=function(){iY.qa.Ha.call(this);fY(this).appendChild(S(DDc));hDc(this).appendChild(S(EDc));if(Oe(this.C,22)){this.D=new HDc(this.C,this.Ba,this.L,this.gb,this.Aa());this.Qa(this.D,!0);var a=this.D,b=this.ud();a.R=b;MDc(a)}};
p.Ra=function(){iY.qa.Ra.call(this);Rr(this.La,jY.jWa);var a=this.Za(jY.PYa);this.O.kb(a);ZX(a,"Insert chart");a=this.Za(jY.P1a);this.R.kb(a);ZX(a,"View full size");a=this.Za(jY.YVa);var b=this.Za(jY.DVa);this.getHandler().V(this.La,"keydown",this.OZb).V(a,"focus",this.fkb).V(b,"focus",this.Tib).V(this.O,"action",this.ssb).V(this.O.La,"mousedown",this.Kra).V(this.R,"action",this.yEb).V(this.R.La,"mousedown",this.Kra).V(this.Za(jY.D1),"mousedown",this.Kra).V(QC(this.Kb),"Ca",this.PZb);QDc(this);this.L.Xb(2790,
this.J);this.D&&this.L.Xb(2791,this.J)};p.mA=function(a){iY.qa.mA.call(this,a);QDc(this);this.Wb()&&RDc(this)};function QDc(a){if(a.Wb()){var b=a.ud();a.O.setVisible(!b);a=a.Aa().Za(jY.c0a,hDc(a));Q(a,!b)}}p.OZb=function(a){13==a.keyCode&&a.target==this.La&&(a.preventDefault(),a.stopPropagation(),SDc(this,2255))};
function TDc(a){var b=a.getChartType(),c=!!M(a.C,14),d=M(a.C,16),e=!!M(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=Vpc(Te(a.F,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=h[m].rect;q=c!=b?Poc(q,new uk(q.width,1)):Poc(q,new uk(1,q.height));Jb(l,q)}c=LF(a.Db).D;var t=[];for(w in lk)t.push(Rnb(c,lk[w]));var w=rb(l,function(a){return rb(t,Fa(Hk,a))});f&&e&&(w=Kb(w,1));a.cb=UDc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=LF(a.Db);for(e=0;e<w.length;e++)for(f=a.cb[e],b=0;b<w[e].length;b++)w[e][b]&&Sk(w[e][b])&&
(k=Cpc(d,w[e][b],jY.G0a),a.Fa(k),vM(d.O,"default",k,!0),Mq(k.La,"background-color",f),k.setVisible(!0),a.wb.push(k),k=UM(d,w[e][b],jY.F0a,1,0),a.Fa(k),oob(k,f),k.setVisible(!0),a.jb.push(k))}function VDc(a){ze(a.wb);ze(a.jb);a.wb=[];a.jb=[];a.cb=[]}p.PZb=function(){this.Wa&&(VDc(this),TDc(this))};p.Y0=function(){iY.qa.Y0.call(this);this.va=Ha();this.Wa||(TDc(this),this.Wa=!0)};
p.uT=function(){iY.qa.uT.call(this);qa(this.va)&&500<Ha()-this.va&&this.L.Xb(2789,this.J);this.va=null;VDc(this);this.Wa=!1};p.fkb=function(){var a=this.Za(jY.D1);gr(a)?a.focus():this.La.nextSibling&&this.La.nextSibling.focus()};p.Tib=function(){var a;if(a=this.Pa)a=this.Pa,a.Cb("waffle-assistant-feedback-card-hidden")?a=!1:(a.Za("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.R.La.focus()};p.ssb=function(){SDc(this,2255)};p.Kra=function(a){a.stopPropagation()};
p.yEb=function(){lNa.mc(this,this.J)};p.qIa=function(a,b){SDc(this,2257,a,b)};function SDc(a,b,c,d){PDc(a,v(function(a){a=new ZCc(a,this.Ba,this.H&&this.H.Fd(),b,c,d,aCa(this.J));this.dispatchEvent(a)},a),!1)}
p.QZb=function(a,b){if(b){var c=this.Za(jY.xva);if(b.ri())JH.$D(c,b);else{a.$d(b.Fd());jW(a,a.Fd());XU(a,"ready",v(this.NZb,this,a));b=[];try{var d=new dh;d.setContext(a.toJSON());var e=!!M(this.C,14);O(d,3,e);var f=M(this.C,16);O(d,4,f);O(d,5,"ROWS"==(e?"ROWS":"COLS"));O(d,8,0);if(M(this.C,24)){var h=M(this.C,25);O(d,9,h)}var k=Vpc(Te(this.F,4));for(e=0;e<k.length;e++)d.addRange(al(k[e].rect,k[e].C));var l=this.Kc.serialize(d);b=rb(qwc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
nwc)}catch(m){b=[]}d=this.Za(jY.D1);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),ho(d,!0));this.H=a;IW(a,c,this.L,Fo)}}};p.NZb=function(a){null!==this.$&&(Vd(Td(),this.$),this.$=null);this.isDisposed()||(a.Ml()&&(KH(a.Ml(),"onmouseover",v(this.LZb,this)),KH(a.Ml(),"onmouseout",v(this.MZb,this))),this.Ab(),RDc(this))};p.LZb=function(){this.bb=Ha()};p.MZb=function(){qa(this.bb)&&500<Ha()-this.bb&&this.L.Xb(2795,this.J);this.bb=null};
function RDc(a){if(!a.ud()){var b=a.Za(jY.xva);if(!a.gb.contains(b)){var c=a.gb;a=new NDc(b,a);ryb(c,a)}}}function WDc(a){a.Mc&&(a.$=Ud(Td(),$l.ysa),a.Mc=!1);M(a.C,16);var b=yDc(a.C);b.P$(ZH);var c=Uuc(a.F);b.cj(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}
function ODc(a){var b=WDc(a);b=zDc(b,a.Za("waffle-assistant-card-inner"));(new FV(ZH,b.hg())).send(v(a.QZb,a,b));a.D&&PDc(a,v(function(a){var c=this.D,e=b;a=new UH(a.toJSON());e=new UH(e.toJSON());var f=c.Ni("waffle-assistant-faceted-chart");if(1<f.length){LDc(a);var h=e;KDc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");Eo&&Do||Fo||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,LDc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),KDc(e);h=Vpc(Te(c.J,27));B8a(c.F,h);h=M(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Pa,t=new ih;O(t,1,q);na(l)&&t.fb(l);O(m,7,t);c.F.rc("dt",encodeURIComponent(JSON.stringify(c.Kc.serialize(m))));
q=new UH(a.toJSON());q.cj(c.F.toString());m=e.clone();m.cj(c.F.toString());var w=c,x=q.hc("title");x||(x=$Bc(q));t=x+(' when "'+(w.D+('" is "'+(l+'"'))));w=x+(' by "'+(w.D+'"'));t=l?t:w;q.setOption("title",t);m.setOption("title",t);w=new GDc(q,m,0,0,c.Wa,c.Ia,c.Aa());c.Qa(w);t=f[k];w.kb(t);c.va.push(w);w=c;x=$Bc(q);q=x+(' broken down by "'+(w.D+('" for "'+(l+'"'))));w=x+(' broken down by "'+(w.D+'"'));Or(t,l?q:w);c.H=m}MDc(c);c.La.style.visibility="visible"},a),!1)}
function PDc(a,b,c){var d=WDc(a);(new FV(ZH,d.hg())).send(function(a){a?(a=a.Fd(),c&&d.$d(a),jW(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function UDc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=ltc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Jb(d,d);return d};function NDc(a){CO.apply(this,arguments)}r(NDc,CO);NDc.prototype.Pia=g("element");function XDc(){AO.call(this);this.Wa.push(this);this.Ba=this.Ia=!0;this.ib="waffle-assistant-dragged-card"}y(XDc,qyb);XDc.prototype.contains=function(a){return!!A(this.L,function(b){if(b.element==a)return!0})};XDc.prototype.Nia=function(a){var b=XDc.qa.Nia.call(this,a);if(Eo&&Do||Fo){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=rb(b.querySelectorAll("clippath"),function(a){return a.id}),YDc(b,a);return b};
function YDc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&Ya(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Yn(a);for(c=0;c<a.length;c++)YDc(a[c],b)};function ZDc(){return U('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function $Dc(a,b){eY.call(this,a,b);this.C=M(a,8)}y($Dc,eY);p=$Dc.prototype;p.dA=ta;p.Ry=n("assistantWordCloudFeedback");p.AB=n(2634);p.zB=n(2633);p.Ha=function(){$Dc.qa.Ha.call(this);fY(this).appendChild(S(ZDc));Rr(fY(this),"waffle-assistant-word-cloud-content-container")};
p.lA=function(a){for(var b=Te(this.C,19),c=Te(this.C,20),d=this.Za("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(aEc(this,b,c,e),120<d.clientHeight){aEc(this,b,c,e-1);break}b=this.Aa();c=M(this.C,2);c=ro(b,c);d=this.Za("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function aEc(a,b,c,d){var e=a.Za("waffle-assistant-word-cloud-words-container");for(a=a.Aa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(ro(a," "));var l=a.createElement("SPAN");a.appendChild(l,ro(a,b[k]));a.appendChild(e,l);Rr(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function kY(a,b,c,d,e){hY.call(this,20,d,c,e);this.Ba=a;this.L=b;this.D=new XDc;this.Fa(this.D);this.F=null;this.H=0;this.O=null}y(kY,hY);p=kY.prototype;p.Ra=function(){kY.qa.Ra.call(this);this.D.Ie();this.getHandler().V(this.D,"drag",this.KZb).V(this.D,"dragend",this.JZb)};p.XM=n("Analysis");p.pV=function(a){return 0==a};p.qO=function(a){return"WordCloud"==M(a,8).getChartType()?new $Dc(a,this.Aa()):new iY(a,this.Ba,this.L,this.R,this.D,this.O,this.Aa())};
p.YM=function(a){kY.qa.YM.call(this,a);a&&Vxb(this.D)};p.NHa=function(a){this.getHandler().Oc(a,"content-rendered",this.IZb);this.H++};p.WM=function(a,b){this.O=b||null;kY.qa.WM.call(this,a,b)};p.IZb=function(){0==--this.H&&this.dispatchEvent("Od")};p.KZb=function(){this.F=$q(this.D.Yc.target)};p.JZb=function(a){var b=this.F,c=LF(this.L).C;if(yk(IL(c,"page",!1,!1)).contains(b)){var d=GL(c,b.x,b.y,"page");c=LL(c,d,"page");b=new qk(b.x-c.left,b.y-c.top);a.C.getData().qIa(d,b)}this.F=null};p.Z0=n(2);function bEc(a){var b=[];if(Oe(a,25)&&(a=M(a,25)))for(var c=0;c<Pe(a,1);c++){var d=M(a,1,c);if(Oe(d,2)){var e=M(d,2);e&&b.push(cEc(e,dEc(d)))}}return b}function eEc(a){var b=bEc(a);Oe(a,6)&&(a=M(a,6))&&b.push(cEc(a,0));return b}function dEc(a){return(a=Oe(a,4)?M(a,4):0)?a:0}function cEc(a,b){return{name:a,m2a:b}};function fEc(a,b,c){this.Ba=a;this.Ia=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.va=[];this.C={};this.F={};this.R={};this.D={};gEc(this,c)}function hEc(a,b){return a[b]?a[b].values.ld():[]}
function gEc(a,b){for(var c=new ik,d=new ik,e=0;e<b.length;e++){for(var f=eEc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.Ba[m]){var q=a.Ba[m];c.add(q);h.push(q)}void 0!=a.Ia[m]&&(m=a.Ia[m],d.add(m),k.push(m))}iEc(a,h,k)}a.L=c.ld();a.O=d.ld();Ob(a.L);Ob(a.O);a.H=rb(dc(a.C),function(a){return a.key});Ob(a.H);a.J=rb(dc(a.F),function(a){return a.key});Ob(a.J);a.$=rb(dc(a.R),function(a){return a.key});Ob(a.$);a.va=rb(dc(a.D),function(a){return a.key});Ob(a.va)}
function iEc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(jEc(a.C,b[d],b[e]),jEc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)jEc(a.F,b[d],c[e]),jEc(a.R,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(jEc(a.D,c[b],c[d]),jEc(a.D,c[d],c[b]))}function jEc(a,b,c){var d;a[b]?d=a[b].values:d=new ik;d.add(c);a[b]={key:b,values:d}};function kEc(a,b){this.C=a;for(var c={},d=0;d<a.Oj();d++)c[a.dd(d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Pe(a,1);d++)c[M(a,1,d).getName().toLowerCase()]=d;this.R=c;c={};for(d=0;d<this.C.Oj();d++)c[M(this.C.dd(d),11)]=d;this.va=c;c={};for(d=0;d<Pe(this.C,1);d++)c[M(M(this.C,1,d),4)]=d;this.Ba=c;c=[];for(d=0;d<a.Oj();d++)lY(a.dd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Pe(a,1);d++)lY(M(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Pe(a,1);d++){for(var e=M(a,1,d).getName(),
f=!0,h=0;h<lEc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+lEc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Pa=c;this.bb=mEc(a,0);this.$=mEc(a,1);c=[];for(d=0;d<a.Oj();d++).8<=M(a.dd(d),6)&&c.push(d);this.Ia=c;c=[];for(d=0;d<a.Oj();d++)e=a.dd(d),.95<=Te(e,2).length/M(e,8)&&c.push(d);this.cb=c;c=[];for(d=0;d<Pe(a,3);d++){e=a.dd(M(a,3,d));a:if(.5<Te(e,2).length/M(e,8)||.3>Pe(e,3)/Pe(e,2))e=!1;else{for(f=0;f<Pe(e,10);f++)if(.95<M(e,10,f)/M(e,8)){e=!1;break a}e=!0}e&&c.push(M(a,3,d))}Ob(c);this.Wa=
c;this.F=nEc(a.Oj());this.H=nEc(Pe(a,1));this.D=new fEc(this.O,this.R,b)}function nEc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function mEc(a,b){for(var c=[],d=0;d<a.Oj();d++)a.dd(d).getType()==b&&c.push(d);return c}function oEc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=pEc(c,a[d]);for(a=0;a<b.length;a++)d=pEc(c,b[a]),c=0<d.length?d:c;return c}
function mY(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.bb),m.push(a.Ia));d&&m.push(a.Wa);e&&m.push(a.cb);null!=h&&-1!=h?l.push(hEc(a.D.R,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=oEc(m,l);b=pEc(a,b);return 0<b.length?{index:aY(b),eB:3}:0<a.length?{index:aY(a),eB:1}:qEc()}
function nY(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Pa);null!=e&&-1!=e?h.push(hEc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.va);a=oEc(k,h);b=pEc(a,b);return 0<b.length?{index:aY(b),eB:3}:0<a.length?{index:aY(a),eB:1}:qEc()}function rEc(a,b){for(var c=5;;){var d=a.C.dd(b),e=$X(Pe(d,2),1)[0];c--;if(lY(OX(d,e))||0==c)return e}}function sEc(a,b){for(var c=5;;){var d=a.C.dd(b),e=$X(Pe(d,3),1)[0];e=M(d,3,e);c--;if(lY(OX(d,e))||0==c)return e}}
function oY(a,b){b=a.C.dd(b);a=b.getName();lY(a)||(b=tEc(Te(b,7)),a=null==b?a:b);return a}function pY(a,b){b=M(a.C,1,b);a=b.getName();lY(a)||(b=tEc(Te(b,2)),a=null==b?a:b);return a}function tEc(a){for(var b=0;b<a.length;b++)if(lY(a[b]))return a[b];return null}function lY(a){return null==a?!1:50>=a.length}function uEc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function qEc(){return{index:-1,eB:0}}
function vEc(a){for(var b=$X(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],eB:1});return c}function pEc(a,b){Ob(a);Ob(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var lEc=["average","total","sum","mean","median"];function qY(a){this.bb=a;this.aA=[];this.C=this.Ba=this.va=this.JK=this.pH=null;this.R=[];this.Ia=[];this.O=new ik;this.Pa=new ik;this.$=!1;this.D=[];this.F=[]}p=qY.prototype;p.Ie=function(a,b,c,d,e,f){this.reset();this.pH=b;this.JK=c;this.va=d;this.Ba=a;this.Ia=f;this.R=iwa?e:[];this.C=new kEc(a,e)};
p.m9=function(){wEc(this);var a=[];if(iwa)for(var b=0;b<this.R.length;b++){var c=this.R[b];switch(c.getChartType()){case "BarChart":if(this.wk(13)||this.wk(2)){var d=M(c,6);if(d&&-1!=uEc(this.C,d)){var e=xEc(this,c);1<e.length&&(Co&&this.wk(23)?tY(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.wk(2)&&tY(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=xEc(this,c);1<f.length&&(Co&&this.wk(23)?tY(this,a,"Scatter chart of "+f[0].name+" vs "+
f[1].name,23,2):this.wk(2)&&tY(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=[],k=bEc(c),l=0;l<k.length&&-1!=uEc(this.C,k[l].name);l++)h.push(k[l]);var m=h;1==m.length&&4==m[0].m2a&&(Co&&this.wk(20)?tY(this,a,"Chart of distribution of "+m[0].name,20,2):this.wk(14)&&tY(this,a,"Distribution of "+m[0].name,14,1.5))}}for(var q=0;q<this.Ia.length;q++){var t=this.Ia[q];if(Oe(t,3)){if(!this.wk(26))break;tY(this,a,t.Yg(),26,2)}}if(this.wk(1)){var w=this.C.C,
x=nY(this.C,this.F,!1,!0),z=x.index,B=mY(this.C,this.D,!0,!1,!0,!0,z),L=B.index;if(-1!=L&&-1!=z){var N=10<=Pe(w.dd(L),2)?"5 ":"",W=oY(this.C,L),ea=pY(this.C,z);if(W!=ea){var ca=zY(1,[x],[B]);tY(this,a,this.QFa(1)+" "+N+W+" by "+ea,1,ca)}}}if(this.wk(2)&&1<Pe(this.C.C,1)){a:{var pa=this.C,va=this.F;if(2>pa.H.length)var ua=[qEc(),qEc()];else{var xa=nY(pa,va,!1,!1,void 0,!0),Za=xa.index;if(-1!=Za){var Va=hEc(pa.D.D,Za);if(0<Va.length){var $a=[xa],vc=aY(Va),Mc=2,Ub=pEc(Va,va);0<Ub.length&&(vc=aY(Ub),
Mc=3);$a.push({index:vc,eB:Mc});ua=$a;break a}}ua=vEc(2<=pa.L.length?pa.L:pa.H)}}var Zc=ua,Nc=pY(this.C,Zc[0].index),pd=pY(this.C,Zc[1].index);if(Nc!=pd){var oe=zY(1,Zc,[]);tY(this,a,"Correlation of "+Nc+" and "+pd,2,oe)}}if(this.wk(3)){var Xb=this.C.C,mg=nY(this.C,this.F,!0),sb=mg.index;if(-1!=sb){var te=zY(1,[mg],[]);tY(this,a,this.rP(Te(M(Xb,1,sb),3),3)+" of "+pY(this.C,sb),3,te)}}if(this.wk(5)){var Je=this.C.C,Xg=nY(this.C,this.F,!0,!0),hi=Xg.index,Oj=mY(this.C,this.D,!0,!0,!1,!0,hi),xi=Oj.index;
if(-1!=hi&&-1!=xi){var Yg=pY(this.C,hi),oj=Je.dd(xi),Mn=oY(this.C,xi);if(0<Pe(oj,3)&&Mn!=Yg){var Zm=zY(1,[Xg],[Oj]),yq=sEc(this.C,xi);tY(this,a,this.rP(Te(M(Je,1,hi),3),5)+" of "+Yg+" when "+Mn+" is "+OX(oj,yq),5,Zm)}}}if(this.wk(9)){var bl=nY(this.C,this.F,!1,!0),$m=bl.index,gp=mY(this.C,this.D,!0,!1,!0,!0,$m),hm=gp.index;if(-1!=hm&&-1!=$m){var an=pY(this.C,$m),Pj=oY(this.C,hm);if(Pj!=an){var Vs=zY(1,[bl],[gp]);tY(this,a,Pj+" with "+this.ria(9)+" "+an,9,Vs)}}}if(this.wk(10)&&0<Pe(this.C.C,1)){var Dk=
nY(this.C,this.F),Ri=zY(1,[Dk],[]),yi=pY(this.C,Dk.index);tY(this,a,this.ria(10)+" "+yi,10,Ri)}if(this.wk(11)){var ii=this.C.C,bn=mY(this.C,this.D,!0,!0,!1,!1,-1),cn=bn.index;if(-1!=cn){var ax=oY(this.C,cn);if(0<Pe(ii.dd(cn),3)){var Bl=zY(1,[],[bn]);tY(this,a,"Most frequent "+ax,11,Bl)}}}if(this.wk(12)){var Cr=this.C.C,Ws=nY(this.C,this.F,!0),dn=Ws.index;a:{var cl=this.C;if(1==cl.$.length){var Nu=cl.$[0];if(!M(cl.C.dd(Nu),5)){var Ou=Nu;break a}}Ou=-1}var Dr=Ou;if(-1!=Dr&&-1!=dn){var Pu=pY(this.C,
dn),Er=Cr.dd(Dr);if(0<Pe(Er,2)){var Qu=zY(1,[Ws],[]),wD=rEc(this.C,Dr);tY(this,a,this.rP(Te(M(Cr,1,dn),3),12)+" of "+Pu+" "+aY(yEc)+" "+OX(Er,wD),12,Qu)}}}if(this.wk(15)){var en=this.C.C,dl=nY(this.C,this.F,!0),hp=dl.index,Lz=mY(this.C,this.D,!1,!0,!1,!0,hp),fn=Lz.index;if(-1!=hp&&-1!=fn){var Fr=pY(this.C,hp),Cl=oY(this.C,fn);if(Cl!=Fr){var Dl=en.dd(fn);if(2<=Pe(Dl,3)){var Gr=zY(1,[dl],[Lz]),bx=$X(Pe(Dl,3),2);tY(this,a,"Compare "+this.rP(Te(M(en,1,hp),3),15)+" "+Fr+" for "+Cl+" "+OX(Dl,M(Dl,3,bx[0]))+
" and "+OX(Dl,M(Dl,3,bx[1])),15,Gr)}}}}if(this.wk(16)){var Nn=mY(this.C,this.D,!0,!0,!1,!1),Hr=Nn.index;if(-1!=Hr){var ip=oY(this.C,Hr),On=zY(1,[],[Nn]);tY(this,a,"List unique values in "+ip,16,On)}}if(this.wk(17)){var Xs=this.C.C,Ir=mY(this.C,this.D,!0,!0,!1,!1),el=Ir.index;if(-1!=el){var Ys=Xs.dd(el),Zs=oY(this.C,el);if(!(1>Pe(Ys,3))){var $s=sEc(this.C,el),Jr=zY(1,[],[Ir]);tY(this,a,"What percentage of "+Zs+" is "+OX(Ys,$s),17,Jr)}}}if(this.wk(13)){var Ru=this.C.C,zq=nY(this.C,this.F,!0,!0),at=
zq.index,jp=mY(this.C,this.D,!0,!0,!1,!0,at),xD=jp.index;if(-1!=at&&-1!=xD){var kp=pY(this.C,at),Su=oY(this.C,xD);if(Su!=kp){var El=zY(1,[zq],[jp]);tY(this,a,this.rP(Te(M(Ru,1,at),3),13)+" of "+kp+" by "+Su,13,El)}}}if(Co&&this.wk(18)){var cx=nY(this.C,this.F),Mz=cx.index;if(-1!=Mz){var yD=zY(2,[cx],[]);tY(this,a,"Histogram of "+pY(this.C,Mz),18,yD)}}if(this.wk(24)){var tI=mY(this.C,this.D,!0,!0),UO=tI.index;if(-1!=UO){var VO=zY(1,[tI],[]);tY(this,a,"Count of "+oY(this.C,UO),24,VO)}}if(this.wk(25)){var rY=
this.C.C,zra=mY(this.C,this.D,!0,!0),sY=zra.index;if(-1!=sY){var gPa=rY.dd(sY),hPa=rEc(this.C,sY),Ara=zY(1,[zra],[]);tY(this,a,"Count when "+oY(this.C,sY)+" is "+OX(gPa,hPa),25,Ara)}}var Y9=3>a.length;if((Y9||0==$X(5,1)[0])&&this.wk(7)){var Cob=this.C.C,Z9=nY(this.C,this.F,!1,!0),uI=mY(this.C,this.D,!1,!1,!1,!0,Z9.index);if(-1!=uI.index&&-1!=Z9.index){var uY=Cob.dd(uI.index),vY=oY(this.C,uI.index),$9=pY(this.C,Z9.index);if(0<Pe(uY,2)&&vY!=$9){var Bra=zY(1,[Z9],[uI]),wY=rEc(this.C,uI.index);tY(this,
a,"Show "+$9+" for "+vY+" "+OX(uY,wY),7,Bra)}}}if((Y9||0==$X(5,1)[0])&&this.wk(8)){var Cra=this.C.C;a:{var vI=this.C,a$=this.D;if(2>vI.F.length)var Yz=[qEc(),qEc()];else{var Dra=mY(vI,a$,!0,!1,!1,!1,void 0,!0),Era=Dra.index;if(-1!=Era){var Fra=hEc(vI.D.C,Era);if(0<Fra.length){var iPa=[Dra],Zz=aY(Fra),xY=2,b$=pEc(Fra,a$);0<b$.length&&(Zz=aY(b$),xY=3);iPa.push({index:Zz,eB:xY});Yz=iPa;break a}}var wI=vEc(2<=vI.J.length?vI.J:vI.F);wI[0].index!=Era&&(wI[1]=wI[0],wI[0]=Dra);Yz=wI}}var yY=Yz,c$=yY[0].index;
if(1<Cra.Oj()&&-1!=c$){var WO=yY[1].index,d$=Cra.dd(WO),Gra=oY(this.C,WO),e$=oY(this.C,c$);if(0<Pe(d$,2)&&Gra!=e$){var UQd=zY(1,[],yY),VQd=rEc(this.C,WO);tY(this,a,"What is "+e$+" where "+Gra+" is "+OX(d$,VQd),8,UQd)}}}this.aA=zEc(a)};function wEc(a){if(a.$){var b=qI(a.bb).Dj(),c=Ue(a.C.C,4);A(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.va[d+b],k=a.C.Ba[d+b];h&&0<=h&&Bb(a.D,h);k&&0<=k&&Bb(a.F,k)}})}}
p.reset=function(){this.aA=[];this.F=[];this.D=[];this.Pa=new ik;this.O=new ik};p.n9=function(){return Wh(this.aA.slice())};function zEc(a){Ob(a,function(a,c){return c.weight-a.weight});return rb(a,function(a){return a.sqa})}function tY(a,b,c,d,e){e=a.OFa(d,e);a.Pa.contains(c)||(b.push({sqa:{query:c,Wm:void 0,type:d},weight:e}),a.O.add(d),a.Pa.add(c))}p.wk=function(a){return!this.O.contains(a)};function AEc(a,b){return a.n9().then(function(a){return a.length<=b?a:Kb(a,0,b)},null,a)}
function zY(a,b,c){A(b,function(b){3==b.eB&&a++});A(c,function(b){3==b.eB&&a++});return a}function xEc(a,b){var c=[];b=bEc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.R?e.R[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.rP=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=BEc;break a;case 4:a=CEc;break a}a=DEc}return aY(a)};p.QFa=function(){return aY(EEc)};p.ria=function(){return aY(FEc)};
var DEc=["Average","Median"],BEc=["Total","Average","Median"],CEc=["Median"],FEc="Minimum Maximum Most Least Highest Lowest".split(" "),EEc=["Top","Bottom"],yEc=["before","after"];function GEc(a,b,c){qY.call(this,a);this.J=[];this.L=this.H=null;this.Wa=b;this.gb=c;this.cb=tq(new sq,10).build()}r(GEc,qY);p=GEc.prototype;p.m9=function(){this.reset();qY.prototype.m9.call(this);hwa&&HEc(this)};p.reset=function(){qY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.n9=function(){return hwa&&this.H?this.H.then(function(){return this.J.slice()},null,this):qY.prototype.n9.call(this)};p.OFa=function(a,b){return Math.pow(Math.random(),1/(IEc(a)*b))};
p.Yf=da("L");function IEc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function HEc(a){var b=null;a.H=new Uh(function(a){if(!this.L||this.L.getStatus().getState().bl())this.J=this.aA,a();var c=rE(this.pH.rect),e=rb(this.aA,function(a){return a.query});c=jn(hn(km(mm(nm(this.L.Le("/answers/parsesuggestions").Df("gid",this.pH.C,"range",c),v(function(b){JEc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.gb.Xb(2833,this.cb);this.J=this.aA;a()},this)).setContent(["queries",dj(e)]).setTimeout(2E3),1)),"POST");Ko&&this.JK&&null!=this.va&&(e=0==this.JK.rect.width||
0==this.JK.rect.height?"":rE(this.JK.rect),c.Df("headerRange",e,"tableRecordDimension",""+this.va));b=c.ye()},a);ai(a.H,function(){b&&b.dispose()})}function JEc(a,b){return a.Wa.C.D.C.then(function(){var a=[];if(b.Ik())for(var d=b.Xe(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.Ba&&!!M(this.Ba,4),f=KEc(this.Wa,d[e],this.pH,f),f=LEc(f);f&&(this.aA[e].Wm=d[e],a.push(this.aA[e]))}this.J=a},function(){this.J.length=0},a)};var MEc={};Yb({m1a:{type:0,cA:"",Zz:[]},Wca:{type:1,cA:"Sum",Zz:[3,5,13,12,15]},xba:{type:2,cA:"Average",Zz:[3,5,13,12,15]},sca:{type:3,cA:"Mode",Zz:[3]},A1a:{type:4,cA:"Variance",Zz:[3]},C0a:{type:5,cA:"Standard deviation",Zz:[3]},Zua:{type:6,cA:"Median",Zz:[3,5,13,12]},RT:{type:7,cA:"Count",Zz:[24,25]},w0a:{type:8,cA:"Bottom",Zz:[1,10,14]},x0a:{type:9,cA:"Top",Zz:[1,11,10,14]}},function(a){MEc[a.type]=a});function NEc(a){if(a=MEc[a])return a};function OEc(a){qY.call(this,a);this.H=[]}r(OEc,qY);p=OEc.prototype;p.reset=function(){qY.prototype.reset.call(this);this.H=[]};p.OFa=function(a,b){return 1+b};p.wk=function(a){return!this.O.contains(a)&&0<PEc(this,a).length};p.QFa=function(a){return QEc(this,a)};p.rP=function(a,b){return QEc(this,b)};p.ria=function(a){return QEc(this,a)};function REc(a,b){a.reset();A(b,function(b){A(Te(b,1),function(b){a.H.push(M(b,1))},a)},a);ICc(a.H);a.m9();return AEc(a,3)}
function PEc(a,b){return qb(a.H,function(a){return yb(NEc(a).Zz,b)},a)}function SEc(a,b){a=wb(a.H,function(a){return NEc(a).type==b},a);return NEc(a)}function QEc(a,b){b=PEc(a,b);return SEc(a,aY(b)).cA};function TEc(){this.F=this.D="";this.L=!1;this.H=0;this.O=!1;this.J=0;this.C=""};var UEc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),VEc=[{Xj:["Thank you","Thankyou","Thanks"],zq:"No problem"},{Xj:["you are amazing","This is great","omg"],zq:"Happy to help"},{Xj:["I love you"],zq:"Must be in the air"},{Xj:["How do you know","How are you so smart"],zq:"It's all in the data"},{Xj:["Are you sure"],zq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Xj:["How are you"],zq:"Pretty good, thanks"},
{Xj:["Hi","Hello","Hey"],zq:"Hi, there. Try asking a question about your data."},{Xj:["You are stupid","This is dumb","You are wrong"],zq:"Help improve this experience by sending feedback"},{Xj:["How smart are you"],zq:"Pretty smart"}];function WEc(a){for(var b=0;b<VEc.length;++b)if(-1!=xb(VEc[b].Xj,function(b){return Ma(a,b)}))return b;return-1};function XEc(a,b,c,d){var e=new QBc;D(e,2,c);A(b,function(a){Wc(e,1).push(a)});D(e,3,d);d=new NX;D(d,1,a);D(d,3,b[c]);bd(d,11,e);return d}function YEc(a,b,c,d){var e=new MBc;D(e,2,c);A(b,function(a){Wc(e,1).push(a)});D(e,3,d);d=new NX;D(d,1,a);D(d,2,b[c]);bd(d,10,e);return d}function ZEc(a){var b=new KBc;A(a,function(a){var c=a.type;Wc(b,1).push(c);a.fEa&&(a=a.fEa,Wc(b,2).push(a))});return b}function $Ec(a){var b=new OBc;A(a,function(a){a=a.type;Wc(b,1).push(a)});return b}
function aFc(a,b,c,d){var e=new SBc;a&&D(e,1,a);b&&D(e,2,b);for(a=0;a<c.length;a++)b=c[a],Wc(e,3).push(b);D(e,4,d);return e};function AY(a,b){this.D=a;this.C=b}AY.prototype.getChartType=g("D");var BY={2:new AY("ColumnChart","Column chart"),3:new AY("LineChart","Time series"),4:new AY("ScatterChart","Scatter chart"),5:new AY("PieChart","Pie chart"),10:new AY("Histogram","Histogram"),7:new AY("LineChart","Line chart")};function CY(a,b,c,d,e,f,h){this.D=a;this.JA=b;this.H=(void 0===h?null:h)||b;this.C=d;this.Wm=c;this.Wa=d?Te(d,6):[];this.bb=d?Te(d,7):[];this.Pa=d?Te(d,8):[];this.error=e||1;this.interpretation=d&&Oe(d,4)?M(d,4):null;this.va=new TEc;this.O=d?Te(d,12):[];this.Ia=d?Te(d,21):[];this.Ba=f;this.F=null;this.$=this.J=!1;this.L=[];this.R=null;Co&&bFc(this)}function cFc(a){return 1==a.error&&null!=a.Wm}
function dFc(a){return{zL:eFc(a),interpretation:a.interpretation,JA:a.JA,Wm:a.Wm,gL:1<a.JA.length&&1<a.JA[0].length,$j:a.$j(),Tpa:a.$,$w:a.$w(),a8:a.L}}CY.prototype.$j=function(){return Co&&null!=this.F&&(this.F in BY?!0:!1)&&2<this.H.length};CY.prototype.$w=function(){return Bo&&F(E(),"feapt")&&null!==this.C&&Oe(this.C,24)};CY.prototype.getChartType=function(){if(!this.$j())return null;var a=this.F;if(a in BY)return BY[a].getChartType();throw Error("Unknown chart type.");};
function fFc(a){a.$j();return a.H[0][0]}function gFc(a){return rb(Te(a.C,22),function(b){if(M(b,2)){var c=a.Ba.C;return pE(M(b,2),c)}},a)}function hFc(a){return{zL:eFc(a),error:iFc(a)}}function jFc(a,b,c){var d=c.length;if(0==d)return a;1<d&&Fb(a,10);c=M(c[0],1);2<d&&9==c&&Fb(a,4);2<d&&Fb(a,5);2!=c&&3!=c&&12!=c&&Fb(a,3);yb(b,10)&&yb(a,10)&&cba(a,function(a){return 10!=a});return a}
function bFc(a){var b=null;a.J=!1;a.F=null;if(a.C&&Oe(a.C,17)){var c=M(a.C,17);a.$=M(c,4)||!1;var d=Te(c,3),e=jFc(Te(c,1),d,Te(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=qb(e,function(a){return yb(d,a)}),c=qb(d,function(a){return!yb(e,a)}),Fb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):yb(d,10)&&yb(e,2)?(a.J=!0,a.F=2,Fb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=kFc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=kFc(a,e),a.J=M(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.R=aFc(a.F,b,e,a.J))}}function kFc(a,b){if(!Te(a.C,18).length)return b[0];a=lFc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(yb(b,a[c]))return a[c];return b[0]}function mFc(a,b,c){var d={};null!=b?(d.v=nFc(a,b,c),d.f=b):d.v=null;return d}
function lFc(a){for(var b=new BH,c=a.H[0],d=Kb(a.H,1),e=Te(a.C,18),f=[],h=0;h<c.length;h++)e[h]&&Oe(e[h],1)?f.push(oFc(M(e[h],1))):f.push(0==h?"string":"number"),b.zs({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(mFc(a,d[e][k],f[k]));b.Ku(h)}return b}
function nFc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=t5a(a.Ba.L.C).DECIMAL_SEP,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),lb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Ra(a[0])&&Ra(a[1])&&(Ra(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Ra(a[d])&&
(c[d]=lb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function oFc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function pFc(a){if(!Oe(a.C,9))return"";if(Oe(a.C.getError(),3))switch(M(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Rj()||""}
function iFc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return pFc(a)||"Sorry, couldn't understand your question.";case 7:return a=WEc(a.D),-1!=a?VEc[a].zq:""}return""}
function eFc(a){var b=[];if(cFc(a)){var c=[];A(Hb(a.Wa,a.Pa),function(a){c.push(qFc(a,"waffle-assistant-answercard-question-unused-phrase"))});A(a.bb,function(a){c.push(qFc(a,"waffle-assistant-answercard-question-used-entity"))});Ob(c,function(a,b){return a.Ax>b.Ax?1:-1});var d=0;A(c,function(c){var e=c.length,h=c.Ax;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Bk}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function qFc(a,b){return{Ax:M(a,2),length:M(a,3),Bk:b}};function rFc(a,b,c,d,e,f){this.D=a;this.H=b;this.J=c;this.L=d;this.C=e;this.F=f;this.Kc=new Wk}function sFc(a,b){var c=new qk(0,0);b?(c=wE(a.H,a.C,c,b.fc()),a.F.C(new NK(c,b))):(b=wE(a.H,a.C,c,0),a.F.C(new myc(b,a.C)))}
function tFc(a,b){BJ(b);var c=AJ(b),d=Te(a.D,1).length,e=101*Te(a.D.Wy(0),1).length;d*=24;JI.clear();ar(b,e,d);CJ(b,c,e,d);c.fillStyle="#f3f3f3";c.fillRect(0,0,b.width,b.height);e=b.width;b=b.height;ritz_api.PivotPreviewApi.renderPivotPreview(a.Kc.serialize(a.D),a.J,c,a.L.C,JI,e,b,101,24)};function uFc(){return U('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function vFc(){return U(""+T(Hu({vd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-plus"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(Hu({vd:"waffle-assistant-zoom-button",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4}))+"")}
function wFc(){var a=""+('<div class="waffle-pivottable-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+T(Hu({content:Bt("INSERT PIVOT TABLE"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+T(Hu({vd:"waffle-autovis-lightbox-close",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Bt("Close")}))+"</div></div><div class='waffle-pivottable-preview-pane'><div class='waffle-pivottable-preview-interpret'></div><div class='waffle-pivottable-canvas'></div></div></div>");
return U(a)};function DY(a,b,c,d,e,f){R.call(this,f);this.H=a;this.J=b;this.R=c;this.L=d;this.O=e;this.C=new Iu("",this.Aa());this.Qa(this.C);this.D=new Iu("",this.Aa());this.Qa(this.D);this.F=Jn("CANVAS","waffle-pivottable-canvas-content")}r(DY,R);DY.prototype.Ha=function(){R.prototype.Ha.call(this);this.La=S(wFc)};
DY.prototype.Ra=function(){R.prototype.Ra.call(this);var a=this.Za("waffle-autovis-lightbox-close");this.C.kb(a);a=this.Za("waffle-autovis-lightbox-insert");this.D.kb(a);this.getHandler().V(this.D,"action",this.$).V(this.C,"action",this.close);this.Za("waffle-pivottable-canvas").appendChild(this.F);fo(this.Za("waffle-pivottable-preview-interpret"),this.J);tFc(this.H,this.F)};DY.prototype.$=function(){this.close();this.dispatchEvent("close-sidebar");sFc(this.H,null);this.R.C(this.O,this.L);this.close()};
DY.prototype.close=function(){this.dispose()};function xFc(a,b){Vr(a.La,"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)};function yFc(a,b,c,d){J.call(this);this.$=a;this.R=b;this.va=c;this.Wa=d;this.Va=new Oi(this);this.Fa(this.Va);this.C=new oW;this.Fa(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;cvc(this.C,this.$);this.C.Ba=10;this.C.gb=!0;this.C.R=!1;this.C.GRa("waffle-assistant-visible");this.C.L=Sa("waffle-assistant-dragged-formula").split(" ");this.C.Ie();this.Va.V(this.C,Wuc,this.Ia).V(this.C,Zuc,this.Pa).V(this.C,$uc,this.Ba)}y(yFc,J);
yFc.prototype.Ia=function(a){a=ob(this.$.childNodes,a.C);this.O=this.L[a]};
yFc.prototype.Pa=function(a){var b=a.event instanceof fs?a.event.ym:a.event;this.H?(a.J.ez(b,!0),a.preventDefault()):(Sq(a.F,a.event.clientX,a.event.clientY),a=Tq(a.F),b=LF(this.R).C,yk(IL(b,"page",!1,!1)).contains(a)?(a=GL(b,a.x,a.y,"page"),(b=SE(qI(this.va),a.y,a.x))?a=new qk(b.jc(),b.kc()):b=Ek(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=LF(this.R),H(this.D),this.D=Cpc(a,b,"waffle-assistant-formula-insertion-rect"),this.Fa(this.D),vM(a.O,"default",this.D),H(this.F),this.F=UM(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.Fa(this.F),oob(this.F,"#000"),this.F.setVisible(!0))):zFc(this))};yFc.prototype.Ba=function(a){if(this.J){eN(LF(this.R),!1);var b=this.J,c=qI(this.va);b=new PK(c,b,this.O);this.Wa.C(b);this.dispatchEvent(new I("formula_inserted"))}a.J.ez(null,!0);a.preventDefault();this.O="";zFc(this)};function zFc(a){a.J=null;H(a.D);a.D=null;H(a.F);a.F=null};function AFc(){return U('<div class="waffle-assistant-answers-card-remove">'+T(bw({icon:"docs-icon-img docs-icon-trash"}))+"</div>")}
function BFc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+T(bw({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=T(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+T(b)+"</div>";
return U(a+"</div></div>")};function CFc(a){var b=U,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+DFc({zL:a.KA.zL}),d={JA:a.KA.JA,Wm:a.KA.Wm,interpretation:a.KA.interpretation,gL:a.KA.gL,$j:a.KA.$j,$w:a.KA.$w,Tpa:a.KA.Tpa,a8:a.KA.a8};!d.JA||za(d.JA);var e=d.JA;a=d.Wm;var f=d.gL,h=d.$j,k=d.$w,l=d.Tpa;za(d.a8);var m=d.a8;d=d||{};d=d.interpretation;d=""+('<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Ft("Answer")+'"><span aria-hidden="true">Answer</span></div>'+
(d?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+T(d)+"</div></div>":"")+"");var q='<div class="waffle-assistant-answercard-answer-container">'+U(d)+'<div class="waffle-assistant-answercard-answer-content">';if(e){if(!l)if(h&&(q+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
k)q+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{q+='<div class="waffle-assistant-answercard-answer">';if(f){q+='<div class="waffle-assistant-answercard-answer-rowheader">';l=e[0];d=l.length;for(var t=0;t<d;t++)q+='<span class="waffle-assistant-answercard-answer-col">'+T(l[t])+"</span>";q+="</div>"}q+='<div class="waffle-assistant-answercard-answer-rows">';l=Bt("waffle-assistant-answercard-answer-row"+(f?" waffle-assistant-answercard-answer-list-row":""));d=e.length;for(t=
0;t<d;t++){var w=e[t];if(f&&0==t)w="";else{var x=l;za(w);x='<div class="'+V(x)+'">';for(var z=w.length,B=0;B<z;B++){var L=w[B];x=L?x+('<span class="waffle-assistant-answercard-answer-col">'+T(L)+"</span>"):x+('<span class="'+V("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}w=U(x+"</div>")}q+=w}q+="</div></div>"}q+=h?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<m.length){q+='<div class="waffle-assistant-answercard-info-msgs">';e=m.length;for(f=0;f<e;f++)q+='<div class="waffle-assistant-answercard-info-msg">* '+T(m[f])+"</div>";q+="</div>"}q+='<div class="waffle-assistant-answercard-footer">';k&&(q+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT</div>');h&&(q+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');k||(q+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
T(bw({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+T(a)+"</div></div></div></div></div>");a=U(q+"</div></div></div>");return b(c+a+"</div></div>")}
function DFc(a){za(a.zL);a=a.zL;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Ft("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+V(e.className)+'">'+T(e.text)+"</span>":T(e.text)}return U(b+"</div></div></div>")}
function EFc(a){a=a.$w;return U(""+T(AFc())+(a?'<div class="waffle-assistant-button-separator"></div>'+T(Hu({vd:"waffle-assistant-zoom-button",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})):"")+"")};function FFc(a){this.C=a}function GFc(a,b){var c=new MX;D(c,3,b);D(c,8,ywa);b=new zU;bd(b,4,c);c=new Op;bd(c,46,b);c=uq(tq(new sq,10),c).build();a.C.Xb(2753,c)};function HFc(a,b){this.C=a;this.D=b;this.Kc=new Wk}function KEc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=IFc(a);c=JFc(e,c);(a=WBc(a.C,b,e,c.row,c.vj))&&d&&a.length<a[0].length&&(a=HCc(a));return a}function KFc(a,b){return(b=XBc(a.C,a.Kc,b))?a.Kc.fd((new kG).Na(),b):null}function LEc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function IFc(a){a=QF(a.D);return null!=a?a.toString():"0"}
function JFc(a,b){var c={row:0,vj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Lc()+1?c.row=b.Lc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Pc()+1&&(c.vj=b.Pc()+1));return c};function EY(a,b,c,d,e,f,h,k,l,m,q,t,w){eY.call(this,new hG,w);this.D=a;this.jh=gFc(a);this.jb=a.$j();this.bb=a.$w();this.Fi=q;this.$=this.C=this.Kb=null;this.Ab=a.$j()&&a.J;this.Wd=a.$;this.Ob=!1;this.Kf=b;this.qf=c;this.Je=d;this.Ei=l;this.Ih=h;this.R=e;this.Ug=f;this.xg=k;this.Me=m;this.gb=tq(new sq,10).build();this.Cd=new Au("",new XX,this.Aa());this.Qa(this.Cd);this.ih=t;this.wb=new Au("",new XX,this.Aa());this.Qa(this.wb);this.Yb=new Au("",new XX,this.Aa());this.Qa(this.Yb);this.va=null;this.O=
new Au("",new AW,this.Aa());this.Qa(this.O);this.H=a.va;this.cb=new Au("",new AW,this.Aa());this.Qa(this.cb);this.Db=new Au("",new XX,this.Aa());this.Qa(this.Db);this.L=new nV;this.Qa(this.L);this.Wa=new AM("");this.Qa(this.Wa);this.J=null;this.xc=lFc(this.D);this.hd=new xW(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Fa(this.hd);this.qd=!1}y(EY,eY);p=EY.prototype;p.Nha=g("xg");p.Ha=function(){EY.qa.Ha.call(this);hDc(this).appendChild(S(EFc,{$w:this.bb}))};
p.Ra=function(){EY.qa.Ra.call(this);var a=this.Za("waffle-assistant-answers-card-remove");this.Cd.kb(a);ZX(a,"Remove card",0);this.getHandler().Oc(this.Cd,"action",this.$Zb);if(this.D.$w()){a=qI(this.qf).fc();var b=this.D;b.$w();b=b.C?M(b.C,24):null;var c=KFc(this.ih,b);this.Kb=new rFc(c,b,this.Ei.L.C,this.Fi,a,this.Je)}else this.getHandler().V(this.O,"action",this.Uzb).V(this.cb,"action",this.srb).Oc(this.O,"action",this.KMa).Oc(this.cb,"action",this.vHb)};
function LFc(a){function b(b,d,e,f){var c=new lV("");c.kb(a.Za(b));a.L.Qa(c);a.getHandler().Oc(c,"action",v(a.sHb,a,d));f||c.setVisible(!1);e&&a.L.hH(c)}a.L.kb(a.Za("waffle-assistant-answercard-tabs"));a.getHandler().V(a.L,"select",a.mCb);b("waffle-assistant-answercard-formula-tab",0,!a.Ab,!a.bb);b("waffle-assistant-answercard-pivot-tab",1,!a.Ab,a.bb);b("waffle-assistant-answercard-chart-tab",2,a.Ab,!0)}
function MFc(a){var b=M(a.D.C,17);b=Te(b,1);for(var c=0;c<b.length;c++)a.Wa.Ed(NFc(b[c]));a.Wa.kb(a.Za("waffle-assistant-answercard-chart-type-select"));yv(a.Wa,NFc(a.D.F));b=a.Za("waffle-assistant-answercard-insert-chart");a.Db.kb(b);OFc(a);a.getHandler().V(a.Db,"action",a.XZb).V(a.Wa.wc(),"action",a.llb)}
p.lA=function(a){fY(this).appendChild(S(CFc,{KA:dFc(this.D)}));if(this.D.$w()){this.jb&&(LFc(this),MFc(this));var b=this.Za("waffle-assistant-answercard-insert-pivot");this.wb.kb(b);b=this.Za("waffle-assistant-zoom-button");this.Yb.kb(b);ZX(b,"Preview Pivot Table");this.getHandler().V(this.wb,"action",this.YZb).V(this.Yb,"action",this.ZZb);PFc(this);this.C=this.Aa().Ha("CANVAS","waffle-pivottable-pivot-canvas-border");b=this.Za("waffle-assistant-answercard-pivot-content");this.Aa().appendChild(b,
this.C);tFc(this.Kb,this.C)}else this.O.kb(this.Za("waffle-assistant-answercard-see-formula-link")),this.cb.kb(this.Za("waffle-assistant-answercard-hide-formula-link")),this.va=new yFc(this.Za("waffle-assistant-answercard-formula-text-container"),this.Kf,this.qf,this.Je),b=this.ud(),this.va.H=b,this.va.L=[this.D.Wm],this.Fa(this.va),b=this.Za("waffle-assistant-answercard-formula-text"),Or(b,"Formula: "+(this.D.Wm+". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Oc(this.va,
"formula_inserted",this.uHb).Zg(this.Za("waffle-assistant-answercard-formula-text"),Ie,this.Aqb),QFc(this,this.Me),RFc(this),this.Me&&(SFc(this,!0),this.getHandler().Gc(this.O,"action",this.KMa)),this.jb&&(this.Wd?(TFc(this,this.D.getChartType()),this.Ob=!0):LFc(this),MFc(this));a()};p.kM=function(){return this.jb&&!this.Wd&&!this.Ab};function NFc(a){if(a in BY)return new bt(BY[a].C,a);throw Error("Unknown chart type.");}
p.llb=function(a){a=a.target.hb();if(a in BY)TFc(this,BY[a].getChartType());else throw Error("Unknown chart type model.");};function UFc(a,b){a.H.F&&b.setOption("subtitle",a.H.F);b.setOption("hAxis.logScale",a.H.L);b.setOption("vAxis.logScale",a.H.O);a.H.C&&b.setOption("legend.position",a.H.C);a.H.H&&b.setOption("hAxis.formatOptions.scaleFactor",a.H.H);a.H.J&&b.setOption("vAxis.formatOptions.scaleFactor",a.H.J)}
function TFc(a,b){a.J=new YF;O(a.J,1,b);O(a.J,2,a.D.interpretation||"");if("Histogram"===b)b=fFc(a.D),O(a.J,3,b),O(a.J,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.xc.Wc(0)&&(b=a.xc.Pf(0),O(a.J,3,b),b=1),1==a.xc.getNumberOfColumns()-b?(b=a.xc.Pf(b),O(a.J,6,b)):O(a.J,6,"Values");else{b=a.J;var c=fFc(a.D);O(b,3,c);c=a.D;c.$j();O(b,6,c.H[0][1]||"")}b=yDc(a.J);b.$d(a.xc);c=a.Za("waffle-assistant-answercard-chart");b=zDc(b,c);jW(b,b.Fd());UFc(a,b);b.setOption("title",a.H.D);IW(b,
c,a.R,Fo);a.Ob=!0}p.YZb=function(){sFc(this.Kb);this.dispatchEvent("close-sidebar");this.R.C(35559,this.gb)};p.ZZb=function(){this.R.C(35587,this.gb);H(this.$);this.$=new DY(this.Kb,this.D.interpretation||"",this.R,this.gb,35588,this.Aa());this.$.render();this.Fa(this.$);xFc(this.$,this.ud())};
p.XZb=function(){if(this.J){var a=yDc(this.J);a.$d(this.xc);UFc(this,a);this.H.D&&a.setOption("title",this.H.D);jW(a,a.Fd());var b=this.Ba,c=this.xc,d=this.D.F,e=new UBc;D(e,1,d);d=new MX;bd(d,11,e);e=new zU;bd(e,4,d);d=new Op;bd(d,46,e);this.dispatchEvent(new ZCc(a,b,c,2874,void 0,void 0,d))}};p.dA=function(){Or(this.La,"Answer Card for question: "+this.D.D)};p.kA=Nh;p.Ry=n("assistantAnswersFeedback");p.AB=n(2628);p.zB=n(2627);p.U5=n("Was this answer correct?");p.Eia=n("Correct");p.Dia=n("Incorrect");
p.VM=g("D");p.mA=function(a){EY.qa.mA.call(this,a);this.va&&(this.va.H=a);this.$&&xFc(this.$,a);RFc(this);OFc(this);PFc(this)};p.Y0=function(){EY.qa.Y0.call(this);if(!this.qd){var a=this.hd,b=this.jh;zW(a);for(var c=0;c<b.length;c++)svc(a,b[c]);this.qd=!0}};p.uT=function(){EY.qa.uT.call(this);zW(this.hd);this.qd=!1};p.mCb=function(){switch(pV(this.L)){case 0:VFc(this,!1);break;case 1:VFc(this,!1);PFc(this);break;case 2:VFc(this,!0);PFc(this);break;default:pV(this.L)}};
function VFc(a,b){Q(a.Za("waffle-assistant-answercard-chart-container"),b);a.bb?Q(a.Za("waffle-assistant-answercard-pivot-content"),!b):(Q(a.Za("waffle-assistant-answercard-answer"),!b),Q(a.Za("waffle-assistant-answercard-formula-holder"),!b));OFc(a);!a.Ob&&b&&TFc(a,a.D.getChartType())}function RFc(a){var b=a.Cb("waffle-assistant-answercard-formula-help");b&&Q(b,!a.ud())}function OFc(a){var b=(a.Wd||2==pV(a.L))&&!a.ud();a.Db.setVisible(b)}
function PFc(a){var b=a.bb&&!a.ud()&&(!a.jb||1==pV(a.L));a.wb.setVisible(b)}function QFc(a,b){a.O.setVisible(!b);a.cb.setVisible(b);Q(a.Za("waffle-assistant-answercard-formula"),b);b?a.Za("waffle-assistant-answercard-formula-text").focus():(a.O.La.focus(),a.O.Qp(!0))}p.$Zb=function(){GFc(this.Ug,!0);this.dispatchEvent(new I("rc"))};p.Uzb=function(){QFc(this,!0)};p.srb=function(){QFc(this,!1)};p.KMa=function(){SFc(this,!0)};p.vHb=function(){SFc(this,!1)};
function SFc(a,b){var c=new MX;D(c,9,b);b=new zU;bd(b,4,c);c=new Op;bd(c,46,b);c=uq(tq(new sq,10),c).build();a.R.Xb(2849,c)}p.sHb=function(a){var b=this.D.R,c=new TBc;bd(c,1,b);switch(a){case 0:D(c,2,2);break;case 1:D(c,2,3);break;case 2:D(c,2,1);break;default:D(c,2,0)}a=new MX;bd(a,10,c);c=new zU;bd(c,4,a);a=new Op;bd(a,46,c);c=uq(tq(new sq,10),a).build();this.R.Xb(2850,c)};p.uHb=function(){this.R.Xb(2709,this.gb)};
p.Aqb=function(){var a=this.Aa().Nb(),b=a.createElement("textarea");b.textContent=this.D.Wm;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(WFc(this.Ih,"Formula copied to clipboard",this.Aa()),this.R.C(35534,this.gb))};function XFc(a){return U('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+T(DFc({zL:a.oDa.zL}))+T(BFc({error:a.oDa.error,showHelp:a.showHelp}))+"</div></div>")}function YFc(){return U('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function FY(a,b,c,d,e){eY.call(this,new hG,e);this.H=a;this.O=b;this.L=d;this.R=c;this.J=new Au("",new XX,this.Aa());this.Qa(this.J);this.C=new Au("",new AW,this.Aa());this.Qa(this.C);this.D=new Au("",new AW,this.Aa());this.Qa(this.D)}y(FY,eY);p=FY.prototype;p.dA=function(){Or(this.La,"Error Card for question: "+this.H.D)};p.Ry=n("assistantAnswersFeedback");p.kA=Nh;p.M7=Mh;p.Ha=function(){FY.qa.Ha.call(this);hDc(this).appendChild(S(AFc))};
p.Ra=function(){FY.qa.Ra.call(this);var a=this.Za("waffle-assistant-answers-card-remove");this.J.kb(a);this.D.setVisible(this.L);ZX(a,"Remove card",0);this.getHandler().Oc(this.J,"action",this.f_b).Oc(this.C,"action",this.fAb).V(this.D,"action",this.e_b)};
p.lA=function(a){fY(this).appendChild(S(XFc,{oDa:hFc(this.H),showHelp:this.L}));if(zo){var b=S(YFc);this.Aa().appendChild(this.La,b);this.C.kb(this.Za("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.kb(this.Za("waffle-assistant-answers-helpcenter-link"));a()};p.Nha=g("O");p.VM=g("H");p.fAb=function(){this.C.setVisible(!1);Q(this.Za("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new I("trigger_feedback"))};p.f_b=function(){GFc(this.R,!1);this.dispatchEvent(new I("rc"))};
p.e_b=function(){P.$n.mc()};function ZFc(a){eY.call(this,new hG,a);this.C=this.Aa().createElement("div");fo(this.C,"Previous")}y(ZFc,eY);p=ZFc.prototype;p.dA=function(){Or(this.La,"Previous questions below")};p.Ha=function(){ZFc.qa.Ha.call(this);Tr(this.La,"waffle-assistant-card");Rr(this.La,"waffle-assistant-answers-previousheadercard")};p.lA=function(a){0<this.Aa().Th(fY(this)).length||fY(this).appendChild(this.C);a()};p.M7=Mh;p.Ry=n("assistantAnswersFeedback");function $Fc(a){var b=""+(""+(a.O4?T(BFc({error:a.O4,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+T(a.title)+"</div>":""));var c=Bt("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.aA;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+V(c)+'">'+T(bw({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+T(f)+"</div></div></div>"}return U(b+"</div>")};function GY(a,b,c,d,e,f){eY.call(this,a,f);this.C=e||null;this.O=b;this.D=d;this.R=c;this.L=this.C?5==this.C.error:!1;this.H=new Au("",new AW,this.Aa());this.Qa(this.H);this.J=new Au("",new XX,this.Aa());this.Qa(this.J)}y(GY,eY);p=GY.prototype;p.Ha=function(){GY.qa.Ha.call(this);this.kA()&&hDc(this).appendChild(S(AFc))};
p.Ra=function(){GY.qa.Ra.call(this);Rr(this.La,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().V(this.H,"action",this.g_b);if(this.kA()){var a=this.Za("waffle-assistant-answers-card-remove");this.J.kb(a);ZX(a,"Remove card",0);this.getHandler().Oc(this.J,"action",this.h_b)}};p.AB=function(){return yb([aGc,bGc],this.D)?2799:yb([cGc,dGc],this.D)?2801:null};p.zB=function(){return yb([aGc,bGc],this.D)?2798:yb([cGc,dGc],this.D)?2800:null};p.U5=n("Were these interesting?");
p.Eia=n("Interesting");p.Dia=n("Not interesting");p.Ry=n("assistantAnswersFeedback");p.kA=function(){return this.C?!cFc(this.C):!1};p.dA=function(){var a=this.D.title;a&&this.C?Or(this.La,a+(" for question : "+this.C.D)):Or(this.La,"Suggested questions")};
p.lA=function(a){var b=this;this.R.then(function(c){if(b.Wb()){if(0==c.length)Q(b.La,!1);else{var d=b.Aa(),e=fY(b);if(0==d.Th(e).length){var f=S($Fc,{title:b.D.title,aA:rb(c,function(a){return a.query}),O4:b.C?iFc(b.C):"",showHelp:b.L});e.appendChild(f);var h=rb(c,function(a){return a.type});e=b.Ni("waffle-assistant-answercard-question-container");A(e,function(a,e){var f=new Au("",new XX,d);b.Qa(f);f.kb(a);b.getHandler().V(f,"action",v(b.XBb,b,c[e],h,e))});b.L&&b.H.kb(b.Za("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.h_b=function(){GFc(this.O,!1);this.dispatchEvent(new I("rc"))};p.XBb=function(a,b,c){this.dispatchEvent(new FCc(this.D.p0,a.Wm||null,b,c,this.D.uV,a.query))};p.g_b=function(){P.$n.mc()};var eGc={title:"",uV:0,p0:null},aGc={title:"",uV:5,p0:1},bGc={title:"Suggested questions",uV:5,p0:1},dGc={title:"Did you mean?",uV:2,p0:4},cGc={title:"Related questions",uV:4,p0:4};function HY(a,b,c,d,e,f,h,k,l,m,q,t,w,x){gY.call(this,x);this.Je=c;this.Wd=d;this.qf=e;this.Mc=a;this.jb=new OEc(this.Wd);this.gb=h;this.Ba=m;this.zf=q;this.Me=t;this.J=this.O=this.R=this.Kb=this.D=null;this.Ob="";this.Pa=new JCc;this.L=f;this.Wa=this.Vb=this.cb=this.F=null;this.bb=k;this.Cd=!1;this.Db=tq(new sq,10).build();this.Kc=new Wk;this.Ab=l;this.va={};this.qd=Td();this.wb="";this.Ia=null;this.Kf=w}y(HY,gY);p=HY.prototype;p.Ra=function(){HY.qa.Ra.call(this);this.kH(!this.F)};
p.Boa=function(a,b){HY.qa.Boa.call(this,a,b);b=this.Aa();var c=this.$;this.R=new YX(b);c.Qa(this.R,!0);b.appendChild(a,this.R.La);this.R.Ra();this.O=new RCc(this.R,this.L,this.Pa,10);c.Fa(this.O);c.getHandler().V(this.R,"answers-submit-query",v(this.b_b,this))};p.L3=function(){HY.qa.L3.call(this);this.O=this.R=null};
p.kH=function(a){var b=this;this.R&&this.R.setVisible(!a);a?(this.Ia&&this.Ia.dispose(),this.Ia=new mn(function(){HY.qa.kH.call(b,a)},300,this),this.Fa(this.Ia),this.Ia.start()):(this.Ia&&this.Ia.stop(),HY.qa.kH.call(this,a))};p.Yf=da("Kb");
function fGc(a,b,c,d,e,f,h){h=h?h:[];var k=k?k:[];a.jb.Ie(c,b,d,e,h,k);h=rb(Te(c,1),function(a){return a.getName()});var l=[],m=[];A(Te(c,2),function(a){l.push(a.getName());m=m.concat(Te(a,2))});KCc(a.Pa,h,l,m);a.Mc.n9().then(function(a){this.Pa.F=a;this.O&&(a=this.O,uo(a.O.Aa())==a.D&&a.KQa())},null,a);a.F=b;a.cb=d;a.Vb=e;a.Wa=c;a.Db=uq(tq(new sq,10),gGc(a)).build();if(f&&Ko)for(c=rb(a.C,function(a){if(a instanceof EY||a instanceof FY)return a.VM().D}),a.yV(),d=0;d<c.length;d++)if(e=c[d])f=new NX,
D(f,1,5),hGc(a,e,f);a.kH(!b)}p.reset=function(){OU(this.va);OU(this.Pa.D);var a=this.Pa;a.F=[];a.C.clear();this.J=null;this.KAa()};
function hGc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;var f=a.Ba.L.Tq();D(c,13,f);f=new MX;bd(f,5,c);XCc(a.O);if(!a.Kb||a.Kb.getStatus().getState().bl())if(a.va[b])iGc(a,b,!1);else{d=new CY(b,null,null,null,2,a.Ba);jGc(a,d,!0,f);return}else{var h=a.va[b];h&&h instanceof FY&&2==h.VM().error&&delete a.va[b]}if(b&&a.F)if(a.va[b])a.L.Xb(2681,a.Db),iGc(a,b,!0);else{h=gGc(a);var k=$c($c(h,zU,46),MX,4);D(k,2,e);e=uq(tq(new sq,10),h).build();a.L.Xb(2635,e);e=rE(a.F.rect);b=hn(km(jn(mm(nm(a.Kb.Le("/answers/parse").Df("q",
b,"qt",C(c,1),"gid",a.F.C,"range",e,"context",a.Ob),v(a.Hk,a,b,f)),v(a.a_b,a,b,f)),"POST"),2));Ko&&a.cb&&null!=a.Vb&&(c=0==a.cb.rect.width||0==a.cb.rect.height?"":rE(a.cb.rect),b.Df("headerRange",c,"tableRecordDimension",""+a.Vb));d&&b.Df("sgfml",d);b.ye();a.wb=Ud(a.qd,$l.tsa);kGc(a,!0)}else VCc(a.O,"")}function iGc(a,b,c){var d=a.va[b];d!=nb(a.C)&&(1<a.C.length&&lGc(a),c&&mGc(a,d.VM()).then(function(a){nGc(this,d,a)},null,a),rDc(a,d))}
p.b_b=function(a){var b=a.C;var c=a.Pa;var d=a.J,e=a.$;c?c=XEc(b,d,e,c):(c=new NX,D(c,1,b));hGc(this,a.O,c,a.F,a.L)};p.a_b=function(a,b){if(this.F){var c=C($c(b,NX,5),1);c=1==c||4==c?ZBc.exa:ZBc.Fxa;var d=gGc(this),e=$c($c(d,zU,46),MX,4);D(e,1,c);D(b,1,c);c=uq(tq(new sq,10),d).build();this.L.Xb(2640,c);oGc(this,a,b)}};function oGc(a,b,c){kGc(a,!1);b=new CY(b,null,null,null,3,a.Ba);jGc(a,b,!1,c);pGc(a)}
p.Hk=function(a,b,c){this.F&&this.bb.C.D.C.then(function(){var d=null,e=null,f=!1,h=$c(b,NX,5),k=C(h,1),l=gGc(this);k=1==k||4==k?ZBc.exa:ZBc.Fxa;var m=$c($c(l,zU,46),MX,4);D(m,1,k);D(b,1,k);k=uq(tq(new sq,10),l).build();if(c.Ik()){e=this.Kc.fd(UX.Na(),c.Xe());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.L.Xb(q,k)}q=M(e,10);D(h,4,q);q=M(e,11);D(h,5,q);Oe(e,16)&&(q=M(e,16),D(h,16,q));if(1==
f){oGc(this,a,b);return}if(2==f){e=-1!=qGc(a);h=-1!=WEc(a);f=4;d=$c(b,NX,5);e?(f=5,D(d,8,2)):h&&(f=7,D(d,8,1));h=new CY(a,null,null,null,f,this.Ba);e?(e=new FY(h,!0,this.Ab,!0,this.Aa()),rGc(this,h,e,b)):jGc(this,h,!0,b);kGc(this,!1);pGc(this);return}l=Oe(e,2)?M(e,2):null;f=!0;if(l){q="";d=KEc(this.bb,l,this.F,!!this.Wa&&!!M(this.Wa,4));D(h,14,!!d);if(!d){if(m=l.match(/([A-Z]*)\(/)){var t=$c($c(aCa(k),zU,46),MX,4);D(t,7,m[1]);D(b,7,m[1])}this.L.Xb(2645,k)}d&&LEc(d)||(q=this.bb,t=this.F,k="="!=l[0]?
"="+l:l,m=IFc(q),t=JFc(m,t),q=qMb(q.C,k,m,t.row,t.vj));k=Oe(e,19)?KEc(this.bb,M(e,19)||"",this.F,!!this.Wa&&!!M(this.Wa,4)):d;d=new CY(a,d,"="!=l[0]?"="+l:l,e,null,this.Ba,k);if(Oe(e,23)&&d.$j()){if(Oe(e,17)&&Oe(M(e,17),5)){k=M(M(e,17),5);l=d.va;if(Oe(k,5))switch(M(k,5).getPosition()){case 1:l.C="right";break;case 2:l.C="left";break;case 3:l.C="top";break;case 4:l.C="bottom"}Oe(k,1)&&Oe(M(k,1),1)&&Oe(M(M(k,1),1),1)&&1==M(M(M(k,1),1),1)&&(l.L=!0);Oe(k,2)&&Oe(M(k,2),1)&&Oe(M(M(k,2),1),1)&&1==M(M(M(k,
2),1),1)&&(l.O=!0);Oe(k,1)&&Oe(M(k,1),1)&&Oe(M(M(k,1),1),2)&&(m=M(M(M(k,1),1),2),l.H=m);Oe(k,2)&&Oe(M(k,2),1)&&Oe(M(M(k,2),1),2)&&(m=M(M(M(k,2),1),2),l.J=m);Oe(k,3)&&(m=M(M(k,3),1),l.D=m);Oe(k,4)&&(k=M(M(k,4),1),l.F=k)}this.Ob=Ue(e,23)}else this.Ob="";q&&d.L.push(q);d.$j()&&bd(h,15,d.R)}else Oe(e,9)&&(q=e.getError(),d=new CY(a,null,null,e||null,6,this.Ba),l=M(q,2),D(h,6,l),Oe(q,3)&&(q=M(q,3),D(h,12,q)))}else this.L.Xb(2640,k);d||(d=new CY(a,null,null,e||null,4,this.Ba));kGc(this,!1);cFc(d)?sGc(this,
d,f,b):jGc(this,d,f,b);pGc(this)},function(){oGc(this,a,b)},this)};function pGc(a){""!=a.wb&&(Vd(a.qd,a.wb),a.wb="")}function tGc(a){if(null!=a.Wm)return cGc;switch(a.error){case 4:case 6:return 0<a.O.length?dGc:bGc;case 5:return bGc}return eGc}function gGc(a){var b=new MX;D(b,8,ywa);var c=new zU;bd(c,4,b);a=CDc(a.F);bd(a,46,c);return a}function qGc(a){return xb(UEc,function(b){return Ma(a,b)})}
function uGc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=M(b[d],2),f=!!a.Wa&&!!M(a.Wa,4);e=KEc(a.bb,e,a.F,f);LEc(e)&&(e={query:M(b[d],1),Wm:M(b[d],2),type:b[d].getType()},Oe(b[d],5)&&(e.fEa=M(b[d],5)),c.push(e))}return Wh(c)}function sGc(a,b,c,d){c=new EY(b,a.Je,a.Wd,a.qf,a.L,a.Ab,a.gb,c,a.Ba,a.Cd,a.Kf,a.bb,a.Aa());rGc(a,b,c,d)}
function vGc(a,b,c){if(a.D&&a.D.isVisible())ON(a.D);else{var d=a.zf.D.C["ritz-ap"]||null;c.kM()&&(a.D=Gvb(a.Me,a.Aa(),d,void 0,"answersChartsPromo"),a.D&&(a.D.show(),a.Fa(a.D),a.getHandler().Oc(a,"Md",a.KAa)));b.$j()&&q9a(d,"answersChartsPromo")}}p.jba=function(){HY.qa.jba.call(this);this.D&&this.D.isVisible()&&this.D.C.kd()};p.KAa=function(){this.D&&this.D.isVisible()&&ON(this.D)};function jGc(a,b,c,d){c=new FY(b,c,a.Ab,!1,a.Aa());rGc(a,b,c,d)}
function rGc(a,b,c,d){lGc(a);var e=mGc(a,b,d);wGc(a,c);c instanceof EY&&vGc(a,b,c);xGc(a);cFc(b)&&LCc(a.Pa,b.D);e.then(function(a){if(d){var b=gGc(this),e=$c(b,zU,46);bd(e,4,d);b=uq(tq(new sq,10),b).build();this.L.Xb(2781,b)}nGc(this,c,a)},null,a);c.Nha()&&(a.va[b.D]=c);a.getHandler().V(c,"rc",a.LJa)}function nGc(a,b,c){b instanceof FY&&c&&gr(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().V(c,"rc",a.LJa))}
function lGc(a){yGc(a);A(a.C,function(a){a instanceof FY&&(a=a.getElement(),Q(a,!0))});zGc(a)}function zGc(a){0!=a.C.length&&(a.J?rDc(a,a.J):(a.J=new ZFc(a.Aa()),wGc(a,a.J)))}function yGc(a){A(a.C,function(b){b instanceof EY||b instanceof FY||b==a.J||a.WG(b)})}function AGc(a,b){var c=Wh([]);b=b.Ia;0<b.length&&(c=REc(a.jb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?AEc(a.Mc,c).then(function(a){return Hb(b,a)}):Wh(b)})}
function mGc(a,b,c){var d=tGc(b),e=null;d==cGc||d==dGc?0<b.O.length&&(e=uGc(a,b)):d==bGc&&(e=AGc(a,b));var f=null;return e?(f=new GY(new hG,a.Ab,e,d,b,a.Aa()),wGc(a,f),a.L.Xb(2769,a.Db),a.getHandler().V(f,"sqc",v(a.WBb,a)),e.then(function(a){if(c){var b=$c(c,NX,5);yb([cGc,dGc],f.D)?(a=ZEc(a),bd(b,7,a)):yb([aGc,bGc],f.D)&&(a=$Ec(a),bd(b,9,a))}return f},null,a)):Wh(f)}p.WBb=function(a){VCc(this.O,a.F,!0);var b=a.O;b=1==b?XEc(b,a.C,a.J,3):YEc(b,a.C,a.J,a.$);hGc(this,a.F,b,a.L);this.L.Xb(2762,this.Db)};
function kGc(a,b){a=a.R;Q(a.H,b);Q(a.Aa().Za("waffle-assistant-answers-button-container",a.C),!b);uW(a.F,b)}function wGc(a,b){b.mA(a.ud());a.C.push(b);if(a.Yb){qDc(a,!1);var c=a.H.Vc();b.Ba=c;a.H.vh(b,0,!0);b.UI()}jDc(b,!0)}function xGc(a){for(var b=a.C;5<b.length;)a.WG(b[0])}p.yV=function(){HY.qa.yV.call(this);this.reset()};
p.LJa=function(a){var b=this,c=this.Aa();a=a.target;if(a instanceof EY)this.WG(a),WFc(this.gb,"Answer removed",c,v(this.Oyb,this,a));else if(a instanceof FY)this.WG(a),WFc(this.gb,"Card removed",c);else if(a instanceof GY&&a.C&&!cFc(a.C)){var d=a.C.D;A(this.C,function(a){a instanceof FY&&a.VM().D==d&&(b.WG(a),WFc(b.gb,"Card removed",c))})}a=this.C;!this.J||a[0]!=this.J&&a[a.length-1]!=this.J||(this.WG(this.J),this.J=null)};
p.Oyb=function(a){sGc(this,a.VM(),a.Nha());WFc(this.gb,"Remove answer undone",this.Aa())};p.WG=function(a){if(a.Wb()){if(a instanceof EY||a instanceof FY)delete this.va[a.VM().D],a==nb(this.C)&&yGc(this);HY.qa.WG.call(this,a)}H(a)};function BGc(){var a=""+(""+U('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
T(bw({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Ft("Ask a question about your data")+'"/></div></form></div>');return U(a)};function IY(a,b,c,d,e,f,h,k,l,m,q){hY.call(this,1,f,e,q);this.Ab=c;this.Pa=null;this.Ba=new Au("",new AW,this.Aa());this.Qa(this.Ba);this.Wa=new Au("",new AW,this.Aa());this.Qa(this.Wa);a=new oMb(a,!0,!0);a=new HFc(a,c);this.jb=new FFc(e);this.O=new GEc(this.Ab,a,e);this.L=new HY(this.O,0,b,c,d,e,this.ib,a,this.jb,h,k,l,m,q);c=CGc;this.D=new xW(b,c.cca,c.dca);this.Fa(this.D);this.F=this.H=null;this.wb=tq(new sq,10).build();this.Ia=!1}y(IY,hY);
var CGc={cca:"waffle-assistant-answers-styled-border",dca:"waffle-assistant-answers-styled-rect",OYa:"waffle-assistant-answers-input-box",z_a:"waffle-assistant-answers-query-box",ntc:"waffle-assistant-answers-query-box-focused",dZa:"waffle-assistant-answers-learn-more",Dnc:"waffle-assistant-answers-logging-message-container",XZa:"waffle-assistant-answers-logging-opt-out"};p=IY.prototype;p.Ha=function(){IY.qa.Ha.call(this);var a=S(BGc);this.Aa().appendChild(tDc(this),a)};
p.Ra=function(){IY.qa.Ra.call(this);var a=CGc,b=this.Za(a.z_a),c=this.Za(a.OYa);this.Wa.kb(this.Za(a.XZa));this.Ba.kb(this.Za(a.dZa));this.getHandler().V(b,"focus",this.fyb,!0).V(b,"blur",this.dyb,!0).V(b,"mouseover",this.hyb).V(b,"mouseout",this.gyb).V(b,"click",this.eyb).V(c,"input",this.c_b).V(this.Wa,"action",this.qwb).V(this.Ba,"action",this.Zsb).V(QC(this.Ab),"Ca",Qpc(this.d_b,25,this));this.setVisible(!!this.H);DGc(this,gwa&&jwa&&Lo("showAnswersLoggingOptOut"))};p.Ipa=Mh;p.CKa=Nh;p.Epa=Mh;
p.XM=n("Answers");p.Z0=n(1);p.pV=function(a){return 3==a||0==a||1==a};p.WM=function(a,b){Ob(a,function(a,b){return M(b,2)-M(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Ue(a[f],1);3==h?e=a[f]:0==h?c.push(M(a[f],8)):1==h&&d.push(a[f])}if(e&&M(e,2)){f=b||null;h=Oe(e,11)?M(e,11):null;var k=null==h?null:xU(M(e,10));0<Pe(e,4)?EGc(this,xU(CU(e)),M(e,9),k,h,c,d):EGc(this,f,M(e,9),k,h,c,d);this.F||(IY.qa.WM.call(this,a,b),this.getHandler().V(this.F,"sqc",this.VBb))}else this.vT(!0)};
p.qO=function(a){if(!this.F){var b=AEc(this.O,3);this.F=new GY(a,this.jb,b,aGc,void 0,this.Aa())}return this.F};p.hAa=g("L");p.Zka=function(){return this.isVisible()};
p.vT=function(a,b,c){this.O.reset();(a||b)&&this.F&&(IY.qa.vT.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(IY.qa.vT.call(this,a,b,c),this.F.dispose(),this.F=null),this.Wb()&&(this.O.reset(),this.H=null,a=this.L,a.Wb()&&(b=a.Pa,b.F=[],b.C.clear(),a.O&&(b=a.O,b.O.Wb()&&(ECc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.yV(),a.jb.reset(),a.F=null,a.kH(!0)),this.setVisible(!1),this.Tb()&&zW(this.D));c&&this.L.reset()};p.Yf=function(a){this.Pa=a;this.L.Yf(a);this.O.Yf(a)};
p.$0=function(a){IY.qa.$0.call(this,a);a?yW(this.D,this.H):zW(this.D)};function FGc(a,b){a.Tb()&&(b?zW(a.D):yW(a.D,a.H))}function DGc(a,b){Q(a.Za("waffle-assistant-answers-logging-message-container"),b)}function GGc(a,b){a=a.Za("waffle-assistant-answers-query-box");Vr(a,"waffle-assistant-answers-query-box-focused",b)}p.d_b=function(){this.Tb()&&yW(this.D,this.H)};p.fyb=function(){GGc(this,!0);yW(this.D,this.H)};p.dyb=function(){GGc(this,!1);this.Tb()||zW(this.D)};p.hyb=function(){yW(this.D,this.H)};
p.gyb=function(){this.Tb()||zW(this.D)};p.eyb=function(){HGc(this,"")};p.c_b=function(){var a=this.Za("waffle-assistant-answers-input-box");HGc(this,a.value);a.value=""};p.VBb=function(a){var b=this,c=a.F;HGc(this,c);var d=XEc(1,a.C,a.J,1),e=new mn(function(){hGc(b.L,c,d,a.L)},300);this.Fa(e);e.start();this.R.Xb(2652,this.wb)};function HGc(a,b,c){a.$0(!0);a.dispatchEvent("Rd");IGc(a,b,c)}
function IGc(a,b,c){c=void 0===c?!1:c;var d=new mn(function(){VCc(a.L.O,b,!0);var d=a.L,f=c||!1;d.Cd=f;d.Mc.$=f;d.jb.$=f},300);a.Fa(d);d.start()}function EGc(a,b,c,d,e,f,h){c=c||new bG;a.H=b;a.O.Ie(c,b,d,e,f,h);a.O.m9();a.setVisible(!!b);fGc(a.L,b,c,d,e,a.Ia,f);a.Ia=!1;a.Tb()&&yW(a.D,a.H)}p.qwb=function(a){a.stopPropagation();a.preventDefault();this.Pa&&(jn(mm(nm(this.Pa.Le("/answers/logoptout"),v(this.Htb,this)),v(this.Gtb,this)),"POST").ye(),this.R.Xb(2663,this.wb))};
p.Zsb=function(a){a.stopPropagation();a.preventDefault();tr("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.Htb=function(a){a.Ik()&&DGc(this,!1)};p.Gtb=ba();function JY(a,b,c,d){gw.call(this,a,b,c,d,void 0,void 0,!0)}y(JY,gw);JY.prototype.Ha=function(){JY.qa.Ha.call(this);Rr(this.La,"waffle-assistant-toast");Rr(this.Za("docs-ui-toast-content"),"waffle-assistant-toast-content")};JY.prototype.HA=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=pr(this,b);JY.qa.HA.call(this,a,b,c)};JY.prototype.Jh=function(a,b,c,d){this.HA(a,b,d);a=rr(this,b);this.getHandler().Zg(a,Ie,v(function(){this.setVisible(!1);c()},this))};function JGc(){this.C=null}y(JGc,G);JGc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function WFc(a,b,c,d){a.clear();a.C=new JY(b,c,!1,5E3);a.C.render();d&&a.C.Jh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}JGc.prototype.Oa=function(){JGc.qa.Oa.call(this);this.clear()};function KGc(){var a=U;var b=""+T(Hu({vd:"waffle-assistant-datavalidation-apply-button",content:Bt("Apply"),style:4}));b=U(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function LGc(a){return U('<div class="waffle-assistant-datavalidation-detail-chip">'+T(a.u5a)+"</div>")};function MGc(a,b,c,d){eY.call(this,a,d);this.D=new xW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.Fa(this.D);this.C=new Iu("",this.Aa());this.Qa(this.C);this.H=CU(a);this.J=c}r(MGc,eY);p=MGc.prototype;p.Ha=function(){eY.prototype.Ha.call(this);fY(this).appendChild(S(KGc))};
p.Ra=function(){eY.prototype.Ra.call(this);var a=this.Za("waffle-assistant-datavalidation-apply-button");this.C.kb(a);ZX(a,"Apply data validation");this.getHandler().V(this.C,"action",this.ujb).V(this.La,"mouseenter",this.oIb).V(this.La,"mouseleave",this.pIb);a=new Qp;$oc(a,tvc(Kf(M(M(this.F,13),3))));var b=new Op;bd(b,58,a);a=uq(tq(new sq,10),b).build();this.J.C(35577,a)};
p.lA=function(a){var b=rE(gl(this.H)),c=M(M(this.F,13),3);switch(Kf(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Te(c,2).map(function(a){return M(M(a,5).$a(),2)});break;case 1:d="Numeric validation";c=["Greater than "+M(M(Te(c,2)[0],5).$a(),3)];break;case 7:d="Numeric validation";c=Te(c,2);c=["Between "+(M(M(c[0],5).$a(),3)+(" and "+M(M(c[1],5).$a(),
3)))];break;default:d="unrecognized",c=[]}var e=new ex,f=e.text(d)+(" for "+(e.Qe("SPAN".toString(),{hE:"waffle-assistant-datavalidation-range"})+e.text(b)+e.Re("SPAN".toString())));Ji(this.Za("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Za("waffle-assistant-datavalidation-details");A(c,function(a){a=S(LGc,{u5a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));Or(this.La,b);a()};p.dA=ba();p.Ry=n("assistantDataValidationFeedback");
p.AB=n(35551);p.zB=n(35550);p.ujb=function(){this.dispatchEvent(new cY("Ld",this,35549))};p.oIb=function(){yW(this.D,xU(this.H))};p.pIb=function(){zW(this.D)};function NGc(a,b,c,d){hY.call(this,3,b,a,d);this.D=c}r(NGc,hY);p=NGc.prototype;p.XM=n("Data Validation");p.pV=function(a){return 6==a};p.qO=function(a){var b=M(a,1);switch(b){case 6:return new MGc(a,this.D,this.R,this.Aa());default:throw Error("Unsupported recommendation type: "+b);}};p.YM=function(a){hY.prototype.YM.call(this,a);this.setVisible(!a)};p.$M=function(a){return this.ud()?(this.setVisible(!1),a):hY.prototype.$M.call(this,a)};p.Z0=n(4);p.Ipa=n(!1);function OGc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+PGc()+"</div>");return U(a)}
function QGc(){return U('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+PGc()+"</div>")}function PGc(){var a=""+T(Hu({vd:"waffle-assistant-formatting-edit-button",content:Bt("Edit"),style:4}));return U(a)};function RGc(a,b,c){eY.call(this,a,c);a=rb(Te(this.F,7),urc);this.C=new zrc(!1,a,7);this.Qa(this.C);this.J=new Iu("",this.Aa());this.Qa(this.J);this.L=b;this.H=!1;this.D=-1}y(RGc,eY);var SGc={zWa:"waffle-assistant-banding-color-picker-container",Uba:"waffle-assistant-formatting-edit-button",$H:"waffle-assistant-banding-range"};p=RGc.prototype;p.Ha=function(){RGc.qa.Ha.call(this);fY(this).appendChild(S(OGc))};
p.Ra=function(){RGc.qa.Ra.call(this);this.getHandler().V(this.J,"action",this.Uob).V(this.C,"kd",this.Zjb);this.L.C(2768)};p.lA=function(a){var b=this.Za(SGc.zWa);this.C.render(b);Arc(this.C);b=this.Za(SGc.$H);var c=CU(this.F),d=gl(c);fo(b,rE(d));TGc(this,c);b=this.Za(SGc.Uba);this.J.kb(b);a()};p.dA=function(){Or(this.La,"Suggested alternating background colors");Ls(this.C,"Choose a color scheme")};p.Ry=n("assistantBandingFeedback");p.AB=n(2672);p.zB=n(2671);
p.Uob=function(a){xA.dispatchEvent({type:"show-banding-pane-recommendation",qQa:this.F,a5a:Crc(this.C)});a.stopPropagation()};p.Zjb=function(a){if(!this.H&&Brc(this.C)){var b=this.D;this.D=this.C.bh();this.D==b?this.dispatchEvent(new cY("Qd",this,2797)):this.dispatchEvent(new cY("Jd",this,2673));a.stopPropagation()}};
function TGc(a,b){a.H=!0;var c=b.Jb();b=gl(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.kc(),b.jc(),b.Lc(),b.Pc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Wk).fd(kf.Na(),c),c=urc(c)):c=null;c?(c=Drc(a.C,c),$N(a.C,c?c.getElement():null)):$N(a.C,null);a.D=a.C.bh();a.H=!1};function UGc(a,b){eY.call(this,a,b);this.C=new Iu("",this.Aa());this.Qa(this.C);this.vc=Te(a,6)}y(UGc,eY);var KY={Uba:"waffle-assistant-formatting-edit-button",oYa:"waffle-assistant-conditionalformat-format-preview",W_a:"waffle-assistant-conditionalformat-rule-holder",jN:"waffle-assistant-conditionalformat-description",UZa:"one-rule",i1a:"two-rules",W0a:"three-rules",v_a:"waffle-assistant-conditionalformat-format-preview-label"};p=UGc.prototype;p.Ha=function(){UGc.qa.Ha.call(this);fY(this).appendChild(S(QGc))};
p.Ra=function(){UGc.qa.Ra.call(this);var a=this.Za(KY.Uba);this.C.kb(a);ZX(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.sjb)};p.lA=function(a){fo(this.Za(KY.jN),Ue(this.F,3));var b=this.Za(KY.W_a),c=new VGc(this,this.Aa());this.Qa(c);c.kb(b);ZX(b,"Apply conditional format rules");a()};p.dA=ta;p.Ry=n("assistantConditionalFormatFeedback");p.AB=n(2630);p.zB=n(2629);
p.sjb=function(){this.dispatchEvent(new cY("Kd",this,2563));this.dispatchEvent(new cY("Nd",this,2670,void 0,void 0,gl(M(this.vc[0],1,0))));zRa()};function VGc(a,b){Js.call(this,void 0,void 0,b);this.C=a}y(VGc,Js);
VGc.prototype.jd=function(a){VGc.qa.jd.call(this,a);var b=this.C.vc;switch(b.length){case 0:break;case 1:var c=KY.UZa;break;case 2:case 4:c=KY.i1a;break;default:c=KY.W0a}for(var d=0;d<b.length;d++){var e=b[d],f=Jn("DIV");Sr(f,[KY.oYa,c]);var h=Jn("DIV");Rr(h,KY.v_a);f.appendChild(h);fo(h,"123");if(Oe(e,2)){var k=M(M(e,2),1);switch(Kf(M(k,1))){case 9:case 13:k=Te(M(k,1),2)[0];var l=Te(e,1)[0];fo(h,UD(k,Ue(l,1),Ue(l,2),Ue(l,4)))}}Kqc(e,f);a.appendChild(f)}};
VGc.prototype.Hh=function(){var a=this.C;a.dispatchEvent(new cY("Kd",a,2563));return!0};function WGc(a,b,c){hY.call(this,2,b,a,c)}y(WGc,hY);p=WGc.prototype;p.XM=n("Formatting");p.pV=function(a){return 2==a||4==a};p.qO=function(a){var b=M(a,1);switch(b){case 2:return new UGc(a,this.Aa());case 4:return a=new RGc(a,this.R,this.Aa()),this.getHandler().V(a,"Jd",this.kSb).V(a,"Qd",this.REb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.kSb=function(a){WFc(this.ib,"Alternating colors applied",this.Aa(),v(this.$jb,this,a.C))};p.REb=function(){this.ib.clear()};
p.$jb=function(a){this.dispatchEvent(new cY("Vd",a,2796))};p.YM=function(a){WGc.qa.YM.call(this,a);this.setVisible(!a)};p.$M=function(a){return this.ud()?(this.setVisible(!1),a):WGc.qa.$M.call(this,a)};p.Z0=n(3);function XGc(a,b,c,d,e,f,h,k,l,m){eY.call(this,k,m);this.bb=b;this.cb=c;this.va=d;this.gb=l;this.O=e;this.$=f;this.H=new Au("",new XX,this.Aa());this.Qa(this.H);this.R=new Au("",new XX,this.Aa());this.Qa(this.R);this.J=this.D=null;this.C=Jn("CANVAS","waffle-pivottable-pivot-canvas-border");this.Wa=this.cb.L.C;this.L=tq(new sq,10).build()}r(XGc,eY);p=XGc.prototype;p.kA=n(!0);p.Ha=function(){eY.prototype.Ha.call(this);fY(this).appendChild(S(uFc));hDc(this).appendChild(S(vFc))};
p.Ra=function(){eY.prototype.Ra.call(this);var a=M(this.F,5),b=KFc(this.$,a),c=qI(this.bb).fc();this.J=new rFc(b,a,this.Wa,this.gb,c,this.va);a=this.Za("waffle-assistant-insert-pivottable-button");this.H.kb(a);ZX(a,"Insert Pivot Table");a=this.Za("waffle-assistant-zoom-button");this.R.kb(a);ZX(a,"Preview Pivot Table");this.getHandler().V(this.H,"action",this.qIb).V(this.R,"action",this.rIb)};
p.lA=function(a){fo(this.Za("waffle-assistant-answercard-interpret"),Ue(this.F,3));this.C=Jn("CANVAS","waffle-pivottable-pivot-canvas-border");this.Za("waffle-assistant-answercard-pivot-content").appendChild(this.C);tFc(this.J,this.C);a()};p.mA=function(a){eY.prototype.mA.call(this,a);this.H&&this.H.setVisible(!a);this.D&&xFc(this.D,this.ud())};p.dA=function(){Or(this.La,"Suggested Pivot Table")};p.Ry=n("assistantPivotTableFeedback");p.AB=n(2632);p.zB=n(2631);
p.qIb=function(){sFc(this.J);this.dispatchEvent("close-sidebar");this.O.C(35589,this.L)};p.rIb=function(){this.O.C(35590,this.L);H(this.D);this.D=new DY(this.J,Ue(this.F,3),this.O,this.L,35591,this.Aa());this.D.render();this.Fa(this.D);xFc(this.D,this.ud())};function YGc(a,b,c,d,e,f,h,k){hY.call(this,1,f,e,k);this.H=d;this.D=b;this.L=c;this.O=h;tq(new sq,10).build();a=new oMb(a,!0,!0);this.F=new HFc(a,this.D)}r(YGc,hY);p=YGc.prototype;p.XM=n("Pivot Table");p.pV=function(a){return 1==a};p.qO=function(a){var b=M(a,1);switch(b){case 1:return new XGc(0,this.D,this.L,this.H,this.R,this.F,0,a,this.O,this.Aa());default:throw Error("Unsupported recommendation type: "+b);}};p.WM=function(a,b){M(a[0],5)&&hY.prototype.WM.call(this,a,b)};
p.$M=function(a){return this.ud()?(this.setVisible(!1),a):hY.prototype.$M.call(this,a)};p.Z0=n(5);function LY(a,b,c,d,e){R.call(this);this.O=a;this.cb=b;this.va=c;this.H=d;this.D=e}r(LY,R);LY.prototype.getTableRange=g("va");LY.prototype.o9=function(a,b,c){this.va=a;this.H=b;this.D=c};LY.prototype.Ra=function(){R.prototype.Ra.call(this);this.getHandler().V(this.O.C,"K",this.gb)};LY.prototype.gb=function(){this.cb.mc()};function ZGc(a,b){G.call(this);this.F=a;this.H=b;this.C=new xW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Fa(this.C);this.D=new xW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Fa(this.D)}r(ZGc,G);ZGc.prototype.Oa=function(){zW(this.C);zW(this.D);G.prototype.Oa.call(this)};
function $Gc(a,b,c,d,e,f){BJ(b);var h=gl(d);h=new Bk(h.kc(),h.jc(),Math.min(h.Lc(),h.kc()+6),Math.min(h.Pc(),h.jc()+6));var k=AJ(b),l=LF(a.F).C,m=l.vg(new he(h.kc(),h.Lc()),"r",!0,!1,!0,!0)-1,q=l.vg(new he(h.jc(),h.Pc()),"c",!0,!1,!0,!0)-1;l.Zb()&&--q;m=Math.min(200,m);q=Math.min(c.offsetWidth-2,q);CJ(b,k,q,m);c=ADc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.kc();k=d.jc();switch(e){case 0:h=Math.min(d.Lc(),d.kc()+f);break;case 1:k=Math.min(d.Pc(),d.jc()+f)}d=Yk(d.Jb(),h,k,d.Lc(),d.Pc());yW(b,xU(d));yW(a.D,
xU(c))};function aHc(a){var b=a.GPa,c=a.FPa,d=a.eOa;a=a.aza;return U('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+V(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+T(b)+'</div></div><div class="waffle-tables-popup-content">'+T(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
T(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+T(a)+"</div></div></div></div>")}
function bHc(){var a=""+(""+aHc({GPa:Bt("Edit data range"),FPa:Ct(""+U('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>')),eOa:Bt("Update"),
aza:Bt("Cancel")})+"");return U(a)}function cHc(){var a=""+(""+aHc({GPa:Bt("Improve suggestions"),FPa:Ct('<div class="waffle-tables-popup-header-message"></div>'),eOa:Bt("No"),aza:Bt("Yes")})+"");return U(a)}function dHc(a){a='For <span class="waffle-assistant-table-bar-range">'+(T(a.pH)+"</span>");return U(""+(""+a+""))}
function eHc(a){a='Is <span class="waffle-assistant-table-first-header">'+(T(a.JK)+"</span> a header row, containing titles that describe the columns below?");return U(""+(""+a+""))};function fHc(a,b,c,d,e,f,h){LY.call(this,a,WQa,d,e,f);this.C=(new JQ).build();this.Fa(this.C);this.J=new Au("",new XX,this.Aa());this.Qa(this.J);ow(this.C,this.J,XQa);this.F=new Au("",new XX,this.Aa());this.Qa(this.F);ow(this.C,this.F,WQa);this.R=new ZGc(b,c);this.Fa(this.R);this.L=new Rp(this);this.Fa(this.L);this.Ba=h}r(fHc,LY);fHc.prototype.Ha=function(){this.La=S(cHc)};
fHc.prototype.Ra=function(){LY.prototype.Ra.call(this);this.J.kb(this.Za("waffle-tables-popup-done"));this.F.kb(this.Za("waffle-tables-popup-cancel"));var a=ADc(this.getTableRange(),this.D,1);a=rE(gl(a));a=S(eHc,{JK:a});this.Za("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(XQa,"action",this.Ia).subscribe(WQa,"action",this.$);a=this.Za("waffle-assistant-table-canvas");var b=this.Za("waffle-assistant-canvas-container");$Gc(this.R,a,b,this.getTableRange(),this.D,this.H);a=this.Za("waffle-tables-popup");
Vr(a,"waffle-tables-popup-answers-enabled",this.Ba);b=new bM(a,this.Aa());this.Fa(b);cM(b);a.focus()};fHc.prototype.$=function(){this.dispatchEvent("Td")};fHc.prototype.Ia=function(){var a=gl(this.getTableRange());switch(this.D){case 0:a=zoa(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=zoa(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=rE(a);this.dispatchEvent(new $Cc(a,this.H-1,this.D));this.dispatchEvent("Td")};function gHc(a,b,c,d,e,f,h,k,l){LY.call(this,a,fA,d,e,f);var m=this;this.ib=b;this.bb=d;this.Ab=e;this.Db=f;a=gl(d);this.F=rE(a);this.Wa=new ZGc(b,c);this.Fa(this.Wa);this.C=null;this.Ba=h;this.J=(new JQ).build();this.Fa(this.J);this.$=new Au("",new XX,this.Aa());this.Qa(this.$);ow(this.J,this.$,UQa);this.R=new Au("",new XX,this.Aa());this.Qa(this.R);ow(this.J,this.R,fA);b=this.O.C.C.ue();this.L=new qV(this.ib,function(a,b,c){hHc(m,a,b,c)},!1,"e.g., A2:D5",!0,b,this.Aa());this.Qa(this.L);this.Ia=
null;this.Pa=new Rp(this);this.Fa(this.Pa);this.jb=k;this.wb=l}r(gHc,LY);p=gHc.prototype;p.Ha=function(){this.La=S(bHc)};
p.Ra=function(){LY.prototype.Ra.call(this);this.$.kb(this.Za("waffle-tables-popup-done"));this.R.kb(this.Za("waffle-tables-popup-cancel"));this.L.render(this.Za("waffle-assistant-tables-data-range-wrapper"));var a=this.Za("waffle-range-selection-input");Lr(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().V(a,"keydown",this.sIb).V(a,"keyup",this.tIb).V(a,gga,this.tCb).V(this.L,"change",this.uIb);this.Pa.subscribe(UQa,"action",this.vIb).subscribe(fA,"action",this.xkb);iHc(this);
a=this.Za("waffle-tables-popup");Vr(a,"waffle-tables-popup-answers-enabled",this.wb);var b=new bM(a,this.Aa());this.Fa(b);cM(b);a.focus()};p.Oa=function(){H(this.Ia);LY.prototype.Oa.call(this)};function hHc(a,b,c,d){DU(a.jb,null,b,c,d,!1,void 0,function(b){a.Ia=b})}function jHc(a){var b=a.Za("waffle-assistant-table-canvas"),c=a.Za("waffle-assistant-canvas-container");$Gc(a.Wa,b,c,a.getTableRange(),a.D,a.H)}p.xkb=function(){this.dispatchEvent("Td")};
p.vIb=function(){var a=!sZa.test(this.F);Q(this.Cb("waffle-assistant-tables-range-error"),a);Vr(this.Za("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Ab!=this.H||this.Db!=this.D;var b=!Wpc(this.bb,this.getTableRange());if(a||b)a&&this.Ba.Xb(35506),b&&this.Ba.Xb(35507),this.dispatchEvent(new $Cc(this.F,this.H,this.D));this.dispatchEvent("Td")}};
function iHc(a){var b=a.Za("waffle-range-selection-input"),c=gl(a.bb);a.F=rE(c);b.value=a.F;kHc(a);jHc(a)}p.o9=function(a,b,c){LY.prototype.o9.call(this,a,b,c);jHc(this)};function lHc(a){var b=qI(a.O.C),c=b.fc();if(b=wZa(a.F,b))c=al(b,c),a.o9(c,mHc(a,c),a.D),kHc(a)}function mHc(a,b){b=nHc(b,a.D);return a.H>b?b:a.H}function nHc(a,b){a=0==b?a.Lc()-Ue(a,2):a.Pc()-Ue(a,4);return Math.min(a-1,3)}
function kHc(a){H(a.C);a.C=new AM;a.Qa(a.C);ow(a.J,a.C,TQa);AU(a.C,UW.getInstance());a.C.render(a.Za("waffle-assistant-tables-edit-headers-button"));a.getHandler().V(a.C,"action",a.lrb);for(var b=nHc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new pp("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Ed(new bt(d))}c=nHc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new pp("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Ed(new bt(e))}c=a.H;a.C.Af(0==a.D?c:c+b+1);Lr(a.C.La,"label","Headers")}p.tCb=function(){var a=this.Za("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,lHc(this))};p.uIb=function(){var a=this.L.$a();this.F=a;var b=this.Za("waffle-range-selection-input");b.value=a;b.select();lHc(this)};
p.sIb=function(a){var b=this.Za("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;lHc(this);UQa.mc();break;case 27:a.stopPropagation(),a.preventDefault(),iHc(this),fA.mc()}};p.tIb=function(){this.F=this.Za("waffle-range-selection-input").value;lHc(this)};p.lrb=function(){var a=this.C.bh(),b=nHc(this.getTableRange(),0);this.o9(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function oHc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+V(a.title)+'">'+T(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Ft("Press enter to insert formula")+'"></span></div>');return U(a)};function MY(a,b){R.call(this);this.C=a;this.D=b}y(MY,R);p=MY.prototype;p.Ha=function(){this.La=S(oHc,{name:this.C,title:this.D})};p.Ra=function(){MY.qa.Ra.call(this);var a=this.Za("waffle-assistant-quicksum-entry-name");ZX(a);this.getHandler().V(this.La,"keypress",this.HZb);Q(this.La,!1)};p.getFunctionName=g("C");p.fb=function(a){fo(this.Za("waffle-assistant-quicksum-entry-value"),a||"");Q(this.La,!!a)};p.isVisible=function(){return gr(this.La)};
p.HZb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new I("insert",this)))};function pHc(a,b,c,d,e){R.call(this,e);this.Wa=a;this.Ia=b;this.O=c;this.J=d;this.D=a.C;this.Pa=new Wk;this.$=tq(new sq,17).build();this.R=tq(new sq,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}y(pHc,R);
pHc.prototype.Ra=function(){pHc.qa.Ra.call(this);this.vh(new MY(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.vh(new MY(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.vh(new MY(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.vh(new MY(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.vh(new MY(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new yFc(this.La,
this.Ia,this.D,this.O);this.C.H=this.L;this.Fa(this.C);this.getHandler().V(this,"insert",this.va).V(this.C,"formula_inserted",this.Ba)};
function qHc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(MF(a.D)){var c=qI(a.D),d=c.Dj(),e=pI(a.D);if(vb(d,c.Ys,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=Yk(e+"",h.kc(),h.jc(),h.Lc(),h.Pc());c.push(a.Pa.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.La,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.ad(0).fb(b(d.sum));a.ad(1).fb(b(d.average));a.ad(2).fb(b(d.min));a.ad(3).fb(b(d.max));
1<e?a.ad(4).fb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.La,!1);if(a.C){a.C.L=[];a.H=[];for(d=0;d<a.Vc();++d)e=a.ad(d),a.H.push(rHc(a,e.getFunctionName()));a.C.L=a.H}}else Q(a.La,!1)}else Q(a.La,!1)}else Q(a.La,!1)}pHc.prototype.va=function(a){var b=a.target;a=this.F[0];a=new qk(a.left,a.Lc());b=b.getFunctionName();b=rHc(this,b);a=new PK(qI(this.D),a,b);this.O.C(a);this.J.Xb(2624,this.R)};pHc.prototype.Ba=function(){this.J.Xb(2624,this.$)};
function rHc(a,b){var c=u5a(a.Wa.L);a=rb(a.F,function(a){return rE(a)});return"="+b+"("+a.join(c)+")"};function sHc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+T(Hu({content:Bt("INSERT CHART"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+T(Hu({vd:"waffle-autovis-lightbox-close",content:Ct(""+T(bw({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Bt("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
T(Hu({content:Ct("&#10094;"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Dt('aria-label="'+Ft("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+T(Hu({content:Ct("&#10095;"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Dt('aria-label="'+Ft("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
T(a.NJb)+"</div></div></div>");return U(a)}function tHc(){return U('<div class="waffle-autovis-lightbox-chart"></div>')};function uHc(a,b,c,d){R.call(this,d);this.F=a;this.D=b;this.R=c;this.H=[];this.C=new Iu("",this.Aa());this.Qa(this.C);this.O=new Iu("",this.Aa());this.Qa(this.O);this.L=new Iu("",this.Aa());this.Qa(this.L);this.J=new Iu("",this.Aa());this.Qa(this.J)}y(uHc,R);p=uHc.prototype;p.Ha=function(){uHc.qa.Ha.call(this);this.La=S(sHc,{NJb:this.F.length})};
p.Ra=function(){uHc.qa.Ra.call(this);var a=Ax.isEnabled();vHc(this,!a);a=this.Za("waffle-autovis-lightbox-close");this.C.kb(a);a=this.Za("waffle-autovis-lightbox-insert");this.O.kb(a);var b=this.Za("waffle-autovis-lightbox-previous");this.L.kb(b);b=this.Za("waffle-autovis-lightbox-next");this.J.kb(b);wHc(this);xHc(this,this.D,!1);this.getHandler().V(document.body,fga,this.rVb).V(this.La,"keydown",this.tVb).V(In(),"resize",this.wVb).V(this.C,"action",this.close).V(this.O,"action",this.sVb).V(this.L,
"action",this.vVb).V(this.J,"action",this.uVb);b=new bM(this.La,this.Aa());cM(b);this.Fa(b);a.focus()};function wHc(a){var b=a.Za("waffle-autovis-lightbox-content"),c=a.Za("waffle-autovis-lightbox-content-inner");a=a.Za("waffle-autovis-lightbox-page-count");var d=Gn();a=dr(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;ar(c,d,e);ar(b,d,e+a.height+35)}function vHc(a,b){Vr(a.La,"waffle-autovis-lightbox-readonly",b)}
function xHc(a,b,c){c&&zA("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?yHc(a,b):a.F[b]&&PDc(a.F[b],v(a.olb,a,b),!0)}p.olb=function(a,b){if(!this.isDisposed()&&b){var c=this.Za("waffle-autovis-lightbox-container"),d=S(tHc);c.appendChild(d);this.H[a]=d;IW(b,d,this.R,Fo);yHc(this,a)}};function yHc(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.eb(0!=b);a.J.eb(b!=a.F.length-1);var c=a.Za("waffle-autovis-lightbox-page-number");fo(c,b+1);a.D=b}p.rVb=function(a){!co(this.La,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.tVb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&xHc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||zHc(this);a.stopPropagation()};p.wVb=function(){var a=this.Za("waffle-autovis-lightbox-container");Tn(a);this.H=[];wHc(this);xHc(this,this.D,!0)};p.sVb=function(){this.close();SDc(this.F[this.D],2256)};p.vVb=function(){0!=this.D&&xHc(this,this.D-1,!0);0==this.D&&this.J.La.focus()};p.uVb=function(){zHc(this);this.D==this.F.length-1&&this.L.La.focus()};
function zHc(a){a.D!=a.F.length-1&&xHc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.$c=function(){uHc.qa.$c.call(this);var a=this.F[this.D];a&&a.La&&a.La.focus()};function AHc(a,b,c){J.call(this);this.C=Q5b(mG.getInstance(),a,b,c);this.D=Im()}y(AHc,J);AHc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!wb(c,function(a){return Moa(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].wh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&hpc(this.C),this.D=BHc(),this.D.addCallback(function(){return rpc(d.C,b,!0)}))};AHc.prototype.Yf=function(a){this.C.Yf(a)};
function BHc(){var a=null,b=new Bm(function(){null===a||ei(a)});a=di(function(){b.Ub()});return b};function NY(a,b,c,d,e,f){sV.call(this,f);this.Me=a;this.hd=b.C;this.bb=c;this.qf=d;this.H=e;this.jb=new pHc(b,c,d,e,this.Aa());this.Qa(this.jb);this.R=new tW(!1,"#4285f4");this.Qa(this.R);this.O=null;this.Zc=this.Mc=!1;this.Ob=!0;this.Lb=Td();this.Db=this.Ab="";this.Yb=null;this.cb=tq(new sq,10).build()}y(NY,sV);p=NY.prototype;p.Ha=function(){NY.qa.Ha.call(this);this.La=S(CHc,{lM:Bo})};
p.Ra=function(){NY.qa.Ra.call(this);var a=this.Za("waffle-assistant-quicksum-panel");this.jb.kb(a);a=this.Za("waffle-assistant-spinner-container");this.R.render(a);a=this.Me.C;this.getHandler().V(this,"close-sidebar",this.Mka).V(a,"recommender-load-started",this.Bka).V(a,"recommender-load-ended",this.Aka).V(a,"recommender-calc-started",this.aka).V(a,"recommender-calc-ended",this.$ja).V(this.Za("waffle-assistant-scroll-pane"),"scroll",Qpc(this.lba,10,this));a=Ax.isEnabled();this.kba(!a)};
p.resize=function(){var a=this.Za("waffle-assistant-sidepane-content");a=dr(a).height;var b=this.Za("waffle-assistant-spinner-container");Mq(b,"margin-top",a/2-16+"px");this.lba()};p.Yf=ta;function DHc(a,b){var c=EHc(a);0!=c.length&&(H(a.O),c=c.filter(function(a){return a instanceof iY}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new uHc(c,b,a.H,a.Aa()),a.O.render(),a.Fa(a.O),vHc(a.O,a.Zc)))}
p.kba=function(a){this.Zc=a;Vr(this.La,"waffle-assistant-readonly",a);var b=this.jb;b.L=a;b.C&&(b.C.H=a);Vr(b.La,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&vHc(this.O,a)};
p.setVisible=function(a){var b=this.isVisible();NY.qa.setVisible.call(this,a);if(a&&!b){var c=mpc(this.Me.C,a);c?(b=new VBc,D(b,1,Qk(c,"r")),D(b,2,Qk(c,"c")),D(b,3,c.wh()),c=new qq,bd(c,4,b),b=wq(xq(this.cb),c).build()):b=this.cb;this.Db=Ud(this.Lb,$l.Pta,!1,b);uW(this.R,!0);FHc(this)}a||GHc(this,!0)};p.Bka=function(){this.isVisible()&&(GHc(this,!0),uW(this.R,!0),FHc(this))};p.Aka=function(){this.isVisible()&&(uW(this.R,!1),FHc(this))};
p.aka=function(a){this.isVisible()&&(this.H.C(2775,this.cb),GHc(this,void 0,a.C,a.F),HHc(this)||uW(this.R,!0),FHc(this),this.Ob=!1)};
p.$ja=function(a){if(this.isVisible()){this.H.C(2776,this.cb);var b=a.C;0<b.length&&(this.Ab=Ud(this.Lb,$l.Nta));GHc(this,!1);uW(this.R,!1);a=a.F;for(var c=ja(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ja(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Ue(h,1);d.pV(k)&&e.push(h)}0<e.length?d.WM(e,a):d.vT(!0)}if(Ko)for(b=ja(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Ue(a,1)){this.e3();this.Ia=M(a,12);this.va=CU(a);this.Pa=M(a,11);IHc(this);a=this.va;c=!1;for(d=this.gb.length-
1;0<=d;d--)e=this.gb[d],f=a,e.Hg()&&e.Jb()==f.Jb()&&YBc(Zk(e),Zk(f))&&YBc($k(e),$k(f))&&(c=!0,this.gb.splice(d,1));this.gb.push(a);a=c;2!=this.Ia||a||JHc(this,!0)}b=EHc(this);0<b.length&&this.Mc&&(b[b.length-1].Mc=!0);this.Mc=!1;FHc(this);KHc(this);this.lba()}};function FHc(a){var b=HHc(a),c=gr(a.Za("waffle-assistant-quicksum-panel")),d=a.R.Tb();b=b||c||d;a=a.Za("waffle-assistant-empty-list");Q(a,!b)}p.Cc=ta;p.Hoa=ta;p.ud=g("Zc");p.Mka=ta;
p.NHb=function(){""!=this.Ab&&(Vd(this.Lb,this.Ab),this.Ab="");""!=this.Db&&(Vd(this.Lb,this.Db),this.Db="");this.Yb=Ha();this.Ob||(this.H.Xb(2777,this.cb),this.Ob=!0)};function CHc(a){a=a||{};var b=U,c=Ct('<div class="waffle-assistant-replaceable-title">'+LHc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+T(mDc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.lM?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=U(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=U(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(""+T(uV(zt({title:c,Vk:Ct(""+d),id:Bt("autovis"),lH:Bt("waffle-assistant-sidepanel"),yaa:Bt("waffle-assistant-title"),JV:Bt("waffle-assistant-sidepane-content")},a)))+"")}
function LHc(){return U('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+T(mDc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+T("Explore")+"</div></div>")};function OY(a,b,c,d,e,f,h,k,l,m,q){NY.call(this,a,b,c,d,e,q);this.Je=m;this.Wd=f;this.Wa=b;this.ib=new R(this.Aa());this.Qa(this.ib);this.Ba=new JGc;this.Fa(this.Ba);this.D=[];this.F=null;this.Kb=new Iu("",q,4);Rs(this.Kb,2,!1);this.Qa(this.Kb);this.xe=h;this.xg=k;this.Cd=l;this.va=null;this.Ia=0;this.Pa=null;this.Vb=new Au("",new XX,this.Aa());this.Qa(this.Vb);this.vc=new R(this.Aa());this.Qa(this.vc);this.qd=(new JQ).build();this.Fa(this.qd);ow(this.qd,this.Vb,VQa);this.$=this.J=null;this.gb=[]}
y(OY,NY);var PY={FD:"waffle-assistant-scroll-pane-feature-content",D$b:"waffle-assistant-empty-list",bYa:"waffle-assistant-features",cZa:"waffle-assistant-empty-list-learn-more",Dca:"waffle-assistant-expanded-panel",Mva:"waffle-assistant-replaceable-title",$_a:"waffle-assistant-scroll-pane",P0a:"waffle-assistant-sidepane-tables-range",Q0a:"waffle-sidebar-tables-bar",ixa:"waffle-assistant-tables-scroll-pane",R0a:"waffle-assistant-tables-edit-range-button",bw:"waffle-assistant-title"},MHc={defaultHelpArticleId:"6280499"};
p=OY.prototype;
p.Ra=function(){var a=this;OY.qa.Ra.call(this);this.ib.kb(this.Za(PY.Dca));ZX(this.C.La,"Close");Ko&&(this.vc.kb(this.Za(PY.P0a)),IHc(this),this.Vb.kb(this.Za(PY.R0a)));var b=this.Wa.L.Tq();Bo&&(zwa||"en"==lG(b))&&(b=new IY(this.Wd,this.bb,this.hd,this.qf,this.H,this.Ba,this.Wa,this.xg,this.Cd,this.Je,this.Aa()),this.Qa(b),this.D.push(b));b=new WGc(this.H,this.Ba,this.Aa());this.Qa(b);this.D.push(b);F(E(),"fedvs")&&(b=new NGc(this.H,this.Ba,this.bb,this.Aa()),this.Qa(b),this.D.push(b));Fwa&&(b=new YGc(this.Wd,
this.hd,this.Wa,this.qf,this.H,this.Ba,this.Je,this.Aa()),this.Qa(b),this.D.push(b));b=new kY(this.hd,this.bb,this.H,this.Ba,this.Aa());this.Qa(b);this.D.push(b);var c=this.Za(PY.bYa);A(this.D,function(b){b.render(c);a.ib.Qa(b.C,!0)});this.Kb.kb(this.Za(PY.cZa));this.getHandler().V(this.Kb,"action",this.o_b).V(this,"Td",this.e3).V(this,"Sd",this.p_b);NHc(this)};p.p_b=function(){var a=OHc(this);a&&(a.Ia=!0)};p.o_b=function(){P.$n.mc(MHc)};function KHc(a){A(a.D,function(a){vDc(a)})}
function GHc(a,b,c,d){A(a.D,function(a){a.vT(b,c,d)})}function HHc(a){return!!wb(a.D,function(a){return a.Zka()})}p.lba=function(){var a=this,b=this.Za("waffle-assistant-scroll-pane").scrollTop+dr(this.Za("waffle-assistant-sidepane-content")).height;A(this.D,function(c){a.F&&a.F!=c||(c instanceof kY&&a.getHandler().Oc(c,"Od",a.NHb),b=c.$M(b))})};function EHc(a){if(a.F)return a.F.C.C;var b=[];A(a.D,function(a){Jb(b,uDc(a))});return b}p.kba=function(a){OY.qa.kba.call(this,a);NHc(this)};
p.Yf=function(a){A(this.D,function(b){b.Yf(a)})};p.Hoa=function(){var a=this.Za(PY.Mva),b=this.Za(PY.bw);cr(b,dr(a).height)};
p.Cc=function(){var a=this,b=this.Za(PY.FD),c=this.Za(PY.Mva),d=this.ib.La;if(this.F)this.F.C.setVisible(!1),this.F.$0(!1),this.F=null,Q(b,!0),Q(d,!1),qt(c,LHc),Mr(c,"label"),this.resize();else if(this.F=wb(this.D,function(a){return a.Tb()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),wDc(this.F,c),Or(c,this.F.XM());this.Hoa();b=new mn(function(){var b=dx;b&&b.dispatchEvent("resize");a.lba()},300);this.Fa(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();OY.qa.setVisible.call(this,a);a&&!b&&PHc(this,!0);a||this.Ba.clear()};p.Mka=function(){OY.qa.Mka.call(this);this.F&&this.Cc();this.e3()};p.Bka=function(){OY.qa.Bka.call(this);PHc(this,!0)};p.Aka=function(){OY.qa.Aka.call(this);PHc(this,!1)};p.aka=function(a){OY.qa.aka.call(this,a);PHc(this,!0,a.C)};p.$ja=function(a){OY.qa.$ja.call(this,a);PHc(this,!1)};
function QHc(a,b){if(Ko){var c=OHc(a);b?(kac(a.J),a.J=new gHc(a.Wa,a.bb,a.xe,a.va,a.Ia,a.Pa,a.H,a.Cd,!!c&&c.Tb()),a.Qa(a.J),a.J.render(a.getElement())):a.J&&(a.removeChild(a.J,!0),H(a.J),a.J=null);c&&FGc(c,b)}}function JHc(a,b){if(Ko&&1!=a.Pa){var c=OHc(a);b?(a.$=new fHc(a.Wa,a.bb,a.xe,a.va,a.Ia,a.Pa,!!c&&c.Tb()),a.Qa(a.$),a.$.render(a.getElement())):a.$&&(a.removeChild(a.$,!0),H(a.$),a.$=null);c&&FGc(c,b)}}function NHc(a){A(a.D,function(b){b.YM(a.ud())})}
function OHc(a){return(a=wb(a.D,function(a){return a instanceof IY}))?a:null}function PHc(a,b,c){A(a.D,function(a){c||qDc(a.C,b)});Ko&&b&&(a.va=null,a.Ia=0,a.Pa=null,a.e3(),IHc(a))}function IHc(a){var b=a.Za(PY.Q0a),c=a.Za(PY.$_a);if(a.va){var d=gl(a.va);d=rE(d);d=S(dHc,{pH:d});a=a.vc.Pb();Tn(a);a.appendChild(d);Q(b,!0);Rr(c,PY.ixa)}else Q(b,!1),Tr(c,PY.ixa)}p.e3=function(){QHc(this,!1);JHc(this,!1)};function RHc(a,b,c,d,e,f,h,k,l,m,q,t){var w=this;xV.call(this,b,h);this.va=a;this.C=b;this.$=c;this.cb=d;this.Ab=e;this.L=f;this.H=c.C;this.gb=this.bb=!1;this.F=null;this.O=l;this.jb=t;this.Kc=new Wk;this.J=null;SHc(this);kNa.eb(!0);a=new Qp;D(a,6,THc());b=new Op;bd(b,58,a);this.Ba=tq(uq(new sq,b),10).build();this.ib=Td();this.Pa=Ud(this.ib,$l.Mta);this.Ia=-1;a=new mn(function(){return UHc(w,!1)},100);this.Fa(a);a.start()}y(RHc,xV);
function SHc(a){var b=QC(a.Ab);a.We().V(a.cb,"selectionChange",a.s_b).V(a.H,"K",a.q_b).V(b,"ea",a.vub).V(a.C,"Ld",a.wjb).V(a.C,"Kd",a.vjb).V(a.C,"Jd",a.tjb).V(a.C,"Qd",a.Nyb).V(a.C,"Nd",a.Qkb).V(a.C,"Pd",a.r_b).V(a.C,"Ud",a.GBb).V(a.C,"Rd",a.kAb).V(a.C,"Md",a.Vjb).V(a.C,"Vd",a.u_b).V(a.va.C,"recommender-confidence-update",a.nmb).V(a.C,"Sd",a.t_b);a.R.Sb(Ax,ae,a.xsb).subscribe(Bx,"action",a.Sjb).subscribe(lNa,"action",a.nBb).subscribe(iNa,"action",a.YOa).subscribe(ly,"action",a.dwb).subscribe(VQa,
"action",a.BBb)}p=RHc.prototype;p.yh=function(){return mNa};p.fs=function(){return nNa};p.Fq=function(a){RHc.qa.Fq.call(this,a);lNa.eb(a);UHc(this,!1);!this.bb&&a&&(this.bb=!0);sp(this.jb,{Rb:a});a||this.C.Cc()};p.xY=function(a){var b=this;this.C.Hoa();var c=new mn(function(){RHc.qa.xY.call(b,a)},300);this.Fa(c);c.start()};p.fka=function(){RHc.qa.fka.call(this);VHc(this,!1)};p.Yf=function(a){this.C.Yf(a);this.va.Yf(a)};
p.wjb=function(a){var b=a.C.F,c=M(M(b,13),3);b=CU(b);var d=new Mf;O(d,1,c);var e=new Nf;O(e,1,d);O(e,3,!0);Noc(e,!0);this.L.C(new vT(e,b));QY(this,a.hj(),!1,tvc(Kf(c)))};p.Sjb=function(){var a=this.C.isVisible();this.yh().setVisible(!a);a||this.C.focus();VHc(this,!a)};function VHc(a,b){b?(QY(a,2253),a.Ia=Ha()):QY(a,2226,!0)}p.YOa=function(){this.C.isVisible()||this.Fq(!0)};p.dwb=function(){var a=OHc(this.C);a&&(a.Tb()?IGc(a,"",!0):(this.YOa(),HGc(a,"",!0)))};p.nBb=function(a){DHc(this.C,a)};
p.BBb=function(){QHc(this.C,!0)};p.s_b=function(){TG(this.$)&&!this.C.J&&UHc(this,!0)};function UHc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(qHc(d.jb),FHc(d));a.va.update(!b,a.C.isVisible(),c)}
p.nmb=function(a){""!=this.Pa&&(Vd(this.ib,this.Pa),this.Pa="");var b=a.C||0;a=a.F;var c=!!a&&a.rect,d=(c=!!c&&c.wh()>=twa&&Qk(c,"r")>=vwa&&Qk(c,"c")>=wwa&&c.wh()<=uwa)&&.6<=b;if(d!==this.gb||a&&!a.equals(this.F))this.gb=d,this.F=a,this.Ia=Ha(),kNa.mc({k8:d,pH:a});c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.wh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.C,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.isVisible()&&!this.bb&&c&&d&&!this.$.bl(),a=lwa&&a,d=mwa&&this.$.ud(),
c&&(a||d)&&(c=new Qp,D(c,1,b),D(c,2,a),D(c,3,d),D(c,5,Jo),D(c,6,THc()),b=new Op,bd(b,58,c),b=uq(tq(new sq,10),b).build(),this.Aya(b)))};p.Aya=function(a){var b=this;this.C.Mc=!0;var c=x1a(qI(this.H));if(!S8b.C&&!c){var d=a||this.Ba;this.yh().setVisible(!0);this.O.Xb(2225,d);QY(this,2253);a=new mn(function(){b.C.isVisible()||b.O.Xb(2752,d)},5E3);this.Fa(a);a.start()}};
function THc(){switch(xwa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Vjb=function(){this.C.Cc()};p.u_b=function(a){var b=a.C,c=CU(b.F),d=parseInt(c.Jb(),10);this.J=gl(c);this.L.C(new j9b(d));TGc(b,c);QY(this,a.hj())};p.q_b=function(){MF(this.H)?(this.C.eb(!0),UHc(this,!1)):(this.yh().setVisible(!1),this.C.eb(!1))};p.xsb=function(){this.C.kba(!Ax.isEnabled())};p.vub=function(a){UHc(this,!1,oUa(a))};
p.vjb=function(a){var b=qI(this.H),c=""+b.fc(),d=[],e=Jqc(b);if(e){b=new Qg;var f=Ue(e,2);O(b,3,f);f=Ue(e,2);O(b,2,f);e=Ue(e,1);O(b,1,e);d.push(b)}b=a.C.vc;for(e=0;e<b.length;e++)f=new Qg,O(f,2,b[e]),d.push(f);this.L.C(new nW(d,c));QY(this,a.hj())};
p.tjb=function(a){var b=a.C,c=Crc(b.C),d=CU(b.F),e=c.wu?c.ax:null,f=c.C?c.Cw:null,h=parseInt(d.Jb(),10),k=WHc(d);this.J=gl(d);k?this.L.C(new wV(k,h,this.J,e,c.Vr,c.Qs,f)):this.L.C(new vV(h,this.J,e,c.Vr,c.Qs,f));d=new Zoc;D(d,1,1);c=new zU;b=M(b.F,2);D(c,2,b);bd(c,5,d);b=CDc(this.F);bd(b,46,c);b=uq(tq(new sq,10),b).build();this.O.C(a.hj(),b)};p.Nyb=function(a){a=a.C;var b=CU(a.F),c=parseInt(b.Jb(),10),d=WHc(b);this.J=gl(b);this.L.C(new Frc(d,c));TGc(a,b)};
p.t_b=function(a){var b=qI(this.$.C),c=b.fc();b=al(wZa(a.L,b),c);c=ADc(b,a.F,a.O);var d=this.va,e=a.F;hpc(d.C);d.C.bb=b;d.C.Pa=c;d.C.Wa=e;qpc(d.C,!0,!0,!1);QY(this,a.hj())};function WHc(a){var b=a.Jb();a=gl(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.kc(),a.jc(),a.Lc(),a.Pc(),7,!1);return 0<b.length?b[0]:null}p.Qkb=function(a){zF(qI(this.H),a.J);QY(this,a.hj())};
p.GBb=function(a){var b=a.C;a=a.hj();if(b instanceof EY||b instanceof GY||b instanceof XGc)QY(this,a);else{var c=EHc(this.C),d=new zU,e=M(b.F,2);c=c.indexOf(b);D(d,1,c);D(d,2,e);e=new Op;bd(e,46,d);if(b instanceof iY){(d=b.H)?(b=XHc(this,b,d),b=Evc(b,d,d.hg())):b=null;if(!b)return;bd(e,39,b)}else if(b instanceof $Dc){var f=b.F;c=new IBc;if(b instanceof $Dc)b=1;else throw Error("Unknown text analysis card type.");f=Te(M(f,8),20).slice(0,10);D(c,2,f||[]);D(c,1,b);bd(d,3,c)}e=uq(tq(new sq,10),e).build();
this.O.C(a,e)}};p.kAb=function(){this.C.Cc()};
p.r_b=function(a){var b=a.L;if(b){var c=qI(this.H),d=a.Oe();d||(d=LF(this.cb).D.C.Oe());var e=16,f=16,h=a.Wa;h&&(e=h.x,f=h.y);h=wpc(this.$.J);d={oid:null,ar:GF(c,d.y),ac:HF(c,d.x),x:e,y:f,h:nG.height,w:nG.width,p:{context:sc("chartName","Chart "+(h+1))}};(c=b.hg())?(e=new Nj(c),d=new $H(QF(this.H)||0,d,!1,!1),f=Xj(e,"headers"),f=null!=f&&na(f)&&Ra(f)?parseInt(f,10):-1,d.cb=f,d.$=0,f="1"==Xj(e,"transpose"),d.Wa=f,d.O=f?"ROWS":"COLS",f=Xj(e,"range"),f=nqc(oqc(f,","),this.H),d.dH(f),(e=Xj(e,"dt"))&&
E8a(d,this.Kc.fd(eh.Na(),JSON.parse(decodeURIComponent(e))))):(e=new lh,O(e,2,"0.6"),f=a.Fd().toJSON(),O(e,1,f),d=new $H(QF(this.H)||0,d,!1,!1,e));upc(d,b);this.cb.dispatchEvent(new II("objectRequest"));this.L.C(new MK(this.$,d));e=YHc(this,b,a.O,a.Fd());d=d.getId()||0;e.H=d;GW(this.O,a.hj(),e,10,b,c,void 0,a.F)}};function XHc(a,b,c){var d=EHc(a.C).filter(function(a){return a instanceof iY});return YHc(a,c,d.indexOf(b),b.H&&b.H.Fd())}
function YHc(a,b,c,d){var e=new FW;a=EHc(a.C).filter(function(a){return a instanceof iY}).map(function(a){return a.getChartType()});e.R=a;e.J=c;Dvc(e,b.getChartType());e.F=d?d.clone():null;return e}
function QY(a,b,c,d){if(a.F){var e=$c(aCa(a.Ba),Qp,58).getTableRange();if(c||!e||e.Jb()!=a.F.C||e.jc()!=a.F.rect.jc()||e.kc()!=a.F.rect.kc()||e.Pc()!=a.F.rect.Pc()||e.Lc()!=a.F.rect.Lc()){e=new Qp;D(e,6,THc());var f=BDc(a.F);bd(e,7,f);c&&(c=Ha()-a.Ia,D(e,8,1E3*c),null!=a.C.Yb&&(c=Ha()-a.C.Yb,D(e,10,1E3*c)));d&&$oc(e,d);d=F(E(),"feacos");D(e,9,d);d=new Op;bd(d,58,e);a.Ba=tq(uq(new sq,d),10).build()}}a.O.Xb(b,a.Ba)};function ZHc(){G.call(this)}y(ZHc,Ro);ZHc.prototype.D=function(){return AHc};ZHc.prototype.H=function(){return OY};ZHc.prototype.F=function(){return RHc};ZHc.prototype.C=function(){return YCc};ap("assistant",ZHc);
