ci.prototype.dQ=PR(12,function(){return I(this,56)});var lVd=[5];function mVd(a){Oh(this,a,0,-1,lVd,null)}y(mVd,Nh);mVd.prototype.getContext=function(){return I(this,1)};mVd.prototype.setContext=function(a){J(this,1,a)};mVd.prototype.bv=function(){J(this,1,void 0)};function nVd(a,b){var c=new iX,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}
function oVd(a){return R("<div"+(a.id?' id="'+T(a.id)+'"':"")+' class="'+(a.Of?T(a.Of)+" ":"")+T("goog-flat-menu-button")+" "+T("goog-flat-menu-button-disabled")+" "+T("goog-inline-block")+'" role="button"'+(a.Et?' aria-label="'+T(a.Et)+'"':"")+'><div class="'+T("goog-flat-menu-button-caption")+" "+T("goog-inline-block")+'">'+Q(a.oB)+'</div><div class="'+T("goog-flat-menu-button-dropdown")+" "+T("goog-inline-block")+'" aria-hidden="true">&nbsp;</div>'+(a.jl?Q(a.jl):"")+"</div>")}
function pVd(a,b,c){b=c||b;a=a||{};return R(SDa(Tp({sW:Vp("docs-icon-close-small")},a),b))}function qVd(a,b){ns.call(this);this.C=a;this.D[a]=b}y(qVd,ns);qVd.prototype.Vl=function(a){var b={};b[this.C]=a;qs(this,b)};function $5(){Dr.call(this);this.C=new iX;Er(this,new Ir(Cr,{},{wordList:[]}));this.J=new fm;this.va(this.J)}y($5,Dr);ua($5);$5.prototype.F=function(a){rVd(this,a,!0)};function rVd(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;Fr(a).get("wordList").push(f);c&&sVd(a,[b],[])}return!d}$5.prototype.L=function(a){tVd(this,a,!0)};
function tVd(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=Fr(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&sVd(a,[],[b])}return d}$5.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)rVd(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function sVd(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new Hr(new Gr("docs-user_dictionary",d),Fr(a)))};function uVd(a,b,c){Fp.call(this,a,b,c);gp(this,"Preferences")}y(uVd,Fp);p=uVd.prototype;p.Ia=function(){uVd.ma.Ia.call(this);this.getHandler().R(this,"dialogselect",this.Q7a)};p.setVisible=function(a){uVd.ma.setVisible.call(this,a);a&&this.update()};p.update=ta;p.Q7a=function(a){"ok"==a.key&&this.LRa()};p.LRa=ta;function vVd(a){a='<b>"'+(Q(a.XT)+'"</b> added to your personal dictionary.');return R(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function wVd(a){a='<b>"'+(Q(a.XT)+'"</b> removed from your personal dictionary.');return R(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}
function xVd(a,b,c){b=c||b;a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input '+T("jfk-textinput")+'" type="text" aria-label="'+T(a.oMa)+'" placeholder="'+T(a.oMa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+Q(er({Ed:"docs-userdictionarydialog-button-add",style:0,content:$p("Add")},null,b))+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>');
return R(a)}function yVd(a){return R('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+T(a.XT)+'" class="docs-userdictionarydialog-row-content">'+Q(a.XT)+"</div></div>")};function a6(a,b){Lj.call(this,void 0,new zVd);this.rsa=a;this.C=b}y(a6,Lj);a6.prototype.Lo=ba();a6.prototype.TQ=function(a){a.relatedTarget&&ne(this.C,a.relatedTarget)||a6.ma.TQ.call(this,a)};a6.prototype.Li=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Dh(a)};function zVd(){}y(zVd,tg);zVd.prototype.tc=n("docs-userdictionarydialog-row-container");zVd.prototype.xa=function(a){return P(yVd,{XT:a.rsa})};function b6(a){Uj.call(this,void 0,new AVd);this.D=a;this.C=this.F=null}y(b6,Uj);p=b6.prototype;p.Ia=function(){b6.ma.Ia.call(this);sg(this.Da,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");ng(this.Da,"listbox");var a=this.F;G(a,!1);$f(a,!0);this.C=new Gj(a);this.getHandler().R(this,"action",this.joa).R(this.F,"click",this.joa).R(this.C,"key",this.dmb)};p.ld=function(){b6.ma.ld.call(this);D(this.C);this.C=null};
function BVd(a){var b=[];a.Df(function(a){b.push(a.rsa)});return b}p.joa=function(){var a=Xj(this);var b=this.Oj==this.cd()-1;this.highlightPrevious();this.removeChild(a,!0);b||this.highlightNext();CVd(this);this.dispatchEvent("change")};p.dmb=function(a){return 13==a.keyCode||32==a.keyCode?(this.joa(a),a.preventDefault(),a.stopPropagation(),!0):!1};p.kx=function(){0==this.Ki("docs-userdictionarydialog-row-container-hover").length&&ck(this)};p.ys=function(a){a.stopPropagation();a.preventDefault()};
p.Fj=function(a){return 27==a.keyCode?!1:b6.ma.Fj.call(this,a)};p.cY=function(a){b6.ma.cY.call(this,a);CVd(this)};p.qja=function(a){var b=we(document);b6.ma.qja.call(this,a);b&&Se(b,"docs-userdictionarydialog-list-remove-button")?this.Da.focus():CVd(this)};function CVd(a){if(Xj(a)){var b=Xj(a),c=Math.round((Tf(b.Da).height-Tf(a.F).height)/2);a.F.style.top=If(b.Da).y+c+"px";sg(a.F,"Remove "+b.rsa);G(a.F,!0)}else G(a.F,!1)}function AVd(){this.C=void 0}y(AVd,Kj);
AVd.prototype.Fp=function(a){var b=P(pVd,{enabled:!0,Of:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function c6(a,b,c,d){uVd.call(this,b,c,d);this.ea=a;this.F=new fr(null,d);this.Ha(this.F);this.L=this.C=null;this.J=new b6(a);this.Ha(this.J);this.O=null;gp(this,"Personal dictionary");a=tp((new op).set("ok","Save",!0),wp,!1,!0);rp(this,a)}y(c6,uVd);p=c6.prototype;p.xa=function(){c6.ma.xa.call(this);Kp(this.Fb(),xVd,{oMa:"Add a new word"});rq(this,"ok");this.F.Va(this.La("docs-userdictionarydialog-button-add"));this.J.Va(this.La("docs-userdictionarydialog-list-container"));this.C=this.La("docs-userdictionarydialog-input")};
p.Ia=function(){c6.ma.Ia.call(this);this.F.Pa(!1);this.L=new tq(this.C);this.getHandler().R(this.F,"action",this.lkb).R(this.C,"keypress",this.w9a).R(this.L,"input",this.v9a).R(this.J,"change",this.tpb);this.getHandler().R(this.F.getElement(),"focus",this.Xga).R(this.C,"focus",this.Xga);for(var a=hza(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.Xga);this.O=new yM(this.J)};p.ld=function(){c6.ma.ld.call(this);ec(this.L,this.O);this.O=this.L=null};p.lkb=function(){DVd(this)};
p.v9a=function(){this.F.Pa(!$a(mb(this.C.value)))};p.w9a=function(a){13==a.keyCode&&(this.F.isEnabled()&&DVd(this),a.stopPropagation(),a.preventDefault())};p.Xga=function(){this.J.Yi(-1)};p.tpb=function(){sp(this.D,"ok").disabled=!1};p.update=function(){var a=this.J;a.Hd(!0);var b=a.D.C.Cd();b.sort(DBc());for(var c=0;c<b.length;c++)a.Ha(new a6(b[c],a.F),!0);EVd(this,"");sp(this.D,"ok").disabled=!0};
p.LRa=function(){var a=this.J;var b=new iX(a.D.C.Cd());var c=new iX(BVd(a));a=nVd(c,b).Cd();b=nVd(b,c).Cd();c=this.ea;for(var d=[],e=[],f=0;f<a.length;f++)rVd(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)tVd(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&sVd(c,d,e)};
p.setVisible=function(a){c6.ma.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,oEa(b)?(b.selectionStart=a,b.selectionEnd=a):Hc&&!Rc("9")&&(a=qEa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function EVd(a,b,c){a.C.value=b;a.F.Pa(!$a(mb(a.C.value)));c&&a.C.select()}
function DVd(a){var b=a.J,c=a.C.value;c=c.toLowerCase().trim();-1==BVd(b).indexOf(c)&&(c=new a6(c,b.F),b.lh(c,0,!0),b.Da.scrollTop=0,b.dispatchEvent("change"));Ee(a.oa())==a.C&&a.C.blur();EVd(a,"");a.C.focus()};function FVd(a,b){var c=new c6($5.getInstance());a.$h(c);return Fa(GVd,c,b)}function GVd(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&EVd(a,c,!0)};function HVd(){B.call(this);this.C=new Qq;this.D=new fm;this.va(this.D)}y(HVd,B);function IVd(a,b){this.C=a;this.D=b}IVd.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};IVd.prototype.getSelection=g("D");function JVd(a,b){this.D=a;this.C=b};function KVd(a,b,c){this.C=a;this.F=b;this.D=c||null}KVd.prototype.Dv=g("F");function LVd(a,b,c,d,e,f){this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ja=new rf(this);this.va(this.Ja)}y(LVd,B);p=LVd.prototype;p.u9a=function(a){var b=this.C.C;MVd(this.D,a);NVd(this,b,!0)};
p.Bmb=function(a){var b=this.C.C,c=this.D,d=jb(a.C.Dv()),e=a.D;a=new DE;X(a,1,"\\b"+d+"\\b");X(a,3,e);X(a,6,!1);X(a,7,!1);X(a,8,!0);a.setType(2);X(a,11,0);d=c.C.F;switch(c.C.V){case "RANGE":X(a,5,0);a.setSelection(iA(d.rect,d.ud));var f=ZH(c.D,d.ud);break;case "SHEET":X(a,5,1);f=new ow;X(f,1,""+d.ud);a.setSelection(f);f=ZH(c.D,d.ud);break;case "WORKBOOK":X(a,5,2),f=c.D.P5(-1,0,!1)}f=f.Oc();c.F.C(new fX(f,a));NVd(this,b,!0)};
p.ztb=function(a){var b=this.C.C;if(na(a)){var c=this.L;c.C.contains(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}NVd(this,b,!1)};p.iob=function(a){var b=this.C.C;if(a instanceof IVd){var c=this.D.H,d=a.C.Dv();a=a.getSelection();if(!OVd(c,d,a)){var e=c.C[""+a.C];e||(e=VF(c.F,a.C),e.getSheetType(),e=e.Oc(),e=new kI(e,!0),c.C[""+a.C]=e);c=a.Ad.y;a=a.Ad.x;var f=e.Se(c,a);f||(f=new Qq,lI(e,c,a,f));f.add(d.toLowerCase())}}NVd(this,b,!1)};
p.tyb=function(a){var b=this.C.C;na(a)&&(this.J?this.J.F(a):$5.getInstance().F(a));NVd(this,b,!1)};p.DCa=function(){N.dda.Nc(!1);this.Ja.Rc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.DCa);PVd(this.D.C)};p.uLb=function(){NVd(this,null,!1)};p.eKa=function(a){var b=this.F.C;G(b.Aa,!1);G(b.Ga,!0);b=this.C;var c=v(this.eVa,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.ea.push(b.C));QVd(b,c,!!a)};
function NVd(a,b,c){var d=a.F.C;G(d.Aa,!1);G(d.Ga,!0);b=v(a.eVa,a,b,c);a.H.C.getSelection();QVd(a.C,b,!1)}
p.eVa=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;G(c.Aa,!0);G(c.Ga,!1);c=a.C;var d=c.J.C;Jg(c.kb);var e=c.oa().yb("docs-slidingdialog-content",c.getElement());e&&og(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){e=d.C;var f=c.oa();c.getHandler().Rc(c.F,"focus",c.DKa).Rc(c.F,"blur",c.CKa).Rc(c.O,"input",c.FKa).Rc(c.F,"keydown",c.EKa);c.H.Qa("");var h=c.F,k=h.cloneNode(!0);ge(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
D(c.removeChild(c.H));c.H=new zS("",f);c.Ha(c.H);c.H.Va(c.F);D(c.O);c.O=new tq(c.F);for(c.getHandler().R(c.F,"focus",c.DKa).R(c.F,"blur",c.CKa).R(c.O,"input",c.FKa).R(c.F,"keydown",c.EKa);0<c.D.cd();)c.D.An(0).dispose();f="Next misspelling. Change "+(e.Dv()+" to:");og(c.F,"label",f);c.oa().Te(c.vd,e.Dv());f=oc(e.C);if(0==f.length)c.H.Qa(e.Dv()),e=new ek("No suggestions"),c.D.Ha(e,!0),e.kf(2,!1),e.Pa(!1),c.fc.Vl(!1);else{c.H.Qa(f[0]);for(h=0;h<f.length;h++)e=new ek(f[h]),c.D.Ha(e,!0),c.getHandler().R(e,
"action",c.yFb).R(e.getElement(),"dblclick",c.Nvb),1<f.length&&(e.yp(!0),Te(Pd("goog-menuitem-checkbox",e.Da),"goog-inline-block"));(e=c.D.kd(0))&&1<c.D.cd()&&e.Ec(!0);c.D.Yi(0);c.fc.Vl(!0)}GBc(c.Na,d.getSelection());c.RUa.call(c,c.ea);c.RUa.call(c,c.Ra);G(c.Ua,!1);G(c.Ta,!0)}else G(c.Ta,!1),ce(c.Pb),c.Eb&&c.Pb.appendChild(c.Eb),G(c.Ua,!0),c.kb=Ig(v(c.gr,c),c.Bc),c.Na.bv();a.C.focus();(a=this.C.C)?RVd(this.D,a.getSelection()):b&&RVd(this.D)};function SVd(a){this.C=a};function TVd(a,b,c,d,e,f){hX.call(this,f);this.L=a;this.J=b;this.Bd=new SVd(e);this.Na=new FBc(c);this.Ha(this.Na);this.$=new fr(null,f);this.Ha(this.$);this.ea=new jk(f);this.rb=null;this.Mc=new mr(null,this.ea,VN.getInstance());this.Ha(this.Mc);this.Oa=new fr(null,f);this.Ha(this.Oa);this.Ra=new jk(f);this.Cb=null;this.Xc=new mr(null,this.Ra,VN.getInstance());this.Ha(this.Xc);this.xb=this.qa=this.V=null;this.H=new zS("",f);this.Ha(this.H);this.D=new UVd(f);kk(this.D,!1);this.Ha(this.D);this.Eb=
this.Pb=this.Ua=this.Ta=this.O=this.F=null;this.Bc=5E3;this.kb=this.vd=null;this.fc=d;this.Aa=this.Ga=this.Ka=null}y(TVd,hX);function VVd(a){Ue(a.Da,["goog-menu-no-icon","goog-menu-noaccel"])}p=TVd.prototype;
p.eha=function(){var a=Vp("Spellcheck");var b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+Q(IBc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><div class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</div><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false">'+Q(HBc({id:"docs-spellcheckslidingdialog-replacement-context"}))+
"</td><td>"+Q(er({id:"docs-spellcheckslidingdialog-button-change",style:2,Ed:"docs-spellcheckslidingdialog-buttons-action",content:$p("Change")},null,null))+Q(oVd({id:"docs-spellcheckslidingdialog-button-change-menu",oB:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+Q(er({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Ed:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",
content:$p("Ignore")},null,null))+Q(oVd({id:"docs-spellcheckslidingdialog-button-ignore-menu",Of:"docs-spellcheckslidingdialog-buttons-white-menu",oB:""}))+"<br/>"+Q(er({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Ed:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:$p("Add to Dictionary")},null,null))+Q(oVd({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Of:"docs-spellcheckslidingdialog-buttons-white-menu",oB:""}))+"</td></tr></tbody></table></div></div></div>");
b=R(b);a=""+(""+Q(JBc({fBa:a,Xk:$p(""+b)}))+"");return R(a)};p.D5=function(){var a=this.Bd,b=this.J.C,c=new ci,d=b?b.C.dQ():null;a=a.C.C.replace(/_/g,"-");L(K(),"docs-anddc")||L(K(),"docs-agdc");$a(mb(d))||J(c,56,d);J(c,60,a);if(b){b=b.C;var e,f;oc(b.C).length&&(e=oc(b.C)[0]);e&&(f=b.C[e]);e=new mVd;f&&J(e,5,f.C||[]);Uh(c,66,e)}return hj(gj(new fj,1),c).build()};
p.xa=function(){TVd.ma.xa.call(this);var a=Ud("SPAN","docs-spellcheckslidingdialog-menu-text","Change all"),b=Ud("SPAN","docs-spellcheckslidingdialog-count","");this.rb=new ek([a,b]);this.ea.Ha(this.rb,!0);a=Ud("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=Ud("SPAN","docs-spellcheckslidingdialog-count","");this.Cb=new ek([a,b]);this.Ra.Ha(this.Cb,!0)};
p.Ia=function(){TVd.ma.Ia.call(this);Te(this.Da,"docs-spellcheckslidingdialog");var a=this.oa();this.Ga=a.getElement("docs-spellcheckslidingdialog-loading");this.Aa=a.getElement("docs-spellcheckslidingdialog-content");this.Ua=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.Pb=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.Ta=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.O=
new tq(this.F);this.vd=a.getElement("docs-spellcheckslidingdialog-original-word");this.Na.Va(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.Va(this.F);this.$.Va(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Oa.Va(a.getElement("docs-spellcheckslidingdialog-button-ignore"));WVd(this.Mc,this.$,"docs-spellcheckslidingdialog-button-change-menu",N.gda,this.L,a);WVd(this.Xc,this.Oa,"docs-spellcheckslidingdialog-button-ignore-menu",N.ida,this.L,a);this.D.Va(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.Jh(!0);VVd(this.D);nh(this.L,this.Oa,N.V1,ph,v(this.J.Ka,this.J),v(this.D5,this));nh(this.L,this.$,N.aU,ph,v(this.yhb,this),v(this.D5,this));this.V=new fr(null,this.oa());this.qa=new jk(a);this.xb=new mr(null,this.qa,VN.getInstance(),a);this.Ha(this.V);this.Ha(this.xb);this.V.Va(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));XVd(this,this.V,N.j2,!0);WVd(this.xb,this.V,"docs-spellcheckslidingdialog-button-dictionary-menu",N.hda,this.L,a);a=new ek("View personal dictionary...");
var b=yc(ph);delete b["node-label"];delete b.label;nh(this.L,a,N.Fy,b,v(this.v5,this,this.J));this.qa.Ha(a,!0);VVd(this.qa);nh(this.L,this.rb,N.A1,void 0,v(this.w6a,this),v(this.D5,this));VVd(this.ea);XVd(this,this.Cb,N.W1,!1);VVd(this.Ra);this.getHandler().R(this.D.getElement(),Hc?df:"focus",this.YDb);this.Ka=new tt(this.getElement());this.va(this.Ka);a=YGa("Ctrl+single-quote",!1);b=YGa("Ctrl+semicolon",!1);aHa(this.Ka,N.u2,[a]);aHa(this.Ka,N.v2,[b])};p.focus=function(){Xf(this.Ta)?DS(this.H):this.Ua.focus()};
function WVd(a,b,c,d,e,f){c=f.getElement(c);a.Va(c);zU(a,1);H8b(a,b.getElement());zU(b,2);b=new mj(c,a.rf()?1:5);msc(a,b);nh(e,a,d,ph)}p.RUa=function(a){a=Pd("docs-spellcheckslidingdialog-count",a.getElement());this.oa().Te(a,"")};function YVd(a){var b=a.H.Ma();a=new KVd(b,a.v5(a.J),a.J);N.aU.yc(a)}p.Nvb=function(){YVd(this)};p.DKa=function(){var a=this.oa().Sq(this.F);Te(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};p.CKa=function(){var a=this.oa().Sq(this.F);Ve(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
p.EKa=function(a){13==a.keyCode&&YVd(this)};p.YDb=function(){for(var a=0;a<this.D.cd();a++){var b=this.D.kd(a);if(b.isChecked()){b.gg(!0);return}}0<this.D.cd()&&this.D.Yi(0)};function ZVd(a){for(var b=0;b<a.D.cd();b++)a.D.kd(b).Ec(!1)}p.FKa=function(){ZVd(this);this.fc.Vl(!0)};p.yFb=function(a){var b=a.target.Ma();ZVd(this);this.H.Qa(b);(a=a.target)&&1<this.D.cd()&&a.Ec(!0);DS(this.H)};p.yhb=function(){var a=this.H.Ma();return new KVd(a,this.v5(this.J),this.J)};
p.w6a=function(){var a=this.J;a=a.C?a.C.C:null;return new JVd(this.H.Ma(),a)};function XVd(a,b,c,d){nh(a.L,b,c,d?ph:void 0,v(a.v5,a,a.J),v(a.D5,a))}p.v5=function(a){return(a=a.C)?a.C.Dv():null};p.Fa=function(){Jg(this.kb);D(this.O);TVd.ma.Fa.call(this)};function UVd(a,b){jk.call(this,a,b)}y(UVd,jk);UVd.prototype.Fj=function(a){return 27==a.keyCode?!1:UVd.ma.Fj.call(this,a)};function $Vd(){var a=$5.getInstance(),b=Nn.getInstance();this.H=a;this.C=b;this.D=0}$Vd.prototype.F=function(a){this.H.F(a);a=Qn(P(vVd,{XT:a}),N.En.getLabel(),v(this.L,this,a),"info",!0,1E4);On(this.C,this.D);this.D=this.C.postMessage(a)};$Vd.prototype.L=function(a){this.H.L(a);a=Qn(P(wVd,{XT:a}),N.En.getLabel(),v(this.F,this,a),"info",!0,1E4);On(this.C,this.D);this.D=this.C.postMessage(a)};function aWd(a,b,c,d,e,f,h){F.call(this);this.J=a;this.H=b;this.L=c;this.D=e;this.ib=h||new Kd;this.C=new TVd(this.H,this.D,this.L,d,f,this.ib);this.va(this.C);this.Ja=new rf(this);this.va(this.Ja)}y(aWd,F);aWd.prototype.F=function(){this.Ja.Rc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");TBa(nr.getInstance())||this.J.Db(3);N.Tk.isEnabled()||Nn.getInstance().postMessage(Pn("Spellcheck will be unavailable until you reconnect.","info",!0,1E4))};function bWd(a){B.call(this);this.F=a;this.C={};this.D=new rf(this);this.va(this.D);this.D.R(a,"Oa",this.H)}y(bWd,B);function OVd(a,b,c){if(a=a.C[""+c.C])if(c=a.Se(c.Ad.y,c.Ad.x))return!!c.contains(b.toLowerCase());return!1}bWd.prototype.H=function(a){D(this.C[""+a.jh]);delete this.C[""+a.jh]};function cWd(){this.C=[]};function dWd(a,b,c){this.D=a;this.F=c||null;this.C=b}dWd.prototype.Dv=g("D");dWd.prototype.dQ=g("F");dWd.prototype.equals=function(a){var b=a.Dv(),c=a.dQ();a=oc(a.C);return this.D==b&&this.F==c&&$b(oc(this.C),a)};function d6(){V.call(this)}y(d6,V);var eWd=null;d6.prototype.rangeCount=function(){return Qv(this,2)};function e6(){V.call(this)}y(e6,V);var fWd=null;e6.prototype.jc=function(){return W(this,1)};function gWd(){V.call(this)}y(gWd,V);var hWd=null;function f6(){V.call(this)}y(f6,V);var iWd=null;f6.prototype.MJ=function(){return W(this,2)};function g6(){V.call(this)}y(g6,V);var jWd=null;g6.prototype.Dv=function(){return W(this,1)};g6.prototype.dQ=function(){return W(this,5)};
d6.prototype.Ca=function(){var a=eWd;a||(eWd=a=Wv(d6,{0:{name:"SpellcheckRequest",sb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Ba:5,type:Number},2:{name:"range",Ba:11,type:ow},3:{name:"search_all_sheets",Ba:8,type:Boolean},4:{name:"active_filter_views",Ic:!0,Ba:11,type:e6}}));return a};d6.Ca=d6.prototype.Ca;
e6.prototype.Ca=function(){var a=fWd;a||(fWd=a=Wv(e6,{0:{name:"FilterViewDataProto",sb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Ba:9,type:String},2:{name:"filter_view_id",Ba:9,type:String}}));return a};e6.Ca=e6.prototype.Ca;
gWd.prototype.Ca=function(){var a=hWd;a||(hWd=a=Wv(gWd,{0:{name:"SpellcheckResponse",sb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Ba:5,type:Number},2:{name:"last_column_searched",Ba:5,type:Number},3:{name:"last_grid_id_searched",Ba:9,type:String},4:{name:"searched_all_sheets",Ba:8,type:Boolean},6:{name:"searched_whole_range",Ba:8,type:Boolean},5:{name:"cell_suggestions",Ic:!0,Ba:11,type:f6}}));return a};gWd.Ca=gWd.prototype.Ca;
f6.prototype.Ca=function(){var a=iWd;a||(iWd=a=Wv(f6,{0:{name:"CellSuggestionsProto",sb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Ic:!0,Ba:11,type:g6},2:{name:"cell",Ba:11,type:Ox}}));return a};f6.Ca=f6.prototype.Ca;
g6.prototype.Ca=function(){var a=jWd;a||(jWd=a=Wv(g6,{0:{name:"PhraseSuggestionsProto",sb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Ba:9,type:String},2:{name:"offset_start_index",Ba:5,type:Number},3:{name:"offset_end_index",Ba:5,type:Number},4:{name:"suggestions",Ic:!0,Ba:9,type:String},5:{name:"spelling_language",Ba:9,type:String}}));return a};g6.Ca=g6.prototype.Ca;function kWd(a,b,c){this.Ad=a;this.C=b;this.sf=c}kWd.prototype.equals=function(a){return this===a?!0:a instanceof kWd?Ed(a.Ad,this.Ad)&&a.C==this.C&&ULa(a.sf,this.sf):!1};function h6(a,b,c,d,e){this.H=a;this.Ta=b;this.Ua=c;this.Ra=d;this.Oa=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.ea=[];this.qa=new rf(this);this.va(this.qa);this.$=null;this.V="RANGE";this.Ga=new Yv;this.Ga.Hi=!0;this.Aa=new Yv;this.Aa.Hi=!1}y(h6,B);h6.prototype.Ka=g("C");function PVd(a){EK(a.$);a.qa.Kc();a.V="RANGE";a.O=!1;a.L=[];a.ea=[]}
function lWd(a,b){var c=b.getSelection(),d=ZH(a.H,c.C),e;(e=!d)||(d=d.Oc(),e=c.Ad,e=!(sI(UG(d,"r"),e.y)&&sI(UG(d,"c"),e.x)));if(e)return!1;c=c.sf;a=mWd(a,b);b=b.C.Dv();return a.substring(c.start,c.end)==b}function mWd(a,b){a=nWd(a,b);return Sa(a,"'")?a.substring(1):a}function oWd(a,b){a=nWd(a,b);return Sa(a,"'")}function nWd(a,b){b=b.getSelection();var c=b.Ad,d=b.C;a=ZH(a.H,d).Oc();a.vt(Nz(b.Ad));return eI(a.Sf(c.y,c.x),d,c.y,c.x)}
function pWd(a,b){if(a.D){var c=new d6,d=new ow;X(d,1,a.D);X(d,2,a.J.y);switch(a.V){case "WORKBOOK":X(c,3,!0);d.Iu(0);var e=fJ(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&qWd(c,e[f]);break;case "SHEET":d.Iu(0);e=ZH(a.H,a.F.ud);qWd(c,e);break;case "RANGE":d.Iu(a.F.rect.rc()),pw(d,a.F.rect.Tc()),d.Rx(a.F.rect.Wc()),e=ZH(a.H,a.F.ud),qWd(c,e)}X(c,2,d);X(c,1,a.J.x+1);Ht(vq(ms(wq(a.Ta.Ie("/spell"),{data:a.Ga.serialize(c)}),"POST"),function(a){this.fl(a,b)},a),function(){this.fl(null,b)},a).ue()}else rWd(a,
b,!1)}function qWd(a,b){if(b){var c=b.Oc().H;if(QG(c)){b=""+b.zb();c=mI(c);var d=new e6;X(d,1,b);X(d,2,c);Rv(a,4,d)}}}
h6.prototype.fl=function(a,b){if(a){a=this.Aa.yd(gWd.Ca(),a.Ye());this.J=new Dd(W(a,2),W(a,1));this.D=W(a,3);this.O=W(a,6);a=Uv(a,5);for(var c=0;c<a.length;c++){var d=a[c],e=d.MJ().Tq(),f=d.MJ().getColumnIndex();e=new Dd(f,e);f=parseInt(d.MJ().zb(),10);d=Uv(d,1);for(var h=0;h<d.length;h++){var k=d[h],l=k.Dv(),m=W(k,2),q=W(k,3),t=k.dQ();m=new kWd(e,f,new vu(m,q));if(!sWd(this,l,m)){k=Uv(k,4);q={};for(var w=0;w<k.length;w++)q[k[w]]=new cWd;this.L.push(new IVd(new dWd(l,q,t),m))}}}}QVd(this,b,!1)};
function QVd(a,b,c){if(c){var d=a.ea;var e=v(d.pop,d)}else d=a.L,e=v(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.Dv();if(!sWd(a,h,f.getSelection())){e=c;h=f.getSelection();c=ZH(a.H,h.C);d=c.Oc();h=Nz(h.Ad);f=v(a.Na,a,f,b,e);d.vt(h)?f():(EK(a.$),a.$=$G(c.C,h).addCallback(f));return}}rWd(a,b,c)}function rWd(a,b,c){a.O||c?(a.C=null,b(null)):pWd(a,b)}h6.prototype.Na=function(a,b,c){lWd(this,a)?(this.C=a,b(a.C)):QVd(this,b,c)};
function sWd(a,b,c){return a.Ra.C.contains(b.toLowerCase())||OVd(a.Oa,b,c)||a.Ua.C.contains(b.toLowerCase())}h6.prototype.Fa=function(){h6.ma.Fa.call(this);EK(this.$)};function tWd(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function MVd(a,b){var c=b.D.C;if(lWd(a.C,c)){var d=c.getSelection(),e=d.C,f=d.sf,h=ZH(a.D,e).Oc(),k=oWd(a.C,c);c=mWd(a.C,c);var l=new BO(h,Nz(d.Ad),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));RF(l,v(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Ed(f.Ad,d.Ad)&&f.C==d.C&&f.sf.start>d.sf.end){var h=d.sf.getLength()-c.length;f.sf.start-=h;f.sf.end-=h}}}},a));FU(a.D,new cA(e,"",Nz(d.Ad)),v(function(){this.F.C(l)},a))}}
function RVd(a,b){b&&FU(a.D,new cA(b.C,"",Nz(b.Ad)))};function uWd(a){this.D=new KBc(a)}uWd.prototype.C=function(a){var b=new Px,c=new ow;X(c,2,a.Ad.y);pw(c,a.Ad.y+1);c.Iu(a.Ad.x);c.Rx(a.Ad.x+1);X(c,1,""+a.C);Rv(b,2,c);c=new Ox;X(c,1,""+a.C);X(c,2,a.Ad.y);X(c,3,a.Ad.x);X(b,1,c);return this.D.C(new lA(b))};function vWd(a,b,c,d,e,f,h,k){aX.call(this,"docs-spellcheckslidingdialog-id",c);this.H=v(this.Ura,this);this.Ga=a;this.Na=new $Vd;this.Aa=new HVd;this.qa=new bWd(a);this.J=new h6(a,e,$5.getInstance(),this.Aa,this.qa);this.Ka=new tWd(a,b,this.J,this.qa);b=Jd();a=new aWd(c,(new uk).build(),new uWd(a),new qVd("trigger-text",!1),this.J,k,b);this.va(a);this.V=a.C;this.D=new LVd(a,this.Aa,this.J,this.Ka,d,this.Na);this.F=b.xa("DIV",{style:"margin-top: 10px"});this.L=kS("Search the rest of the sheet",b);
this.L.render(this.F);this.getHandler().R(this.L,"action",this.oTb);this.O=kS("Search all sheets",b);this.O.render(this.F);this.getHandler().R(this.O,"action",v(this.Ura,this,"WORKBOOK"));Jr(h,$5.getInstance(),"docs-user_dictionary");N.V1.subscribe("action",this.D.iob,this.D);N.W1.subscribe("action",this.D.ztb,this.D);N.j2.subscribe("action",this.D.tyb,this.D);N.aU.subscribe("action",this.D.u9a,this.D);N.A1.subscribe("action",this.D.Bmb,this.D);N.u2.subscribe("action",v(this.D.eKa,this.D,!1));N.v2.subscribe("action",
v(this.D.eKa,this.D,!0));N.Fy.setVisible(!0);N.Fy.subscribe("action",FVd(f,Fe(this.V)))}y(vWd,aX);p=vWd.prototype;p.ZP=g("V");p.Mu=function(){vWd.ma.Mu.call(this);this.getHandler().R(this.C,"close",this.b0b).R(this.Ga,"Ta",this.c0b)};p.b0b=function(){this.KB()};p.c0b=function(){this.C.gr();this.KB()};
p.Ura=function(a,b){var c=b||null,d;a||((b=this.Ga.C)?0==b.getSheetType()?(c=b.Oc().Qc(),1<c.oh()?(a="RANGE",c=new cA(b.zb(),b.qe(),c)):(a="SHEET",c=new cA(b.zb(),b.qe(),null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.L.setVisible(!0);this.O.setVisible(!0);G(this.F,!0);break;case "SHEET":this.L.setVisible(!1);this.O.setVisible(!0);G(this.F,!0);break;case "WORKBOOK":G(this.F,!1)}b=this.J;PVd(b);b.V=a;b.F=c;switch(a){case "WORKBOOK":b.J=new Dd(-1,0);(a=b.H.P5(-1,
0,!1,!0))?b.D=""+a.zb():(b.D=null,b.O=!0);break;case "SHEET":b.J=new Dd(-1,0);b.D=""+c.ud;break;case "RANGE":b.J=new Dd(c.rect.left-1,c.rect.top),b.D=""+c.ud}a=this.V;a.Eb=this.F;a.Bc=d?d:5E3;a=this.D;N.dda.Nc(!0);a.Ja.R(a.F,"docs-text-spellcheckdialogcontroller-closed",a.DCa);d=a.F;a=v(a.uLb,a);b=d.D.C;d.C.Yb()||d.C.render(xe(d.ib,"docs-spellcheckslidingdialog-id"));(c=d.C.tJ)&&b?d.C.focus():(c||d.Ja.R(d.C,"close",d.F),a())};p.oTb=function(){var a=this.J.F;this.Ura("SHEET",new cA(a.ud,a.Tg,null))};function wWd(){B.call(this)}y(wWd,LA);wWd.prototype.C=function(a,b,c,d,e,f,h,k){return new vWd(a,b,c,d,e,f,h,k)};WA("spellcheck",wWd);
